<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Final Report</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="About.html">About</a>
</li>
<li>
  <a href="Data.html">Data</a>
</li>
<li>
  <a href="EDA.html">EDA</a>
</li>
<li>
  <a href="Regression_Analysis.html">Regression Analysis</a>
</li>
<li>
  <a href="Final-Report.html">Final Report</a>
</li>
<li>
  <a href="https://tianyiw44.shinyapps.io/p8105_final_shiny/">Shiny APP</a>
</li>
<li>
  <a href="mailto:&lt;sc5078@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/YvonneChen22/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Final Report</h1>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>Every fairy tale concludes with the prince and princess living
happily ever after. These are our most innocent and sincere wishes.
However, as modern individuals lament the mounting pressures of work and
life, alongside the escalating issues of depression and other mental
health disorders, our happiness seems elusive. Happiness has become a
crucial measurement of our well-being as well as a nation’s success.
It’s a fundamental human right, just like health. Every person has the
right to happiness; it is affecting us both mental and physical health.
It has also become an integral indicator for national policy and
operational objective for governments.</p>
<p>But how do we quantify happiness? What are the sources of our
happiness? Are we truly happy or unhappy? Is the world happy? How can we
enhance our level of happiness? These are the questions we seek to
answer through this project. Understanding what drives happiness can
help in formulating policies that improve the quality of life for
citizens. By studying the factors that affect happiness, we can
contribute to a multidisciplinary understanding of well-being, which in
turn can inform a variety of practical applications aimed at improving
people’s lives at both the individual and collective levels.</p>
</div>
<div id="mission-statement" class="section level2">
<h2>Mission Statement</h2>
<p>Our mission is to conduct a comprehensive analysis of the factors
influencing global happiness scores across the years 2015 to 2019.
Through in-depth exploration and examination of Economic production (gdp
per capita), social support, life expectancy, freedom, absence of
corruption, and generosity, we aim to identify and understand the key
determinants that contribute to varying happiness levels among nations
during this period. By regression analysis, our goal is to unravel the
relationships between happiness score and six factors. Other research
questions help us know more about the distribution happiness score, and
six factors, respectively. Ultimately, our research seeks to provide
insights that can illuminate policy decisions and societal
interventions, health system development fostering a deeper
understanding of what drives happiness worldwide and how it evolves over
time.</p>
</div>
<div id="related-work" class="section level2">
<h2>Related Work</h2>
<p>The origin of our inspiration is from an article published on the
website ‘Sciencenordic’ – ‘How happiness is challenging GDP as the
measure of a country’s health’. In this article, the argument suggests
that the traditional reliance on GDP as the primary measure of a
country’s health is insufficient, and we should consider a broader set
of indicators that encompass measurement of happiness and well-being.
The information highlights a strong correlation between inequality and
unhappiness, suggesting that countries with high levels of equality,
such as the Nordic countries, tend to perform significant in happiness
rankings. This challenges the notion that GDP alone is a conclusive
measure of well-being, as it does not account for the distribution of
resources and the level of equality within a society. The reflection of
this trend towards recognizing the limitations of purely economic
metrics and a broader understanding of what contributes to a fulfilling
and happy life inspired us to think deeply.</p>
</div>
</div>
<div id="data-sources-cleaning" class="section level1">
<h1>Data Sources &amp; Cleaning</h1>
<div id="data-acquisition" class="section level2">
<h2>Data Acquisition</h2>
<p>We sourced our data from The World Happiness Report, first published
in 2012. This report gathers surveys from a nationally-representative
sample of individuals, inquiring about their life satisfaction and their
views on six factors: income, health, having reliable support, freedom
to make life decisions, generosity, and the absence of government
corruption. It then ranked around 155-158 countries base on the
happiness score collected each year. We chose to utilize The World
Happiness Reports published between 2015 and 2019, the pre-COVID period.
The data can be accessed <a
href="https://www.kaggle.com/datasets/unsdsn/world-happiness">here</a>.
Each year’s report is available as a separate CSV file, resulting in a
total of five datasets. Each dataset comprises various variables,
necessitating data cleaning and merging for analysis.</p>
</div>
<div id="data-merging-and-cleaning" class="section level2">
<h2>Data merging and cleaning</h2>
<p>We imported five dataset into RStudio. In order to merge them, we
need to make sure all datasets have the same variables. We first updated
all variable to <code>snake cases</code>, removed the unwanted variables
and added a <code>year</code> variable representing the year for each
dataset. Because only <code>2015</code> and <code>2016</code> data
recorded <code>region</code> for each <code>country,</code> we extracted
the <code>country</code> and <code>region</code> variables into separate
data frame and <code>left_join</code> it into <code>2017</code>,
<code>2018</code> and <code>2019</code> by <code>country</code>. We then
stack all five dataset into our final dataset using
<code>bind_row</code>. We then check if there’s any missing or miscoded
values. Because there are new counties entering into the survey and
ranking in <code>2017</code>, <code>2018</code> and <code>2019</code>,
with no region recorded, and the dataset records same country
differently in each year. We manually updated the value using
<code>mutate()</code>. The code is read as following:</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre class="r"><code>data2015_df = read_csv(&quot;./data/2015.csv&quot;)|&gt;
  janitor::clean_names()|&gt;
  mutate(year=2015)|&gt;
  select(- standard_error, -dystopia_residual)|&gt;
  select(year, country, region, rank, score, everything() )

data2016_df = read_csv(&quot;./data/2016.csv&quot;)|&gt;
  janitor::clean_names()|&gt;
  mutate(year=2016)|&gt;
  select(- lower_confidence_interval, - upper_confidence_interval, -dystopia_residual)|&gt;
  select(year, country, region, rank, score, everything() )

region_df = data2015_df|&gt;
  select(country, region)

data2017_df = read_csv(&quot;./data/2017.csv&quot;)|&gt;
  janitor::clean_names()|&gt;
  mutate(year=2017)|&gt;
  select(- whisker_high, - whisker_low, -dystopia_residual)|&gt;
  select(-generosity, everything(), generosity)

data2017_df = left_join(data2017_df, region_df)|&gt;
  select(year, country, region, everything())

data2018_df = read_csv(&quot;./data/2018.csv&quot;)|&gt;
  janitor::clean_names()|&gt;
  mutate(
    year=2018)|&gt;
  select(-generosity, everything(), generosity)

data2018_df = left_join(data2018_df, region_df)|&gt;
  select(year, country, region, everything())|&gt;
  mutate(
    perception_of_corruption = as.numeric(perception_of_corruption)
  )

data2019_df = read_csv(&quot;./data/2019.csv&quot;)|&gt;
  janitor::clean_names()|&gt;
  mutate(year=2019)|&gt;
  select(-generosity, everything(), generosity)

data2019_df = left_join(data2019_df, region_df)|&gt;
  select(year, country, region, everything())

hap_df = bind_rows(data2015_df, data2016_df, data2017_df, data2018_df, data2019_df)|&gt;
  mutate(
    region = if_else(country == &quot;Taiwan Province of China&quot;, &quot;Eastern Asia&quot;, region),
     region = if_else(country == &quot;Hong Kong S.A.R., China&quot;, &quot;Eastern Asia&quot;, region),
    region = if_else(country == &quot;Belize&quot;, &quot;Latin America and Caribbean&quot;, region),
    region = if_else(country == &quot;Somalia&quot;, &quot;Sub-Saharan Africa&quot;, region),
    region = if_else(country == &quot;Namibia&quot;, &quot;Sub-Saharan Africa&quot;, region),
    region = if_else(country == &quot;South Sudan&quot;, &quot;Sub-Saharan Africa&quot;, region),
    region = if_else(country == &quot;Trinidad &amp; Tobago&quot;, &quot;Latin America and Caribbean&quot;, region),
    region = if_else(country == &quot;Northern Cyprus&quot;, &quot;Western Europe&quot;, region),
    region = if_else(country == &quot;North Macedonia&quot;, &quot;Central and Eastern Europe&quot;, region),
    region = if_else(country == &quot;Gambia&quot;, &quot;Sub-Saharan Africa&quot;, region),
    country = if_else(country == &quot;Hong Kong S.A.R., China&quot;, &quot;Hong Kong&quot;, country),
    country = if_else(country == &quot;Northern Cyprus&quot;, &quot;North Cyprus&quot;, country),
    country = if_else(country == &quot;Somaliland region&quot;, &quot;Somalia&quot;, country),
    country = if_else(country == &quot;Taiwan Province of China&quot;, &quot;Taiwan&quot;, country),
    country = if_else(country == &quot;Trinidad &amp; Tobago&quot;, &quot;Trinidad and Tobago&quot;, country)
    )

write_csv(hap_df, &quot;./data/combined_happiness.csv&quot;)</code></pre>
</div>
<div id="final-dataset-description" class="section level2">
<h2>Final Dataset Description</h2>
<p>The final dataset has 782 observations. There are 11 variables:</p>
<p><code>year</code>: The year of the surveys. <code>country</code>:
Name of the countries. <code>region</code>: region of the countries.
There are 10 regions in the Dataset. <code>rank</code>: Rank of the
countries base on happiness score. <code>score</code>: Happiness Score
of the countries, with 10 representing the best possible life and 0
being the lowest. <code>gdp_per_capita</code>: Measurement on income and
GDP per Capital, value ranges from 0 – 2.10.
<code>social support</code>: Measurement on having someone to count on
in times of trouble, value ranges from 0 to 1.65.
<code>health_life_expectancy</code>: Measurement on healthy life
expectancy, which also reflects mental and physical health, value ranges
from 0 to 1.15. <code>freedom_to_make_choices</code>: Measurement on
freedom to choose what you do with your life, which also reflects human
rights. Human rights include the right to life and liberty, freedom from
slavery and torture, freedom of opinion and expression, the right to
work and education, and many more. Everyone is entitled to these rights
without discrimination. Value ranges from 0 – 0.75.
<code>perception_of_corruption</code>: Measurement on if people think
there’s corruption widespread throughout the government and within
businesses, and if people trust their governments and have trust in the
benevolence of others. Values ranges from 0 – 0.6. Please note that
higher scores representing lower perception of corruption and higher
trust of the government. <code>generosity</code>: Measurement on if
people donated money to the charity, which is a sense of positive
community engagement. Value ranges from 0-0.85. <code>year</code>,
<code>country</code> and <code>region</code> is factor and categorical
variables. All the other variables are numeric and continuous
variables.</p>
<p>Later in the data analysis, we also added the ISO3 code
(<code>ISO3</code>) to the dataset for the purpose of outputting
geographic plot.</p>
</div>
</div>
<div id="exploratory-analysis" class="section level1">
<h1>Exploratory Analysis</h1>
<p>We first performed exploratory data analysis to explore and visualize
the current distribution of happiness and each of the six factors that
thought to impact happiness around the world at country and region
level. We are interested in finding which part of the world has the
highest versus lowest happiness score as well as which part of the world
has the highest versus lowers score of income, social support,health,
freedom, perception of government corruption and generosity. In order to
best depict the true nature of our data, we used a combination bar
plots, heatmap, and scatter plot, and create a interactive <a
href="%22https://tianyiw44.shinyapps.io/p8105_final_shiny/%22">shiny
app</a> on the six happiness factor.</p>
<p><em>For the happiness score</em>, we found that the geographic
distribution of World Happiness Score is stable from 2015 to 2019.
European Countries such as Finland, Switzerland, and Denmark tend to
have highest happiness score while African countries such as South Sudan
and Central African Republic tend to have lowest happiness score. Also,
countries in Europe, Australia, North and South America have higher
happiness score while countries in Africa and Middle East Asia has
relatively lower happiness score.</p>
<p>From 2015 to 2019, Australia and New Zealand has stable happiness
scores and it’s the highest among 10 regions. North America has second
highest happiness score among 10 regions with the highest happiness
score in year 2015 and gradually decreasing trend. Western Europe has
the third highest happiness score with an increasing trend in 5 years.
Latin America and Caribbean has the fourth highest happiness score with
a decreasing trend in 5 years. Eastern Asia has the fifth highest
happiness score with a stable trend. Middle East and Northern Africa,
Southeastern Asia, and Central and Eastern Europe have comparative
happiness score from 2015 to 2017, but Central and Eastern Europe has a
increasing trend and higher happiness score after year 2017 while the
other two regions have a decreasing trend and lower happiness score
after year 2017. Southern Asia and Sub-Saharan Africa has the second
lowest and lowest happiness score in 5 years, respectively. However,
Sub-Saharan Africa has shown an increasing trend while Southern Asia has
shown an decreasing trend since year 2017.</p>
<p><em>For the six happiness indicators</em>, we found that The GDP per
Capita increases from 2015 to 2017, then decreased from 2017 to 2018.
There’s a slight increase from 2018 to 2019 but the world has the
highest GDP per Capita in 2017. The social support decreased from 2015
to 201 with a significant increase from 2016 top 2017, then it stayed
relatively stable. The healthy life expectancy score decreased from 2016
to 2017 then increased from 2017 to 2019. The freedom of choices
decrease from 2015 to 2016, increased from 2016 to 2018 and decreased
again in 2019. The proception of corruption stayed relatively stable but
the world generally is seeing increasing corruptions. The generosity
decrease from 2017 to 2018 which in align with the trend of GDP per
Capita, suggesting possible association between people’s income and
their generosity around the world. However, it’s worth noting that the
countries with highest income are not the countries with top generosity
scores. Overall, social support and healthy life expectancy improved
from 2015 to 2019.</p>
<p>We noticed that at regional level, Australia and New Zealand ranked
first in 4 four out of 6 factors and North American ranked first in 1
out of the other 2. It is worth mentioning that North American revision
only has two countries, USA and Canada. Australia and New Zealand also
only has two countries, Australia, and New Zealand. They may have high
average scores and less variable with in the region than the other 8
regions. The other regions might have countries with very high score and
very low score which impacted the averages core. This will require
further analysis.</p>
<p>Also there are not much discrepancy found in trend between the 10
regions and the regional trends align with the world trends as well.</p>
<pre class="r"><code>library(tidyverse)
library(plotly)
library(purrr)</code></pre>
<pre class="r"><code>hap_df = read_csv(&quot;./data/combined_happiness.csv&quot;)|&gt;
  mutate(
    year = as.factor(year)
  )

regional_hap_df = hap_df|&gt;
  group_by(region,year) |&gt;
  summarise(
    average_gdp_per_capita = mean(gdp_per_capita, na.rm = TRUE),
    average_social_support = mean(social_support, na.rm = TRUE),
    average_healthy_life_expectancy = mean(health_life_expectancy, na.rm = TRUE),
    average_freedom_to_make_life_choices = mean(freedom_to_make_life_choices, na.rm = TRUE),
    average_perception_of_corruption = mean(perception_of_corruption, na.rm = TRUE),
    average_generosity = mean(generosity, na.rm = TRUE)
  )|&gt;
  pivot_longer(
    average_gdp_per_capita:average_generosity,
    names_to =&quot;factor&quot;,
    names_prefix = &quot;average_&quot;,
    values_to = &quot;average_score&quot;
  )</code></pre>
<pre class="r"><code>iso_codes = countrycode::codelist[, c(&quot;un.name.en&quot;, &quot;iso3c&quot;)]
names(iso_codes) = c(&quot;Country&quot;, &quot;ISO3&quot;)</code></pre>
<pre class="r"><code>world_data &lt;- ggplot2::map_data(&#39;world&#39;)
world_data &lt;- fortify(world_data)</code></pre>
<pre class="r"><code>hap_df[&#39;ISO3&#39;] &lt;- iso_codes$ISO3[match(hap_df$country, iso_codes$Country)]
world_data[&quot;ISO3&quot;] &lt;- iso_codes$ISO3[match(world_data$region, iso_codes$Country)]</code></pre>
<pre class="r"><code>hap_df = hap_df |&gt;
  mutate(
    ISO3 = if_else(country == &quot;United States&quot;, &quot;USA&quot;, ISO3),
    ISO3 = if_else(country == &quot;United Kingdom&quot;, &quot;GBR&quot;, ISO3),
    ISO3 = if_else(country == &quot;Venezuela&quot;, &quot;VEN&quot;, ISO3),
    ISO3 = if_else(country == &quot;Czech Republic&quot;, &quot;CZE&quot;, ISO3),
    ISO3 = if_else(country == &quot;Taiwan&quot;, &quot;TWN&quot;, ISO3),
    ISO3 = if_else(country == &quot;South Korea&quot;, &quot;KOR&quot;, ISO3),
    ISO3 = if_else(country == &quot;Bolivia&quot;, &quot;BOL&quot;, ISO3),
    ISO3 = if_else(country == &quot;Moldova&quot;, &quot;MDA&quot;, ISO3),
    ISO3 = if_else(country == &quot;Russia&quot;, &quot;RUS&quot;, ISO3),
    ISO3 = if_else(country == &quot;Hong Kong&quot;, &quot;CHN&quot;, ISO3),
    ISO3 = if_else(country == &quot;Vietnam&quot;, &quot;VNM&quot;, ISO3),
    ISO3 = if_else(country == &quot;Turkey&quot;, &quot;TUR&quot;, ISO3),
    ISO3 = if_else(country == &quot;Macedonia&quot;, &quot;MKD&quot;, ISO3),
    ISO3 = if_else(country == &quot;Laos&quot;, &quot;LAO&quot;, ISO3),
    ISO3 = if_else(country == &quot;Swaziland&quot;, &quot;SWZ&quot;, ISO3),
    ISO3 = if_else(country == &quot;Palestinian Territories&quot;, &quot;PSE&quot;, ISO3),
    ISO3 = if_else(country == &quot;Iran&quot;, &quot;IRN&quot;, ISO3),
    ISO3 = if_else(country == &quot;Congo (Kinshasa)&quot;, &quot;COD&quot;, ISO3),
    ISO3 = if_else(country == &quot;Congo (Brazzaville)&quot;, &quot;COG&quot;, ISO3),
    ISO3 = if_else(country == &quot;Tanzania&quot;, &quot;TZA&quot;, ISO3),
    ISO3 = if_else(country == &quot;Syria&quot;, &quot;SYR&quot;, ISO3),
    ISO3 = if_else(country == &quot;Puerto Rico&quot;, &quot;PRI&quot;, ISO3)
  )|&gt;
  mutate(country = recode(str_trim(country),
                         &quot;United States&quot; = &quot;USA&quot;,
                         &quot;United Kingdom&quot; = &quot;UK&quot;,
                         &quot;Congo (Kinshasa)&quot; = &quot;Democratic Republic of the Congo&quot;,
                         &quot;Congo (Brazzaville)&quot; = &quot;Republic of Congo&quot;))</code></pre>
<pre class="r"><code>world_data = world_data|&gt;
  mutate(country = region)|&gt;
  select(-region)

worldjoin &lt;- inner_join(world_data, hap_df, by = &quot;country&quot;)</code></pre>
<pre class="r"><code>## compile all map theme configurations
cleanup &lt;- theme(
  axis.text = element_blank(),
  axis.line = element_blank(),
  axis.ticks = element_blank(),
  panel.border = element_blank(),
  panel.grid = element_blank(),
  axis.title = element_blank(),
  panel.background = element_rect(fill = &quot;white&quot;),
  plot.title = element_text(hjust = 0.5)
)

## plot our merged data

gdp &lt;- worldjoin %&gt;% 
  ggplot(mapping = aes(
    x=long,
    y=lat,
    group=group)) +
  scale_fill_viridis_c(option = &quot;C&quot;) +
  coord_fixed(1.3) +
  geom_polygon(aes(fill=gdp_per_capita)) +
  ggtitle(&quot;GDP Per Capita&quot;) +
  cleanup

gdp</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-11-1.png" width="1152" /></p>
<div
id="which-country-region-has-the-highest-and-lowest-happiness-score"
class="section level2">
<h2>Which Country/ Region Has the Highest and Lowest Happiness
Score?</h2>
<div id="section" class="section level3">
<h3>2015</h3>
<p><strong>At Country Level</strong></p>
<pre class="r"><code>combined_happiness|&gt;
  filter(year == &quot;2015&quot;)|&gt;
  mutate(country = fct_reorder(country, score))|&gt;
  plot_ly(
    x = ~country, y = ~score, color = ~region,
    type = &#39;bar&#39;, colors = &#39;viridis&#39;
  )|&gt;
  layout(
    title = &quot;2015 World Happiness Score Rank&quot;,
    xaxis = list(title = &quot;Countries&quot;, tickfont = list(size = 6)),
    yaxis = list(title = &quot;Happiness Score&quot;),
    autosize = FALSE,
    width = 800,
    height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-7164360d01365f922754" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-7164360d01365f922754">{"x":{"visdat":{"b30a1ce5dcfc":["function () ","plotlyVisDat"]},"cur_data":"b30a1ce5dcfc","attrs":{"b30a1ce5dcfc":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"2015 World Happiness Score Rank","xaxis":{"domain":[0,1],"automargin":true,"title":"Countries","tickfont":{"size":6},"type":"category","categoryorder":"array","categoryarray":["Togo","Burundi","Syria","Benin","Rwanda","Afghanistan","Burkina Faso","Ivory Coast","Guinea","Chad","Central African Republic","Madagascar","Tanzania","Cambodia","Niger","Gabon","Senegal","Uganda","Comoros","Congo (Brazzaville)","Mali","Angola","Yemen","Egypt","Bulgaria","Cameroon","Sri Lanka","Malawi","Georgia","Myanmar","Botswana","Armenia","Djibouti","Kenya","Mauritania","Sierra Leone","Ethiopia","Nepal","Congo (Kinshasa)","Haiti","Sudan","India","Liberia","Zimbabwe","Ghana","South Africa","Iraq","Ukraine","Iran","Bangladesh","Palestinian Territories","Tunisia","Tajikistan","Honduras","Hungary","Lebanon","Greece","Swaziland","Mongolia","Laos","Dominican Republic","Lesotho","Bosnia and Herzegovina","Albania","Mozambique","Macedonia","Morocco","Somalia","Philippines","Latvia","Portugal","Serbia","Romania","Zambia","China","Jordan","Montenegro","Pakistan","Azerbaijan","Bhutan","Nigeria","Kyrgyzstan","Turkey","Vietnam","Indonesia","Estonia","Hong Kong","Mauritius","Turkmenistan","Kosovo","Algeria","Cyprus","North Cyprus","Jamaica","Russia","Libya","Croatia","Malaysia","Poland","Belarus","Peru","Nicaragua","Lithuania","Slovenia","Kazakhstan","Paraguay","Moldova","Bolivia","Italy","Bahrain","Ecuador","South Korea","Japan","Slovakia","Uzbekistan","Guatemala","El Salvador","Trinidad and Tobago","Suriname","Kuwait","Taiwan","Malta","Spain","Saudi Arabia","Thailand","Colombia","Uruguay","Czech Republic","Argentina","France","Qatar","Chile","Germany","Panama","Singapore","Venezuela","Oman","United Kingdom","United Arab Emirates","Belgium","Ireland","Luxembourg","Brazil","United States","Mexico","Austria","Costa Rica","Israel","Australia","New Zealand","Sweden","Netherlands","Finland","Canada","Norway","Denmark","Iceland","Switzerland"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Happiness Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["New Zealand","Australia"],"y":[7.2859999999999996,7.2839999999999998],"type":"bar","name":"Australia and New Zealand","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Czech Republic","Uzbekistan","Slovakia","Moldova","Kazakhstan","Slovenia","Lithuania","Belarus","Poland","Croatia","Russia","Kosovo","Turkmenistan","Estonia","Kyrgyzstan","Azerbaijan","Montenegro","Romania","Serbia","Latvia","Macedonia","Albania","Bosnia and Herzegovina","Hungary","Tajikistan","Ukraine","Armenia","Georgia","Bulgaria"],"y":[6.5049999999999999,6.0030000000000001,5.9950000000000001,5.8890000000000002,5.8550000000000004,5.8479999999999999,5.8330000000000002,5.8129999999999997,5.7910000000000004,5.7590000000000003,5.7160000000000002,5.5890000000000004,5.548,5.4290000000000003,5.2859999999999996,5.2119999999999997,5.1920000000000002,5.1239999999999997,5.1230000000000002,5.0979999999999999,5.0069999999999997,4.9589999999999996,4.9489999999999998,4.7999999999999998,4.7859999999999996,4.681,4.3499999999999996,4.2969999999999997,4.218],"type":"bar","name":"Central and Eastern Europe","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Taiwan","Japan","South Korea","Hong Kong","China","Mongolia"],"y":[6.298,5.9870000000000001,5.984,5.4740000000000002,5.1399999999999997,4.8739999999999997],"type":"bar","name":"Eastern Asia","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Costa Rica","Mexico","Brazil","Venezuela","Panama","Chile","Argentina","Uruguay","Colombia","Suriname","Trinidad and Tobago","El Salvador","Guatemala","Ecuador","Bolivia","Paraguay","Nicaragua","Peru","Jamaica","Dominican Republic","Honduras","Haiti"],"y":[7.226,7.1870000000000003,6.9829999999999997,6.8099999999999996,6.7859999999999996,6.6699999999999999,6.5739999999999998,6.4850000000000003,6.4770000000000003,6.2690000000000001,6.1680000000000001,6.1299999999999999,6.1230000000000002,5.9749999999999996,5.8899999999999997,5.8780000000000001,5.8280000000000003,5.8239999999999998,5.7089999999999996,4.8849999999999998,4.7880000000000003,4.5179999999999998],"type":"bar","name":"Latin America and Caribbean","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Israel","United Arab Emirates","Oman","Qatar","Saudi Arabia","Kuwait","Bahrain","Libya","Algeria","Turkey","Jordan","Morocco","Lebanon","Tunisia","Palestinian Territories","Iran","Iraq","Egypt","Yemen","Syria"],"y":[7.2779999999999996,6.9009999999999998,6.8529999999999998,6.6109999999999998,6.4109999999999996,6.2949999999999999,5.96,5.7539999999999996,5.6050000000000004,5.3319999999999999,5.1920000000000002,5.0129999999999999,4.8390000000000004,4.7389999999999999,4.7149999999999999,4.6859999999999999,4.6769999999999996,4.194,4.077,3.0059999999999998],"type":"bar","name":"Middle East and Northern Africa","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Canada","United States"],"y":[7.4269999999999996,7.1189999999999998],"type":"bar","name":"North America","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Singapore","Thailand","Malaysia","Indonesia","Vietnam","Philippines","Laos","Myanmar","Cambodia"],"y":[6.798,6.4550000000000001,5.7699999999999996,5.399,5.3600000000000003,5.0730000000000004,4.8760000000000003,4.3070000000000004,3.819],"type":"bar","name":"Southeastern Asia","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bhutan","Pakistan","Bangladesh","India","Nepal","Sri Lanka","Afghanistan"],"y":[5.2530000000000001,5.194,4.694,4.5650000000000004,4.5140000000000002,4.2709999999999999,3.5750000000000002],"type":"bar","name":"Southern Asia","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mauritius","Nigeria","Zambia","Somalia","Mozambique","Lesotho","Swaziland","South Africa","Ghana","Zimbabwe","Liberia","Sudan","Congo (Kinshasa)","Ethiopia","Sierra Leone","Mauritania","Kenya","Djibouti","Botswana","Malawi","Cameroon","Angola","Mali","Congo (Brazzaville)","Comoros","Uganda","Senegal","Gabon","Niger","Tanzania","Madagascar","Central African Republic","Chad","Guinea","Ivory Coast","Burkina Faso","Rwanda","Benin","Burundi","Togo"],"y":[5.4770000000000003,5.2679999999999998,5.1289999999999996,5.0570000000000004,4.9710000000000001,4.8979999999999997,4.867,4.6420000000000003,4.633,4.6100000000000003,4.5709999999999997,4.5499999999999998,4.5170000000000003,4.5119999999999996,4.5069999999999997,4.4359999999999999,4.4189999999999996,4.3689999999999998,4.3319999999999999,4.2919999999999998,4.2519999999999998,4.0330000000000004,3.9950000000000001,3.9889999999999999,3.956,3.931,3.9039999999999999,3.8959999999999999,3.8450000000000002,3.7810000000000001,3.681,3.6779999999999999,3.6669999999999998,3.6560000000000001,3.6549999999999998,3.5870000000000002,3.4649999999999999,3.3399999999999999,2.9049999999999998,2.839],"type":"bar","name":"Sub-Saharan Africa","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Switzerland","Iceland","Denmark","Norway","Finland","Netherlands","Sweden","Austria","Luxembourg","Ireland","Belgium","United Kingdom","Germany","France","Spain","Malta","Italy","North Cyprus","Cyprus","Portugal","Greece"],"y":[7.5869999999999997,7.5609999999999999,7.5270000000000001,7.5220000000000002,7.4059999999999997,7.3780000000000001,7.3639999999999999,7.2000000000000002,6.9459999999999997,6.9400000000000004,6.9370000000000003,6.867,6.75,6.5750000000000002,6.3289999999999997,6.3019999999999996,5.9480000000000004,5.6950000000000003,5.6890000000000001,5.1020000000000003,4.8570000000000002],"type":"bar","name":"Western Europe","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>At Region Level</strong></p>
<pre class="r"><code>combined_happiness |&gt;
  filter(year == &quot;2015&quot;) |&gt;
  group_by(region) |&gt;
  mutate(region_avg = mean(score)) |&gt;
  arrange(desc(region_avg)) |&gt;
  summarize(region = unique(region), score = unique(region_avg)) |&gt;
  ggplot(aes(x = reorder(region, -score), y = score, fill = region)) +
  geom_bar(stat = &quot;identity&quot;) +
  labs(title = &quot;2015 World Happiness Score Rank&quot;, x = &quot;Regions&quot;, y = &quot;Happiness Score&quot;) +
  scale_x_discrete(labels = label_wrap_gen(width = 10)) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>hp_2015 &lt;- worldjoin |&gt;
  filter(year == &quot;2015&quot;) |&gt;
  ggplot(mapping = aes(
    x=long,
    y=lat,
    group=group)) +
  scale_fill_viridis_c(option = &quot;C&quot;) +
  coord_fixed(1.3) +
  geom_polygon(aes(fill=score)) +
  ggtitle(&quot;Happiness Score 2015&quot;) +
  cleanup

hp_2015</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>At <em>country level</em>, in year 2015, Switzerland has the highest
happiness score while Togo has the lowest happiness score among 158
countries.</p>
<p>At <em>Region Level</em>, in year 2015, Australia and New Zealand has
the highest happiness score while Sub-Saharan Africa has the lowest
happiness score among 10 regions.</p>
<p>In general, countries in Europe, Australia, North and South America
have higher happiness score while countries in Africa and Middle East
Asia has relatively lower happiness score in 2015.</p>
</div>
<div id="section-1" class="section level3">
<h3>2016</h3>
<p><strong>At Country Level</strong></p>
<pre class="r"><code>combined_happiness|&gt;
  filter(year == &quot;2016&quot;)|&gt;
  mutate(country = fct_reorder(country, score))|&gt;
  plot_ly(
    x = ~country, y = ~score, color = ~region,
    type = &#39;bar&#39;, colors = &#39;viridis&#39;
  )|&gt;
  layout(
    title = &quot;2016 World Happiness Score Rank&quot;,
    xaxis = list(title = &quot;Countries&quot;, tickfont = list(size = 6)),
    yaxis = list(title = &quot;Happiness Score&quot;),
    autosize = FALSE,
    width = 800,
    height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a1a40f93aec577ef6d9e" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-a1a40f93aec577ef6d9e">{"x":{"visdat":{"b30a677f1943":["function () ","plotlyVisDat"]},"cur_data":"b30a677f1943","attrs":{"b30a677f1943":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"2016 World Happiness Score Rank","xaxis":{"domain":[0,1],"automargin":true,"title":"Countries","tickfont":{"size":6},"type":"category","categoryorder":"array","categoryarray":["Burundi","Syria","Togo","Afghanistan","Benin","Rwanda","Guinea","Liberia","Tanzania","Madagascar","Yemen","Burkina Faso","Uganda","Chad","South Sudan","Niger","Angola","Cambodia","Ivory Coast","Comoros","Botswana","Haiti","Mali","Gabon","Sudan","Malawi","Zimbabwe","Mauritania","Bulgaria","Senegal","Congo (Brazzaville)","Georgia","Congo (Kinshasa)","Ghana","Ukraine","Kenya","Armenia","Egypt","Myanmar","India","Sri Lanka","South Africa","Ethiopia","Cameroon","Namibia","Iraq","Sierra Leone","Bangladesh","Albania","Palestinian Territories","Nepal","Zambia","Iran","Honduras","Nigeria","Laos","Mongolia","Tajikistan","Greece","Tunisia","Somaliland Region","Vietnam","Macedonia","Portugal","Lebanon","Pakistan","Hungary","Morocco","Dominican Republic","Montenegro","Bosnia and Herzegovina","Serbia","Kyrgyzstan","Bhutan","China","Philippines","Azerbaijan","Jordan","Indonesia","Turkey","Kosovo","Somalia","Hong Kong","Croatia","Jamaica","Estonia","Romania","Paraguay","Cyprus","Latvia","Libya","Mauritius","Turkmenistan","Peru","Slovenia","North Cyprus","Belarus","Lithuania","Bolivia","Poland","South Korea","Russia","Moldova","Kazakhstan","Japan","Belize","Ecuador","Italy","Uzbekistan","Nicaragua","Malaysia","El Salvador","Slovakia","Venezuela","Trinidad and Tobago","Bahrain","Kuwait","Suriname","Guatemala","Algeria","Spain","Qatar","Saudi Arabia","Taiwan","Thailand","France","Colombia","Malta","Uruguay","United Arab Emirates","Czech Republic","Argentina","Panama","Chile","United Kingdom","Singapore","Mexico","Luxembourg","Ireland","Belgium","Brazil","Germany","Puerto Rico","Costa Rica","United States","Austria","Israel","Sweden","Australia","New Zealand","Netherlands","Canada","Finland","Norway","Iceland","Switzerland","Denmark"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Happiness Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["New Zealand","Australia"],"y":[7.3339999999999996,7.3129999999999997],"type":"bar","name":"Australia and New Zealand","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Czech Republic","Slovakia","Uzbekistan","Kazakhstan","Moldova","Russia","Poland","Lithuania","Belarus","Slovenia","Turkmenistan","Latvia","Romania","Estonia","Croatia","Kosovo","Azerbaijan","Kyrgyzstan","Serbia","Bosnia and Herzegovina","Montenegro","Hungary","Macedonia","Tajikistan","Albania","Armenia","Ukraine","Georgia","Bulgaria"],"y":[6.5960000000000001,6.0780000000000003,5.9870000000000001,5.9189999999999996,5.8970000000000002,5.8559999999999999,5.835,5.8129999999999997,5.8019999999999996,5.7679999999999998,5.6580000000000004,5.5599999999999996,5.5279999999999996,5.5170000000000003,5.4880000000000004,5.4009999999999998,5.2910000000000004,5.1849999999999996,5.1769999999999996,5.1630000000000003,5.1609999999999996,5.1449999999999996,5.1210000000000004,4.9960000000000004,4.6550000000000002,4.3600000000000003,4.3239999999999998,4.2519999999999998,4.2169999999999996],"type":"bar","name":"Central and Eastern Europe","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Taiwan","Japan","South Korea","Hong Kong","China","Mongolia"],"y":[6.3789999999999996,5.9210000000000003,5.835,5.4580000000000002,5.2450000000000001,4.907],"type":"bar","name":"Eastern Asia","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Costa Rica","Puerto Rico","Brazil","Mexico","Chile","Panama","Argentina","Uruguay","Colombia","Guatemala","Suriname","Trinidad and Tobago","Venezuela","El Salvador","Nicaragua","Ecuador","Belize","Bolivia","Peru","Paraguay","Jamaica","Dominican Republic","Honduras","Haiti"],"y":[7.0869999999999997,7.0389999999999997,6.952,6.7779999999999996,6.7050000000000001,6.7009999999999996,6.6500000000000004,6.5449999999999999,6.4809999999999999,6.3239999999999998,6.2690000000000001,6.1680000000000001,6.0839999999999996,6.0679999999999996,5.992,5.976,5.9560000000000004,5.8220000000000001,5.7430000000000003,5.5380000000000003,5.5099999999999998,5.1550000000000002,4.8710000000000004,4.0279999999999996],"type":"bar","name":"Latin America and Caribbean","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Israel","United Arab Emirates","Saudi Arabia","Qatar","Algeria","Kuwait","Bahrain","Libya","Turkey","Jordan","Morocco","Lebanon","Tunisia","Iran","Palestinian Territories","Iraq","Egypt","Yemen","Syria"],"y":[7.2670000000000003,6.5730000000000004,6.3789999999999996,6.375,6.3550000000000004,6.2389999999999999,6.218,5.6150000000000002,5.3890000000000002,5.3029999999999999,5.1509999999999998,5.1289999999999996,5.0449999999999999,4.8129999999999997,4.7539999999999996,4.5750000000000002,4.3620000000000001,3.7240000000000002,3.069],"type":"bar","name":"Middle East and Northern Africa","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Canada","United States"],"y":[7.4039999999999999,7.1040000000000001],"type":"bar","name":"North America","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Singapore","Thailand","Malaysia","Indonesia","Philippines","Vietnam","Laos","Myanmar","Cambodia"],"y":[6.7389999999999999,6.4740000000000002,6.0049999999999999,5.3140000000000001,5.2789999999999999,5.0609999999999999,4.8760000000000003,4.3949999999999996,3.907],"type":"bar","name":"Southeastern Asia","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bhutan","Pakistan","Nepal","Bangladesh","Sri Lanka","India","Afghanistan"],"y":[5.1959999999999997,5.1319999999999997,4.7930000000000001,4.6429999999999998,4.415,4.4039999999999999,3.3599999999999999],"type":"bar","name":"Southern Asia","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mauritius","Somalia","Somaliland Region","Nigeria","Zambia","Sierra Leone","Namibia","Cameroon","Ethiopia","South Africa","Kenya","Ghana","Congo (Kinshasa)","Congo (Brazzaville)","Senegal","Mauritania","Zimbabwe","Malawi","Sudan","Gabon","Mali","Botswana","Comoros","Ivory Coast","Angola","Niger","South Sudan","Chad","Burkina Faso","Uganda","Madagascar","Tanzania","Liberia","Guinea","Rwanda","Benin","Togo","Burundi"],"y":[5.6479999999999997,5.4400000000000004,5.0570000000000004,4.875,4.7949999999999999,4.6349999999999998,4.5739999999999998,4.5129999999999999,4.508,4.4589999999999996,4.3559999999999999,4.2759999999999998,4.2720000000000002,4.2359999999999998,4.2190000000000003,4.2009999999999996,4.1929999999999996,4.1559999999999997,4.1390000000000002,4.1210000000000004,4.0730000000000004,3.9740000000000002,3.956,3.9159999999999999,3.8660000000000001,3.8559999999999999,3.8319999999999999,3.7629999999999999,3.7389999999999999,3.7389999999999999,3.6949999999999998,3.6659999999999999,3.6219999999999999,3.6070000000000002,3.5150000000000001,3.484,3.3029999999999999,2.9049999999999998],"type":"bar","name":"Sub-Saharan Africa","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Denmark","Switzerland","Iceland","Norway","Finland","Netherlands","Sweden","Austria","Germany","Belgium","Ireland","Luxembourg","United Kingdom","Malta","France","Spain","Italy","North Cyprus","Cyprus","Portugal","Greece"],"y":[7.5259999999999998,7.5090000000000003,7.5010000000000003,7.4980000000000002,7.4130000000000003,7.3390000000000004,7.2910000000000004,7.1189999999999998,6.9939999999999998,6.9290000000000003,6.907,6.8710000000000004,6.7249999999999996,6.4880000000000004,6.4779999999999998,6.3609999999999998,5.9770000000000003,5.7709999999999999,5.5460000000000003,5.1230000000000002,5.0330000000000004],"type":"bar","name":"Western Europe","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>At Region Level</strong></p>
<pre class="r"><code>combined_happiness |&gt;
  filter(year == &quot;2016&quot;) |&gt;
  group_by(region) |&gt;
  mutate(region_avg = mean(score)) |&gt;
  arrange(desc(region_avg)) |&gt;
  summarize(region = unique(region), score = unique(region_avg)) |&gt;
  ggplot(aes(x = reorder(region, -score), y = score, fill = region)) +
  geom_bar(stat = &quot;identity&quot;) +
  labs(title = &quot;2016 World Happiness Score Rank&quot;, x = &quot;Regions&quot;, y = &quot;Happiness Score&quot;) +
  scale_x_discrete(labels = label_wrap_gen(width = 10)) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code>hp_2016 &lt;- worldjoin |&gt;
  filter(year == &quot;2016&quot;) |&gt;
  ggplot(mapping = aes(
    x=long,
    y=lat,
    group=group)) +
  scale_fill_viridis_c(option = &quot;C&quot;) +
  coord_fixed(1.3) +
  geom_polygon(aes(fill=score)) +
  ggtitle(&quot;Happiness Score 2016&quot;) +
  cleanup

hp_2016</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>At <em>country level</em>, in year 2016, Denmark has the highest
happiness score while Burundi has the lowest happiness score among 157
countries.</p>
<p>At <em>region level</em>, in year 2016, Australia and New Zealand has
the highest happiness score while Sub-Saharan Africa has the lowest
happiness score among 10 regions.</p>
<p>In general, countries in Europe, Australia, North and South America
have higher happiness score while countries in Africa and Middle East
Asia has relatively lower happiness score in 2016</p>
</div>
<div id="section-2" class="section level3">
<h3>2017</h3>
<p><strong>At Country Level</strong></p>
<pre class="r"><code>combined_happiness|&gt;
  filter(year == &quot;2017&quot;)|&gt;
  mutate(country = fct_reorder(country, score))|&gt;
  plot_ly(
    x = ~country, y = ~score, color = ~region,
    type = &#39;bar&#39;, colors = &#39;viridis&#39;
  )|&gt;
  layout(
    title = &quot;2017 World Happiness Score Rank&quot;,
    xaxis = list(title = &quot;Countries&quot;, tickfont = list(size = 6)),
    yaxis = list(title = &quot;Happiness Score&quot;),
    autosize = FALSE,
    width = 800,
    height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f7cff090ff273cf79ec2" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-f7cff090ff273cf79ec2">{"x":{"visdat":{"b30a29e04400":["function () ","plotlyVisDat"]},"cur_data":"b30a29e04400","attrs":{"b30a29e04400":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"2017 World Happiness Score Rank","xaxis":{"domain":[0,1],"automargin":true,"title":"Countries","tickfont":{"size":6},"type":"category","categoryorder":"array","categoryarray":["Central African Republic","Burundi","Tanzania","Syria","Rwanda","Togo","Guinea","Liberia","South Sudan","Yemen","Haiti","Madagascar","Benin","Botswana","Afghanistan","Angola","Lesotho","Zimbabwe","Chad","Malawi","Niger","Burkina Faso","Uganda","Ukraine","Ghana","Sudan","Cambodia","Ivory Coast","Mali","Congo (Kinshasa)","Georgia","Congo (Brazzaville)","Mauritania","India","Armenia","Sri Lanka","Ethiopia","Gabon","Iraq","Zambia","Senegal","Myanmar","Mozambique","Kenya","Namibia","Bangladesh","Albania","Iran","Cameroon","Sierra Leone","Bulgaria","Egypt","Palestinian Territories","Tunisia","South Africa","Mongolia","Nepal","Kyrgyzstan","Bhutan","Tajikistan","Nigeria","Vietnam","Somalia","Macedonia","Honduras","Bosnia and Herzegovina","Portugal","Lebanon","Greece","Dominican Republic","Azerbaijan","Morocco","Montenegro","Venezuela","Indonesia","Pakistan","China","Kosovo","Croatia","Jamaica","Hungary","Jordan","Serbia","Philippines","Hong Kong","Paraguay","Turkey","Libya","Belarus","Estonia","Cyprus","Mauritius","Peru","Slovenia","North Cyprus","Kazakhstan","Turkmenistan","Bolivia","Romania","Moldova","South Korea","Latvia","Algeria","Lithuania","Japan","Belize","Russia","Italy","Uzbekistan","Poland","El Salvador","Ecuador","Nicaragua","Malaysia","Bahrain","Slovakia","Kuwait","Trinidad and Tobago","Saudi Arabia","Colombia","Qatar","Spain","Taiwan","Thailand","France","Panama","Guatemala","Uruguay","Malta","Singapore","Mexico","Argentina","Czech Republic","Brazil","United Arab Emirates","Chile","United Kingdom","Luxembourg","Belgium","Germany","Ireland","United States","Austria","Costa Rica","Israel","Australia","Sweden","New Zealand","Canada","Netherlands","Finland","Switzerland","Iceland","Denmark","Norway"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Happiness Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["New Zealand","Australia"],"y":[7.3140001296997097,7.2839999198913601],"type":"bar","name":"Australia and New Zealand","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Czech Republic","Slovakia","Poland","Uzbekistan","Russia","Lithuania","Latvia","Moldova","Romania","Turkmenistan","Kazakhstan","Slovenia","Estonia","Belarus","Serbia","Hungary","Croatia","Kosovo","Montenegro","Azerbaijan","Bosnia and Herzegovina","Macedonia","Tajikistan","Kyrgyzstan","Bulgaria","Albania","Armenia","Georgia","Ukraine"],"y":[6.6090002059936497,6.09800004959106,5.97300004959106,5.9710001945495597,5.9629998207092303,5.90199995040894,5.8499999046325701,5.8379998207092303,5.8249998092651403,5.82200002670288,5.8189997673034703,5.7579998970031703,5.6110000610351598,5.5689997673034703,5.3949999809265101,5.3239998817443803,5.2930002212524396,5.2789998054504403,5.23699998855591,5.2340002059936497,5.1820001602172896,5.1750001907348597,5.0409998893737802,5.0040001869201696,4.7140002250671396,4.6440000534057599,4.3759999275207502,4.2859997749328604,4.0960001945495597],"type":"bar","name":"Central and Eastern Europe","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Taiwan","Japan","South Korea","Hong Kong","China","Mongolia"],"y":[6.4219999313354501,5.9200000762939498,5.8379998207092303,5.4720001220703098,5.2729997634887704,4.9549999237060502],"type":"bar","name":"Eastern Asia","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Costa Rica","Chile","Brazil","Argentina","Mexico","Uruguay","Guatemala","Panama","Colombia","Trinidad and Tobago","Nicaragua","Ecuador","El Salvador","Belize","Bolivia","Peru","Paraguay","Jamaica","Venezuela","Dominican Republic","Honduras","Haiti"],"y":[7.0789999961853001,6.65199995040894,6.6350002288818404,6.59899997711182,6.5780000686645499,6.4539999961853001,6.4539999961853001,6.4520001411437997,6.3569998741149902,6.1680002212524396,6.0710000991821298,6.0079998970031703,6.0029997825622603,5.9559998512268102,5.8229999542236301,5.7150001525878897,5.4930000305175799,5.3109998703002903,5.25,5.2300000190734899,5.1810002326965297,3.6029999256134002],"type":"bar","name":"Latin America and Caribbean","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Israel","United Arab Emirates","Qatar","Saudi Arabia","Kuwait","Bahrain","Algeria","Libya","Turkey","Jordan","Morocco","Lebanon","Tunisia","Palestinian Territories","Egypt","Iran","Iraq","Yemen","Syria"],"y":[7.2129998207092303,6.6479997634887704,6.375,6.3439998626709002,6.1050000190734899,6.0869998931884801,5.8720002174377397,5.5250000953674299,5.5,5.3359999656677202,5.2350001335143999,5.2249999046325701,4.8049998283386204,4.7750000953674299,4.7350001335143999,4.6919999122619602,4.4970002174377397,3.59299993515015,3.4619998931884801],"type":"bar","name":"Middle East and Northern Africa","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Canada","United States"],"y":[7.31599998474121,6.9930000305175799],"type":"bar","name":"North America","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Singapore","Thailand","Malaysia","Philippines","Indonesia","Vietnam","Myanmar","Cambodia"],"y":[6.57200002670288,6.4239997863769496,6.0840001106262198,5.4299998283386204,5.2620000839233398,5.0739998817443803,4.5450000762939498,4.1680002212524396],"type":"bar","name":"Southeastern Asia","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Pakistan","Bhutan","Nepal","Bangladesh","Sri Lanka","India","Afghanistan"],"y":[5.2690000534057599,5.0110001564025897,4.9619998931884801,4.6079998016357404,4.4400000572204599,4.3150000572204599,3.7939999103546098],"type":"bar","name":"Southern Asia","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mauritius","Somalia","Nigeria","South Africa","Sierra Leone","Cameroon","Namibia","Kenya","Mozambique","Senegal","Zambia","Gabon","Ethiopia","Mauritania","Congo (Brazzaville)","Congo (Kinshasa)","Mali","Ivory Coast","Sudan","Ghana","Uganda","Burkina Faso","Niger","Malawi","Chad","Zimbabwe","Lesotho","Angola","Botswana","Benin","Madagascar","South Sudan","Liberia","Guinea","Togo","Rwanda","Tanzania","Burundi","Central African Republic"],"y":[5.6290001869201696,5.15100002288818,5.0739998817443803,4.8289999961853001,4.7090001106262198,4.6950001716613796,4.5739998817443803,4.55299997329712,4.5500001907348597,4.5349998474121103,4.5139999389648402,4.4650001525878897,4.46000003814697,4.2919998168945304,4.2909998893737802,4.2800002098083496,4.1900000572204599,4.1799998283386204,4.1389999389648402,4.1199998855590803,4.0809998512268102,4.03200006484985,4.0279998779296902,3.9700000286102299,3.9360001087188698,3.875,3.8080000877380402,3.7950000762939502,3.7660000324249299,3.65700006484985,3.6440000534057599,3.5910000801086399,3.5329999923706099,3.5069999694824201,3.4949998855590798,3.4709999561309801,3.34899997711182,2.9049999713897701,2.6930000782012899],"type":"bar","name":"Sub-Saharan Africa","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Norway","Denmark","Iceland","Switzerland","Finland","Netherlands","Sweden","Austria","Ireland","Germany","Belgium","Luxembourg","United Kingdom","Malta","France","Spain","Italy","North Cyprus","Cyprus","Greece","Portugal"],"y":[7.5370001792907697,7.5219998359680202,7.5040001869201696,7.4939999580383301,7.4689998626709002,7.3769998550415004,7.2839999198913601,7.0060000419616699,6.9770002365112296,6.9510002136230504,6.8909997940063503,6.8629999160766602,6.7140002250671396,6.52699995040894,6.4419999122619602,6.4029998779296902,5.9640002250671396,5.8099999427795401,5.6209998130798304,5.2270002365112296,5.1950001716613796],"type":"bar","name":"Western Europe","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>At Region Level</strong></p>
<pre class="r"><code>combined_happiness |&gt;
  filter(year == &quot;2017&quot;) |&gt;
  group_by(region) |&gt;
  mutate(region_avg = mean(score)) |&gt;
  arrange(desc(region_avg)) |&gt;
  summarize(region = unique(region), score = unique(region_avg)) |&gt;
  ggplot(aes(x = reorder(region, -score), y = score, fill = region)) +
  geom_bar(stat = &quot;identity&quot;) +
  labs(title = &quot;2017 World Happiness Score Rank&quot;, x = &quot;Regions&quot;, y = &quot;Happiness Score&quot;) +
  scale_x_discrete(labels = label_wrap_gen(width = 10)) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code>hp_2017 &lt;- worldjoin |&gt;
  filter(year == &quot;2017&quot;) |&gt;
  ggplot(mapping = aes(
    x=long,
    y=lat,
    group=group)) +
  scale_fill_viridis_c(option = &quot;C&quot;) +
  coord_fixed(1.3) +
  geom_polygon(aes(fill=score)) +
  ggtitle(&quot;Happiness Score 2017&quot;) +
  cleanup

hp_2017</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>At <em>country level</em>, in year 2017, Norway has the highest
happiness score while Central African Republic has the lowest happiness
score among 155 countries.</p>
<p>At <em>region level</em>, In year 2017, Australia and New Zealand has
the highest happiness score while Sub-Saharan Africa has the lowest
happiness score among 10 regions.</p>
<p>In general, countries in Europe, Australia, North and South America
have higher happiness score while countries in Africa and Middle East
Asia has relatively lower happiness score in 2017.</p>
</div>
<div id="section-3" class="section level3">
<h3>2018</h3>
<p><strong>At Country Level</strong></p>
<pre class="r"><code>combined_happiness|&gt;
  filter(year == &quot;2018&quot;)|&gt;
  mutate(country = fct_reorder(country, score))|&gt;
  plot_ly(
    x = ~country, y = ~score, color = ~region,
    type = &#39;bar&#39;, colors = &#39;viridis&#39;
  )|&gt;
  layout(
    title = &quot;2018 World Happiness Score Rank&quot;,
    xaxis = list(title = &quot;Countries&quot;, tickfont = list(size = 6)),
    yaxis = list(title = &quot;Happiness Score&quot;),
    autosize = FALSE,
    width = 800,
    height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-69a7c6f69fc7ebc69b6a" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-69a7c6f69fc7ebc69b6a">{"x":{"visdat":{"b30a93001eb":["function () ","plotlyVisDat"]},"cur_data":"b30a93001eb","attrs":{"b30a93001eb":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"2018 World Happiness Score Rank","xaxis":{"domain":[0,1],"automargin":true,"title":"Countries","tickfont":{"size":6},"type":"category","categoryorder":"array","categoryarray":["Burundi","Central African Republic","South Sudan","Tanzania","Yemen","Rwanda","Syria","Liberia","Haiti","Malawi","Botswana","Afghanistan","Zimbabwe","Madagascar","Angola","Lesotho","Guinea","Togo","Ukraine","Sudan","Benin","Uganda","Niger","India","Congo (Kinshasa)","Chad","Myanmar","Armenia","Georgia","Ethiopia","Mauritania","Zambia","Kenya","Mozambique","Egypt","Burkina Faso","Cambodia","Namibia","Mali","Iraq","Sri Lanka","Bangladesh","Congo (Brazzaville)","Sierra Leone","Albania","Tunisia","Laos","Senegal","Ghana","Ivory Coast","Iran","South Africa","Palestinian Territories","Gabon","Venezuela","Nepal","Bulgaria","Cameroon","Somalia","Bhutan","Indonesia","Vietnam","Mongolia","Bosnia and Herzegovina","Kyrgyzstan","Nigeria","Jordan","Macedonia","Tajikistan","Azerbaijan","China","Morocco","Algeria","Dominican Republic","Croatia","Montenegro","Greece","Lebanon","Serbia","Portugal","Hong Kong","Pakistan","Belarus","Turkey","Honduras","Philippines","Libya","Hungary","Turkmenistan","Moldova","Kosovo","Peru","Paraguay","Estonia","Bolivia","Cyprus","Kazakhstan","Russia","North Cyprus","South Korea","Jamaica","Mauritius","Japan","Latvia","Romania","Slovenia","Lithuania","Belize","Ecuador","Italy","Thailand","Kuwait","Uzbekistan","Bahrain","Poland","Nicaragua","El Salvador","Slovakia","Trinidad and Tobago","Colombia","Spain","Malaysia","Singapore","Saudi Arabia","Qatar","Uruguay","Guatemala","Argentina","Brazil","Panama","Taiwan","Chile","Mexico","France","Malta","Czech Republic","United Arab Emirates","Israel","United States","Luxembourg","Belgium","Germany","Ireland","Costa Rica","Austria","United Kingdom","Australia","Sweden","New Zealand","Canada","Netherlands","Switzerland","Iceland","Denmark","Norway","Finland"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Happiness Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["New Zealand","Australia"],"y":[7.3239999999999998,7.2720000000000002],"type":"bar","name":"Australia and New Zealand","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Czech Republic","Slovakia","Poland","Uzbekistan","Lithuania","Slovenia","Romania","Latvia","Russia","Kazakhstan","Estonia","Kosovo","Moldova","Turkmenistan","Hungary","Belarus","Serbia","Montenegro","Croatia","Azerbaijan","Tajikistan","Macedonia","Kyrgyzstan","Bosnia and Herzegovina","Bulgaria","Albania","Georgia","Armenia","Ukraine"],"y":[6.7110000000000003,6.173,6.1230000000000002,6.0960000000000001,5.952,5.9480000000000004,5.9450000000000003,5.9329999999999998,5.8099999999999996,5.79,5.7389999999999999,5.6619999999999999,5.6399999999999997,5.6360000000000001,5.6200000000000001,5.4829999999999997,5.3979999999999997,5.3470000000000004,5.3209999999999997,5.2009999999999996,5.1989999999999998,5.1849999999999996,5.1310000000000002,5.1289999999999996,4.9329999999999998,4.5860000000000003,4.3399999999999999,4.3209999999999997,4.1029999999999998],"type":"bar","name":"Central and Eastern Europe","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Taiwan","Japan","South Korea","Hong Kong","China","Mongolia"],"y":[6.4409999999999998,5.915,5.875,5.4299999999999997,5.2460000000000004,5.125],"type":"bar","name":"Eastern Asia","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Costa Rica","Mexico","Chile","Panama","Brazil","Argentina","Guatemala","Uruguay","Colombia","Trinidad and Tobago","El Salvador","Nicaragua","Ecuador","Belize","Jamaica","Bolivia","Paraguay","Peru","Honduras","Dominican Republic","Venezuela","Haiti"],"y":[7.0720000000000001,6.4880000000000004,6.476,6.4299999999999997,6.4189999999999996,6.3879999999999999,6.3819999999999997,6.3789999999999996,6.2599999999999998,6.1920000000000002,6.1669999999999998,6.141,5.9729999999999999,5.9560000000000004,5.8899999999999997,5.7519999999999998,5.681,5.6630000000000003,5.5039999999999996,5.3019999999999996,4.806,3.5819999999999999],"type":"bar","name":"Latin America and Caribbean","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Israel","United Arab Emirates","Qatar","Saudi Arabia","Bahrain","Kuwait","Libya","Turkey","Lebanon","Algeria","Morocco","Jordan","Palestinian Territories","Iran","Tunisia","Iraq","Egypt","Syria","Yemen"],"y":[6.8140000000000001,6.774,6.3739999999999997,6.3710000000000004,6.1050000000000004,6.0830000000000002,5.5659999999999998,5.4829999999999997,5.3579999999999997,5.2949999999999999,5.2539999999999996,5.1609999999999996,4.7430000000000003,4.7069999999999999,4.5919999999999996,4.4560000000000004,4.4189999999999996,3.4620000000000002,3.355],"type":"bar","name":"Middle East and Northern Africa","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Canada","United States"],"y":[7.3280000000000003,6.8860000000000001],"type":"bar","name":"North America","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Singapore","Malaysia","Thailand","Philippines","Vietnam","Indonesia","Laos","Cambodia","Myanmar"],"y":[6.343,6.3220000000000001,6.0720000000000001,5.524,5.1029999999999998,5.093,4.6230000000000002,4.4329999999999998,4.3079999999999998],"type":"bar","name":"Southeastern Asia","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Pakistan","Bhutan","Nepal","Bangladesh","Sri Lanka","India","Afghanistan"],"y":[5.4720000000000004,5.0819999999999999,4.8799999999999999,4.5,4.4710000000000001,4.1900000000000004,3.6320000000000001],"type":"bar","name":"Southern Asia","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mauritius","Nigeria","Somalia","Cameroon","Gabon","South Africa","Ivory Coast","Ghana","Senegal","Sierra Leone","Congo (Brazzaville)","Mali","Namibia","Burkina Faso","Mozambique","Kenya","Zambia","Mauritania","Ethiopia","Chad","Congo (Kinshasa)","Niger","Uganda","Benin","Sudan","Togo","Guinea","Lesotho","Angola","Madagascar","Zimbabwe","Botswana","Malawi","Liberia","Rwanda","Tanzania","South Sudan","Central African Republic","Burundi"],"y":[5.891,5.1550000000000002,4.9820000000000002,4.9749999999999996,4.758,4.7240000000000002,4.6710000000000003,4.657,4.6310000000000002,4.5709999999999997,4.5590000000000002,4.4470000000000001,4.4409999999999998,4.4240000000000004,4.4169999999999998,4.4100000000000001,4.3769999999999998,4.3559999999999999,4.3499999999999996,4.3010000000000002,4.2450000000000001,4.1660000000000004,4.1609999999999996,4.141,4.1390000000000002,3.9990000000000001,3.964,3.8079999999999998,3.7949999999999999,3.774,3.6920000000000002,3.5899999999999999,3.5870000000000002,3.4950000000000001,3.4079999999999999,3.3029999999999999,3.254,3.0830000000000002,2.9049999999999998],"type":"bar","name":"Sub-Saharan Africa","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Norway","Denmark","Iceland","Switzerland","Netherlands","Sweden","United Kingdom","Austria","Ireland","Germany","Belgium","Luxembourg","Malta","France","Spain","Italy","North Cyprus","Cyprus","Portugal","Greece"],"y":[7.6319999999999997,7.5940000000000003,7.5549999999999997,7.4950000000000001,7.4870000000000001,7.4409999999999998,7.3140000000000001,7.1900000000000004,7.1390000000000002,6.9770000000000003,6.9649999999999999,6.9269999999999996,6.9100000000000001,6.6269999999999998,6.4889999999999999,6.3099999999999996,6,5.835,5.7619999999999996,5.4100000000000001,5.3579999999999997],"type":"bar","name":"Western Europe","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>At Region Level</strong></p>
<pre class="r"><code>combined_happiness |&gt;
  filter(year == &quot;2018&quot;) |&gt;
  group_by(region) |&gt;
  mutate(region_avg = mean(score)) |&gt;
  arrange(desc(region_avg)) |&gt;
  summarize(region = unique(region), score = unique(region_avg)) |&gt;
  ggplot(aes(x = reorder(region, -score), y = score, fill = region)) +
  geom_bar(stat = &quot;identity&quot;) +
  labs(title = &quot;2018 World Happiness Score Rank&quot;, x = &quot;Regions&quot;, y = &quot;Happiness Score&quot;) +
  scale_x_discrete(labels = label_wrap_gen(width = 10)) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r"><code>hp_2018 &lt;- worldjoin |&gt;
  filter(year == &quot;2018&quot;) |&gt;
  ggplot(mapping = aes(
    x=long,
    y=lat,
    group=group)) +
  scale_fill_viridis_c(option = &quot;C&quot;) +
  coord_fixed(1.3) +
  geom_polygon(aes(fill=score)) +
  ggtitle(&quot;Happiness Score 2018&quot;) +
  cleanup

hp_2018</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>At <em>country level</em>, in year 2018, Finland has the highest
happiness score while Burundi has the lowest happiness score among 156
countries.</p>
<p>At <em>region level</em>, in year 2018, Australia and New Zealand has
the highest happiness score while Sub-Saharan Africa has the lowest
happiness score among 10 regions.</p>
<p>In general, countries in Europe, Australia, North and South America
have higher happiness score while countries in Africa and Middle East
Asia has relatively lower happiness score in 2018.</p>
</div>
<div id="section-4" class="section level3">
<h3>2019</h3>
<p><strong>At Country Level</strong></p>
<pre class="r"><code>combined_happiness|&gt;
  filter(year == &quot;2019&quot;)|&gt;
  mutate(country = fct_reorder(country, score))|&gt;
  plot_ly(
    x = ~country, y = ~score, color = ~region,
    type = &#39;bar&#39;, colors = &#39;viridis&#39;
  )|&gt;
  layout(
    title = &quot;2019 World Happiness Score Rank&quot;,
    xaxis = list(title = &quot;Countries&quot;, tickfont = list(size = 6)),
    yaxis = list(title = &quot;Happiness Score&quot;),
    autosize = FALSE,
    width = 800,
    height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-320545b4b4bcd2e01f8c" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-320545b4b4bcd2e01f8c">{"x":{"visdat":{"b30a5f55142e":["function () ","plotlyVisDat"]},"cur_data":"b30a5f55142e","attrs":{"b30a5f55142e":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"2019 World Happiness Score Rank","xaxis":{"domain":[0,1],"automargin":true,"title":"Countries","tickfont":{"size":6},"type":"category","categoryorder":"array","categoryarray":["South Sudan","Central African Republic","Afghanistan","Tanzania","Rwanda","Yemen","Malawi","Syria","Botswana","Haiti","Zimbabwe","Burundi","Lesotho","Madagascar","Comoros","Liberia","India","Togo","Zambia","Egypt","Uganda","Swaziland","Ethiopia","Ukraine","Chad","Myanmar","Sri Lanka","Sierra Leone","Mali","Congo (Kinshasa)","Iraq","Bangladesh","Tunisia","Mozambique","Mauritania","Kenya","Gambia","Georgia","Guinea","Iran","Armenia","Burkina Faso","Niger","Namibia","Somalia","Senegal","Palestinian Territories","Cambodia","Venezuela","Albania","South Africa","Laos","Gabon","Congo (Brazzaville)","Benin","Jordan","Nepal","Ivory Coast","Ghana","Bulgaria","Cameroon","Bhutan","Vietnam","China","Indonesia","Lebanon","Azerbaijan","Morocco","Algeria","Turkmenistan","Kyrgyzstan","Nigeria","North Macedonia","Mongolia","Greece","Belarus","Malaysia","Turkey","Bosnia and Herzegovina","Dominican Republic","Hong Kong","Croatia","Tajikistan","Montenegro","Libya","Moldova","Serbia","Philippines","Russia","Pakistan","Portugal","Peru","North Cyprus","Paraguay","Hungary","Bolivia","Kazakhstan","Honduras","Japan","Mauritius","Jamaica","Estonia","South Korea","Latvia","Thailand","Kuwait","Ecuador","Cyprus","Romania","Argentina","Kosovo","Nicaragua","Slovenia","Colombia","Lithuania","Uzbekistan","Poland","Trinidad and Tobago","Slovakia","Bahrain","Italy","El Salvador","Singapore","Uruguay","Brazil","Panama","Spain","Qatar","Saudi Arabia","Guatemala","Chile","Taiwan","France","Mexico","Malta","United Arab Emirates","Czech Republic","United States","Belgium","Germany","Ireland","United Kingdom","Luxembourg","Israel","Costa Rica","Australia","Austria","Canada","New Zealand","Sweden","Switzerland","Netherlands","Iceland","Norway","Denmark","Finland"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Happiness Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["New Zealand","Australia"],"y":[7.3070000000000004,7.2279999999999998],"type":"bar","name":"Australia and New Zealand","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Czech Republic","Slovakia","Poland","Uzbekistan","Lithuania","Slovenia","Kosovo","Romania","Latvia","Estonia","Kazakhstan","Hungary","Russia","Serbia","Moldova","Montenegro","Tajikistan","Croatia","Bosnia and Herzegovina","Belarus","North Macedonia","Kyrgyzstan","Turkmenistan","Azerbaijan","Bulgaria","Albania","Armenia","Georgia","Ukraine"],"y":[6.8520000000000003,6.1980000000000004,6.1820000000000004,6.1740000000000004,6.149,6.1180000000000003,6.0999999999999996,6.0700000000000003,5.9400000000000004,5.8929999999999998,5.8090000000000002,5.758,5.6479999999999997,5.6029999999999998,5.5289999999999999,5.5229999999999997,5.4669999999999996,5.4320000000000004,5.3860000000000001,5.3230000000000004,5.274,5.2610000000000001,5.2469999999999999,5.2080000000000002,5.0110000000000001,4.7190000000000003,4.5590000000000002,4.5190000000000001,4.3319999999999999],"type":"bar","name":"Central and Eastern Europe","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Taiwan","South Korea","Japan","Hong Kong","Mongolia","China"],"y":[6.4459999999999997,5.8949999999999996,5.8860000000000001,5.4299999999999997,5.2850000000000001,5.1909999999999998],"type":"bar","name":"Eastern Asia","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Costa Rica","Mexico","Chile","Guatemala","Panama","Brazil","Uruguay","El Salvador","Trinidad and Tobago","Colombia","Nicaragua","Argentina","Ecuador","Jamaica","Honduras","Bolivia","Paraguay","Peru","Dominican Republic","Venezuela","Haiti"],"y":[7.1669999999999998,6.5949999999999998,6.444,6.4359999999999999,6.3209999999999997,6.2999999999999998,6.2930000000000001,6.2530000000000001,6.1920000000000002,6.125,6.1050000000000004,6.0860000000000003,6.0279999999999996,5.8899999999999997,5.8600000000000003,5.7789999999999999,5.7430000000000003,5.6970000000000001,5.4249999999999998,4.7069999999999999,3.597],"type":"bar","name":"Latin America and Caribbean","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Israel","United Arab Emirates","Saudi Arabia","Qatar","Bahrain","Kuwait","Libya","Turkey","Algeria","Morocco","Lebanon","Jordan","Palestinian Territories","Iran","Tunisia","Iraq","Egypt","Syria","Yemen"],"y":[7.1390000000000002,6.8250000000000002,6.375,6.3739999999999997,6.1989999999999998,6.0209999999999999,5.5250000000000004,5.3730000000000002,5.2110000000000003,5.2080000000000002,5.1970000000000001,4.9059999999999997,4.6959999999999997,4.548,4.4610000000000003,4.4370000000000003,4.1660000000000004,3.4620000000000002,3.3799999999999999],"type":"bar","name":"Middle East and Northern Africa","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Canada","United States"],"y":[7.2779999999999996,6.8920000000000003],"type":"bar","name":"North America","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Singapore","Thailand","Philippines","Malaysia","Indonesia","Vietnam","Laos","Cambodia","Myanmar"],"y":[6.2619999999999996,6.008,5.6310000000000002,5.3390000000000004,5.1920000000000002,5.1749999999999998,4.7960000000000003,4.7000000000000002,4.3600000000000003],"type":"bar","name":"Southeastern Asia","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Pakistan","Bhutan","Nepal","Bangladesh","Sri Lanka","India","Afghanistan"],"y":[5.6529999999999996,5.0819999999999999,4.9130000000000003,4.4560000000000004,4.3659999999999997,4.0149999999999997,3.2029999999999998],"type":"bar","name":"Southern Asia","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mauritius","Nigeria","Cameroon","Ghana","Ivory Coast","Benin","Congo (Brazzaville)","Gabon","South Africa","Senegal","Somalia","Namibia","Niger","Burkina Faso","Guinea","Gambia","Kenya","Mauritania","Mozambique","Congo (Kinshasa)","Mali","Sierra Leone","Chad","Ethiopia","Swaziland","Uganda","Zambia","Togo","Liberia","Comoros","Madagascar","Lesotho","Burundi","Zimbabwe","Botswana","Malawi","Rwanda","Tanzania","Central African Republic","South Sudan"],"y":[5.8879999999999999,5.2649999999999997,5.0439999999999996,4.9960000000000004,4.944,4.883,4.8120000000000003,4.7990000000000004,4.7220000000000004,4.681,4.6680000000000001,4.6390000000000002,4.6280000000000001,4.5869999999999997,4.5339999999999998,4.516,4.5090000000000003,4.4900000000000002,4.4660000000000002,4.4180000000000001,4.3899999999999997,4.3739999999999997,4.3499999999999996,4.2859999999999996,4.2119999999999997,4.1890000000000001,4.1070000000000002,4.085,3.9750000000000001,3.9729999999999999,3.9329999999999998,3.802,3.7749999999999999,3.6629999999999998,3.488,3.4100000000000001,3.3340000000000001,3.2309999999999999,3.0830000000000002,2.8530000000000002],"type":"bar","name":"Sub-Saharan Africa","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Denmark","Norway","Iceland","Netherlands","Switzerland","Sweden","Austria","Luxembourg","United Kingdom","Ireland","Germany","Belgium","Malta","France","Spain","Italy","Cyprus","North Cyprus","Portugal","Greece"],"y":[7.7690000000000001,7.5999999999999996,7.5540000000000003,7.4939999999999998,7.4880000000000004,7.4800000000000004,7.343,7.2460000000000004,7.0899999999999999,7.0540000000000003,7.0209999999999999,6.9850000000000003,6.923,6.726,6.5919999999999996,6.3540000000000001,6.2229999999999999,6.0460000000000003,5.718,5.6929999999999996,5.2869999999999999],"type":"bar","name":"Western Europe","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>At Region Level</strong></p>
<pre class="r"><code>combined_happiness |&gt;
  filter(year == &quot;2019&quot;) |&gt;
  group_by(region) |&gt;
  mutate(region_avg = mean(score)) |&gt;
  arrange(desc(region_avg)) |&gt;
  summarize(region = unique(region), score = unique(region_avg)) |&gt;
  ggplot(aes(x = reorder(region, -score), y = score, fill = region)) +
  geom_bar(stat = &quot;identity&quot;) +
  labs(title = &quot;2019 World Happiness Score Rank&quot;, x = &quot;Regions&quot;, y = &quot;Happiness Score&quot;) +
  scale_x_discrete(labels = label_wrap_gen(width = 10)) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code>hp_2019 &lt;- worldjoin |&gt;
  filter(year == &quot;2019&quot;) |&gt;
  ggplot(mapping = aes(
    x=long,
    y=lat,
    group=group)) +
  scale_fill_viridis_c(option = &quot;C&quot;) +
  coord_fixed(1.3) +
  geom_polygon(aes(fill=score)) +
  ggtitle(&quot;Happiness Score 2019&quot;) +
  cleanup

hp_2019</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>At <em>country level</em>, in year 2019, Finland has the highest
happiness score while South Sudan has the lowest happiness score among
156 countries.</p>
<p>At <em>region level</em>, in year 2019, Australia and New Zealand has
the highest happiness score while Sub-Saharan Africa has the lowest
happiness score among 10 regions.</p>
<p>In general, countries in Europe, Australia, North and South America
have higher happiness score while countries in Africa and Middle East
Asia has relatively lower happiness score in 2019</p>
</div>
<div id="average-in-5-years" class="section level3">
<h3>Average in 5 years</h3>
<p><strong>At Country Level</strong></p>
<pre class="r"><code>hp_avg = 
combined_happiness |&gt;
  select(year, country, region, score) |&gt;
  pivot_wider(
    names_from = &quot;year&quot;,
    values_from = &quot;score&quot;
  ) |&gt;
  na.omit() |&gt;
  pivot_longer(
    &quot;2015&quot;:&quot;2019&quot;,
    names_to = &quot;year&quot;, 
    values_to = &quot;score&quot;
  ) |&gt;
  group_by(year, country) |&gt;
  mutate(score_avg = mean(score)) 

hp_avg|&gt;
  arrange(desc(score_avg)) |&gt;
  ggplot(aes(x = reorder(country, -score_avg), y = score_avg, fill = region)) +
  geom_bar(stat = &quot;identity&quot;) +
  labs(title = &quot;Average World Happiness Score Rank 2015-2019&quot;, x = &quot;Countries&quot;, y = &quot;Happiness Score&quot;) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size = 4)) +
  guides(fill = guide_legend(nrow = 3)) + 
  theme(legend.text = element_text(size = 6)) +
  theme(legend.position = &quot;bottom&quot;, plot.margin = margin(b = 10))</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p><strong>At Region Level</strong></p>
<pre class="r"><code>hp_avg|&gt;
  group_by(region) |&gt;
  mutate(region_avg = mean(score)) |&gt;
  arrange(desc(score_avg)) |&gt;
  summarize(region = unique(region), score = unique(region_avg)) |&gt;
  ggplot(aes(x = reorder(region, -score), y = score, fill = region)) +
  geom_bar(stat = &quot;identity&quot;) +
  labs(title = &quot;Average World Happiness Score Rank 2015-2019&quot;, x = &quot;Countries&quot;, y = &quot;Happiness Score&quot;) +
  scale_x_discrete(labels = label_wrap_gen(width = 10)) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<pre class="r"><code>wold_avg &lt;- inner_join(world_data, hp_avg, by = &quot;country&quot;)
hp_avg_plot &lt;- wold_avg |&gt;
  ggplot(mapping = aes(
    x=long,
    y=lat,
    group=group)) +
  scale_fill_viridis_c(option = &quot;C&quot;) +
  coord_fixed(1.3) +
  geom_polygon(aes(fill=score_avg)) +
  ggtitle(&quot;Average Happiness Score in 5 years&quot;) +
  cleanup

hp_avg_plot</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>At <em>country level</em>, we only keep countries that are in the top
rank for all five years. Among those 144 countries, Danmark has the
highest average happiness score while Burundi has the lowest average
happiness score in 5 years.</p>
<p>At <em>region level</em>, from 2015 to 2019, Australia and New
Zealand has the highest average happiness score while Sub-Saharan Africa
has the lowest average happiness score among 10 regions.</p>
<p>In general, countries in Europe, Australia, North and South America
have higher average happiness score while countries in Africa and Middle
East Asia has relatively lower average happiness score from 2015 to
2019.</p>
</div>
</div>
<div
id="which-countryregion-has-the-highest-and-lowest-score-for-the-six-happiness-factors"
class="section level2">
<h2>Which Country/Region Has the Highest and Lowest Score for the Six
Happiness Factors?</h2>
<div id="gdp-per-captia" class="section level3">
<h3>GDP Per Captia</h3>
<p><strong>At Country Level</strong></p>
<pre class="r"><code>hap_df |&gt;
  mutate(country = fct_reorder(country, gdp_per_capita))|&gt;
  plot_ly (
  x = ~country, y = ~gdp_per_capita, color = ~year,
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;GDP Per Capita&quot;,
    xaxis = list(
      title = &quot;country&quot;,
      tickfont = list(size = 6)
      ),
    yaxis = list(title = &quot;GDP Per Capita&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-fc77e23c3a84346271ec" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-fc77e23c3a84346271ec">{"x":{"visdat":{"b30a1e5cab78":["function () ","plotlyVisDat"]},"cur_data":"b30a1e5cab78","attrs":{"b30a1e5cab78":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"GDP Per Capita","xaxis":{"domain":[0,1],"automargin":true,"title":"country","tickfont":{"size":6},"type":"category","categoryorder":"array","categoryarray":["Somalia","Central African Republic","Burundi","Democratic Republic of the Congo","Liberia","Niger","Malawi","Mozambique","Guinea","Somaliland Region","Comoros","Madagascar","Togo","Ethiopia","Gambia","Burkina Faso","Haiti","Sierra Leone","Rwanda","Uganda","Afghanistan","Zimbabwe","Chad","South Sudan","Myanmar","Mali","Benin","Djibouti","Senegal","Nepal","Tanzania","Lesotho","Tajikistan","Kenya","Cameroon","Bangladesh","Yemen","Kyrgyzstan","Ivory Coast","Cambodia","Mauritania","Zambia","Ghana","Sudan","Honduras","Palestinian Territories","Pakistan","Republic of Congo","Moldova","Syria","Nicaragua","Nigeria","Laos","Uzbekistan","India","Vietnam","Swaziland","Bolivia","Guatemala","Morocco","Angola","El Salvador","Philippines","Bhutan","Ukraine","Jamaica","Armenia","Georgia","Paraguay","Belize","Kosovo","Jordan","Namibia","Ecuador","Egypt","Tunisia","Indonesia","Bosnia and Herzegovina","Albania","Mongolia","Sri Lanka","Peru","South Africa","North Macedonia","Colombia","Macedonia","Algeria","Brazil","Serbia","Dominican Republic","Lebanon","China","Costa Rica","Botswana","Azerbaijan","Iraq","Venezuela","Suriname","Thailand","Montenegro","Turkmenistan","Gabon","Libya","Belarus","Mexico","Argentina","Bulgaria","Iran","Mauritius","Uruguay","Panama","Croatia","Chile","Romania","Turkey","Kazakhstan","Greece","Russia","Latvia","Hungary","Poland","Malaysia","Portugal","Trinidad and Tobago","Estonia","Lithuania","Slovakia","Slovenia","Cyprus","North Cyprus","Czech Republic","Spain","Italy","Malta","Israel","South Korea","New Zealand","France","Japan","UK","Finland","Belgium","Puerto Rico","Oman","Bahrain","Canada","Taiwan","Australia","Germany","Austria","Iceland","Denmark","Sweden","Netherlands","Saudi Arabia","USA","Hong Kong","Switzerland","Ireland","Norway","Kuwait","Singapore","United Arab Emirates","Luxembourg","Qatar"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"GDP Per Capita"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Switzerland","Iceland","Denmark","Norway","Canada","Finland","Netherlands","Sweden","New Zealand","Australia","Israel","Costa Rica","Austria","Mexico","USA","Brazil","Luxembourg","Ireland","Belgium","United Arab Emirates","UK","Oman","Venezuela","Singapore","Panama","Germany","Chile","Qatar","France","Argentina","Czech Republic","Uruguay","Colombia","Thailand","Saudi Arabia","Spain","Malta","Taiwan","Kuwait","Suriname","Trinidad and Tobago","El Salvador","Guatemala","Uzbekistan","Slovakia","Japan","South Korea","Ecuador","Bahrain","Italy","Bolivia","Moldova","Paraguay","Kazakhstan","Slovenia","Lithuania","Nicaragua","Peru","Belarus","Poland","Malaysia","Croatia","Libya","Russia","Jamaica","North Cyprus","Cyprus","Algeria","Kosovo","Turkmenistan","Mauritius","Hong Kong","Estonia","Indonesia","Vietnam","Turkey","Kyrgyzstan","Nigeria","Bhutan","Azerbaijan","Pakistan","Jordan","Montenegro","China","Zambia","Romania","Serbia","Portugal","Latvia","Philippines","Somalia","Morocco","Macedonia","Mozambique","Albania","Bosnia and Herzegovina","Lesotho","Dominican Republic","Laos","Mongolia","Swaziland","Greece","Lebanon","Hungary","Honduras","Tajikistan","Tunisia","Palestinian Territories","Bangladesh","Iran","Ukraine","Iraq","South Africa","Ghana","Zimbabwe","Liberia","India","Sudan","Haiti","Democratic Republic of the Congo","Nepal","Ethiopia","Sierra Leone","Mauritania","Kenya","Djibouti","Armenia","Botswana","Myanmar","Georgia","Malawi","Sri Lanka","Cameroon","Bulgaria","Egypt","Yemen","Angola","Mali","Republic of Congo","Comoros","Uganda","Senegal","Gabon","Niger","Cambodia","Tanzania","Madagascar","Central African Republic","Chad","Guinea","Ivory Coast","Burkina Faso","Afghanistan","Rwanda","Benin","Syria","Burundi","Togo"],"y":[1.3965099999999999,1.3023199999999999,1.32548,1.4590000000000001,1.32629,1.2902499999999999,1.32944,1.3317099999999999,1.2501800000000001,1.33358,1.2285699999999999,0.95577999999999996,1.3372299999999999,1.02054,1.3945099999999999,0.98124,1.5639099999999999,1.33596,1.30782,1.42727,1.26637,1.3601099999999999,1.0442400000000001,1.52186,1.0635300000000001,1.32792,1.1071500000000001,1.69042,1.2777799999999999,1.0535099999999999,1.1789799999999999,1.06166,0.91861000000000004,0.96689999999999998,1.39541,1.23011,1.2074,1.29098,1.5542199999999999,0.99534,1.21183,0.76454,0.74553000000000003,0.63244,1.1689099999999999,1.27074,1.24461,0.86402000000000001,1.32376,1.2511399999999999,0.68132999999999999,0.59448000000000001,0.75985000000000003,1.1225400000000001,1.1849799999999999,1.14723,0.59325000000000006,0.90019000000000005,1.0319199999999999,1.1255500000000001,1.12486,1.0825400000000001,1.1314500000000001,1.13764,0.81037999999999999,1.2080599999999999,1.2081299999999999,0.93928999999999996,0.80147999999999997,0.95847000000000004,1.0076099999999999,1.3860399999999999,1.15174,0.82826999999999995,0.63216000000000006,1.06098,0.47427999999999998,0.65434999999999999,0.77041999999999999,1.02389,0.59543000000000001,0.90198,0.97438000000000002,0.89012000000000002,0.47038000000000002,1.04345,0.92052999999999996,1.15991,1.1131200000000001,0.70531999999999995,0.18847,0.73479000000000005,0.91851000000000005,0.083080000000000001,0.87866999999999995,0.83223000000000003,0.37545000000000001,0.89537,0.59065999999999996,0.82818999999999998,0.71206000000000003,1.1540600000000001,1.0256400000000001,1.12094,0.59531999999999996,0.39046999999999998,0.88112999999999997,0.59867000000000004,0.39752999999999999,1.0087999999999999,0.79906999999999995,0.98548999999999998,0.92049000000000003,0.54557999999999995,0.27100000000000002,0.071199999999999999,0.64498999999999995,0.52107000000000003,0.26673000000000002,0,0.35997000000000001,0.19073000000000001,0.33023999999999998,0.45406999999999997,0.36470999999999998,0.44024999999999997,0.76820999999999995,0.99355000000000004,0.27107999999999999,0.7419,0.016039999999999999,0.83523999999999998,0.42249999999999999,1.0121599999999999,0.88180000000000003,0.54649000000000003,0.75778000000000001,0.26074000000000003,0.67866000000000004,0.23905999999999999,0.21102000000000001,0.36498000000000003,1.0602400000000001,0.069400000000000003,0.46038000000000001,0.28520000000000001,0.20824000000000001,0.0785,0.34193000000000001,0.17416999999999999,0.46533999999999998,0.25812000000000002,0.31981999999999999,0.22208,0.28665000000000002,0.66320000000000001,0.015299999999999999,0.20868],"type":"bar","name":"2015","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Denmark","Switzerland","Iceland","Norway","Finland","Canada","Netherlands","New Zealand","Australia","Sweden","Israel","Austria","USA","Costa Rica","Puerto Rico","Germany","Brazil","Belgium","Ireland","Luxembourg","Mexico","Singapore","UK","Chile","Panama","Argentina","Czech Republic","United Arab Emirates","Uruguay","Malta","Colombia","France","Thailand","Saudi Arabia","Taiwan","Qatar","Spain","Algeria","Guatemala","Suriname","Kuwait","Bahrain","Trinidad and Tobago","Venezuela","Slovakia","El Salvador","Malaysia","Nicaragua","Uzbekistan","Italy","Ecuador","Belize","Japan","Kazakhstan","Moldova","Russia","Poland","South Korea","Bolivia","Lithuania","Belarus","North Cyprus","Slovenia","Peru","Turkmenistan","Mauritius","Libya","Latvia","Cyprus","Paraguay","Romania","Estonia","Jamaica","Croatia","Hong Kong","Somalia","Kosovo","Turkey","Indonesia","Jordan","Azerbaijan","Philippines","China","Bhutan","Kyrgyzstan","Serbia","Bosnia and Herzegovina","Montenegro","Dominican Republic","Morocco","Hungary","Pakistan","Lebanon","Portugal","Macedonia","Vietnam","Somaliland Region","Tunisia","Greece","Tajikistan","Mongolia","Laos","Nigeria","Honduras","Iran","Zambia","Nepal","Palestinian Territories","Albania","Bangladesh","Sierra Leone","Iraq","Namibia","Cameroon","Ethiopia","South Africa","Sri Lanka","India","Myanmar","Egypt","Armenia","Kenya","Ukraine","Ghana","Democratic Republic of the Congo","Georgia","Republic of Congo","Senegal","Bulgaria","Mauritania","Zimbabwe","Malawi","Sudan","Gabon","Mali","Haiti","Botswana","Comoros","Ivory Coast","Cambodia","Angola","Niger","South Sudan","Chad","Burkina Faso","Uganda","Yemen","Madagascar","Tanzania","Liberia","Guinea","Rwanda","Benin","Afghanistan","Togo","Syria","Burundi"],"y":[1.4417800000000001,1.5273300000000001,1.42666,1.57744,1.40598,1.44015,1.46468,1.36066,1.4444300000000001,1.45181,1.3376600000000001,1.45038,1.50796,1.0687899999999999,1.3594299999999999,1.44787,1.08754,1.4253899999999999,1.4834099999999999,1.6975199999999999,1.1150800000000001,1.6455500000000001,1.40283,1.2166999999999999,1.18306,1.15137,1.30915,1.57352,1.18157,1.30782,1.0303199999999999,1.3948799999999999,1.0892999999999999,1.48953,1.3972899999999999,1.8242700000000001,1.34253,1.0526599999999999,0.83453999999999995,1.0968599999999999,1.61714,1.44024,1.32572,1.13367,1.27973,0.87370000000000003,1.25142,0.69384000000000001,0.73590999999999995,1.3549500000000001,0.97306000000000004,0.87616000000000005,1.3800699999999999,1.22943,0.69177,1.23228,1.2458499999999999,1.35948,0.79422000000000004,1.2692000000000001,1.13062,1.31141,1.2994699999999999,0.99602000000000002,1.0801700000000001,1.1437200000000001,1.0668800000000001,1.2178800000000001,1.31857,0.89373000000000002,1.1697,1.2796400000000001,0.89332999999999996,1.18649,1.5106999999999999,0,0.90144999999999997,1.16492,0.95104,0.99673,1.1237299999999999,0.81216999999999995,1.0278,0.85270000000000001,0.56044000000000005,1.03437,0.93383000000000005,1.0783799999999999,1.0278700000000001,0.84057999999999999,1.24142,0.68815999999999999,1.1226799999999999,1.27607,1.0193000000000001,0.74036999999999997,0.25557999999999997,0.97724,1.2488600000000001,0.48835000000000001,0.98853000000000002,0.68042000000000002,0.75216000000000005,0.69428999999999996,1.11758,0.61202000000000001,0.44625999999999999,0.67023999999999995,0.95530000000000004,0.54176999999999997,0.36485000000000001,1.07474,0.93286999999999998,0.52497000000000005,0.29282999999999998,1.02416,0.97318000000000005,0.74036000000000002,0.34111999999999998,0.95394999999999996,0.86085999999999996,0.52266999999999997,0.87287000000000003,0.63107000000000002,0.056610000000000001,0.83792,0.77109000000000005,0.44313999999999998,1.1130599999999999,0.61390999999999996,0.35041,0.087090000000000001,0.63068999999999997,1.1585099999999999,0.31291999999999998,0.34097,1.09426,0.27509,0.55506999999999995,0.55603999999999998,0.84731000000000001,0.13270000000000001,0.39394000000000001,0.42214000000000002,0.31995000000000001,0.34719,0.57938999999999996,0.27954000000000001,0.47155000000000002,0.10706,0.22414999999999999,0.32845999999999997,0.39499000000000001,0.38227,0.28122999999999998,0.74719000000000002,0.068309999999999996],"type":"bar","name":"2016","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Norway","Denmark","Iceland","Switzerland","Finland","Netherlands","Canada","New Zealand","Sweden","Australia","Israel","Costa Rica","Austria","USA","Ireland","Germany","Belgium","Luxembourg","UK","Chile","United Arab Emirates","Brazil","Czech Republic","Argentina","Mexico","Singapore","Malta","Uruguay","Guatemala","Panama","France","Thailand","Taiwan","Spain","Qatar","Colombia","Saudi Arabia","Trinidad and Tobago","Kuwait","Slovakia","Bahrain","Malaysia","Nicaragua","Ecuador","El Salvador","Poland","Uzbekistan","Italy","Russia","Belize","Japan","Lithuania","Algeria","Latvia","South Korea","Moldova","Romania","Bolivia","Turkmenistan","Kazakhstan","North Cyprus","Slovenia","Peru","Mauritius","Cyprus","Estonia","Belarus","Libya","Turkey","Paraguay","Hong Kong","Philippines","Serbia","Jordan","Hungary","Jamaica","Croatia","Kosovo","China","Pakistan","Indonesia","Venezuela","Montenegro","Morocco","Azerbaijan","Dominican Republic","Greece","Lebanon","Portugal","Bosnia and Herzegovina","Honduras","Macedonia","Somalia","Vietnam","Nigeria","Tajikistan","Bhutan","Kyrgyzstan","Nepal","Mongolia","South Africa","Tunisia","Palestinian Territories","Egypt","Bulgaria","Sierra Leone","Cameroon","Iran","Albania","Bangladesh","Namibia","Kenya","Mozambique","Myanmar","Senegal","Zambia","Iraq","Gabon","Ethiopia","Sri Lanka","Armenia","India","Mauritania","Republic of Congo","Georgia","Democratic Republic of the Congo","Mali","Ivory Coast","Cambodia","Sudan","Ghana","Ukraine","Uganda","Burkina Faso","Niger","Malawi","Chad","Zimbabwe","Lesotho","Angola","Afghanistan","Botswana","Benin","Madagascar","Haiti","Yemen","South Sudan","Liberia","Guinea","Togo","Rwanda","Syria","Tanzania","Burundi","Central African Republic"],"y":[1.6164631843566899,1.48238301277161,1.4806330204010001,1.56497955322266,1.4435719251632699,1.50394463539124,1.47920441627502,1.40570604801178,1.4943872690200799,1.484414935112,1.37538242340088,1.1097062826156601,1.4870972633361801,1.54625928401947,1.53570663928986,1.4879233837127701,1.4637807607650799,1.74194359779358,1.44163393974304,1.25278460979462,1.62634336948395,1.1073532104492201,1.35268235206604,1.1852954626083401,1.1531838178634599,1.69227766990662,1.3432798385620099,1.2175596952438399,0.87200194597244296,1.23374843597412,1.4309234619140601,1.12786877155304,1.43362653255463,1.3843978643417401,1.87076568603516,1.07062232494354,1.53062355518341,1.36135590076447,1.63295245170593,1.3253935575485201,1.4884122610092201,1.29121541976929,0.737299203872681,1.00082039833069,0.909784495830536,1.29178786277771,0.78644108772277799,1.3950666189193699,1.28177809715271,0.90797531604766801,1.41691517829895,1.3145823478698699,1.09186446666718,1.26074862480164,1.40167844295502,0.728870630264282,1.21768391132355,0.83375656604766801,1.13077676296234,1.28455626964569,1.3469113111496001,1.3412059545517001,1.0352252721786499,1.1893955469131501,1.3559380769729601,1.32087934017181,1.1565575599670399,1.1018030643463099,1.19827437400818,0.93253731727600098,1.55167484283447,0.85769921541214,1.0693175792694101,0.99101239442825295,1.2860119342803999,0.92557930946350098,1.22255623340607,0.95148438215255704,1.08116579055786,0.72688353061676003,0.99553859233856201,1.1284312009811399,1.1211290359497099,0.87811458110809304,1.1536017656326301,1.07937383651733,1.2894874811172501,1.0749875307083101,1.3151752948761,0.98240941762924205,0.73057311773300204,1.0645779371261599,0.022643184289336201,0.78854757547378496,0.78375625610351596,0.524713635444641,0.88541638851165805,0.59622007608413696,0.47982019186019897,1.0272358655929601,1.05469870567322,1.0072658061981199,0.71624922752380404,0.989701807498932,1.1614590883255,0.36842092871665999,0.56430536508560203,1.1568731069564799,0.99619275331497203,0.58668297529220603,0.96443432569503795,0.56047946214675903,0.234305649995804,0.36711055040359503,0.479309022426605,0.63640677928924605,1.10271048545837,1.1982102394103999,0.33923384547233598,1.0098501443862899,0.90059673786163297,0.79222124814987205,0.64845728874206499,0.80896425247192405,0.95061266422271695,0.092102348804473905,0.47618049383163502,0.60304892063140902,0.601765096187592,0.65951669216155995,0.66722482442855802,0.89465194940567005,0.38143071532249501,0.35022771358490001,0.16192533075809501,0.233442038297653,0.43801298737525901,0.37584653496742199,0.52102124691009499,0.85842818021774303,0.40147721767425498,1.1220941543579099,0.43108540773391701,0.30580869317054699,0.36861026287078902,0.59168344736099199,0.39724862575531,0.119041793048382,0.244549930095673,0.30544471740722701,0.36874589323997498,0.77715313434600797,0.51113587617874101,0.091622568666934995,0],"type":"bar","name":"2017","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Norway","Denmark","Iceland","Switzerland","Netherlands","Canada","New Zealand","Sweden","Australia","UK","Austria","Costa Rica","Ireland","Germany","Belgium","Luxembourg","USA","Israel","United Arab Emirates","Czech Republic","Malta","France","Mexico","Chile","Taiwan","Panama","Brazil","Argentina","Guatemala","Uruguay","Qatar","Saudi Arabia","Singapore","Malaysia","Spain","Colombia","Trinidad and Tobago","Slovakia","El Salvador","Nicaragua","Poland","Bahrain","Uzbekistan","Kuwait","Thailand","Italy","Ecuador","Belize","Lithuania","Slovenia","Romania","Latvia","Japan","Mauritius","Jamaica","South Korea","North Cyprus","Russia","Kazakhstan","Cyprus","Bolivia","Estonia","Paraguay","Peru","Kosovo","Moldova","Turkmenistan","Hungary","Libya","Philippines","Honduras","Belarus","Turkey","Pakistan","Hong Kong","Portugal","Serbia","Greece","Lebanon","Montenegro","Croatia","Dominican Republic","Algeria","Morocco","China","Azerbaijan","Tajikistan","Macedonia","Jordan","Nigeria","Kyrgyzstan","Bosnia and Herzegovina","Mongolia","Vietnam","Indonesia","Bhutan","Somalia","Cameroon","Bulgaria","Nepal","Venezuela","Gabon","Palestinian Territories","South Africa","Iran","Ivory Coast","Ghana","Senegal","Laos","Tunisia","Albania","Sierra Leone","Republic of Congo","Bangladesh","Sri Lanka","Iraq","Mali","Namibia","Cambodia","Burkina Faso","Egypt","Mozambique","Kenya","Zambia","Mauritania","Ethiopia","Georgia","Armenia","Myanmar","Chad","Democratic Republic of the Congo","India","Niger","Uganda","Benin","Sudan","Ukraine","Togo","Guinea","Lesotho","Angola","Madagascar","Zimbabwe","Afghanistan","Botswana","Malawi","Haiti","Liberia","Syria","Rwanda","Yemen","Tanzania","South Sudan","Central African Republic","Burundi"],"y":[1.3049999999999999,1.456,1.351,1.343,1.4199999999999999,1.361,1.3300000000000001,1.268,1.355,1.3400000000000001,1.244,1.341,1.01,1.448,1.3400000000000001,1.3240000000000001,1.5760000000000001,1.3979999999999999,1.3009999999999999,2.0960000000000001,1.2330000000000001,1.27,1.2929999999999999,1.038,1.131,1.365,1.1120000000000001,0.98599999999999999,1.073,0.78100000000000003,1.093,1.649,1.379,1.5289999999999999,1.161,1.2509999999999999,0.95999999999999996,1.2230000000000001,1.21,0.80600000000000005,0.66800000000000004,1.1759999999999999,1.3380000000000001,0.71899999999999997,1.474,1.016,1.264,0.88900000000000001,0.80700000000000005,1.1970000000000001,1.2190000000000001,1.1160000000000001,1.1479999999999999,1.294,1.0900000000000001,0.81899999999999995,1.266,1.2290000000000001,1.151,1.143,1.2290000000000001,0.751,1.2,0.83499999999999996,0.93400000000000005,0.85499999999999998,0.65700000000000003,1.016,1.171,0.98499999999999999,0.77500000000000002,0.62,1.0389999999999999,1.1479999999999999,0.65200000000000002,1.405,1.1879999999999999,0.97499999999999998,1.1539999999999999,0.96499999999999997,1.0169999999999999,1.115,0.98199999999999998,0.97899999999999998,0.77900000000000003,0.98899999999999999,1.024,0.47399999999999998,0.95899999999999996,0.82199999999999995,0.68899999999999995,0.53000000000000003,0.91500000000000004,0.91400000000000003,0.71499999999999997,0.89900000000000002,0.79600000000000004,0,0.53500000000000003,1.054,0.42499999999999999,0.996,1.036,0.64200000000000002,0.93999999999999995,1.0589999999999999,0.54100000000000004,0.59199999999999997,0.42899999999999999,0.71999999999999997,0.90000000000000002,0.91600000000000004,0.25600000000000001,0.68200000000000005,0.53200000000000003,0.91800000000000004,1.01,0.37,0.874,0.54900000000000004,0.314,0.88500000000000001,0.19800000000000001,0.49299999999999999,0.56200000000000006,0.55700000000000005,0.308,0.85299999999999998,0.81599999999999995,0.68200000000000005,0.35799999999999998,0.069000000000000006,0.72099999999999997,0.13100000000000001,0.32200000000000001,0.378,0.60499999999999998,0.79300000000000004,0.25900000000000001,0.34399999999999997,0.47199999999999998,0.72999999999999998,0.26200000000000001,0.35699999999999998,0.33200000000000002,1.0169999999999999,0.186,0.315,0.075999999999999998,0.68899999999999995,0.33200000000000002,0.442,0.45500000000000002,0.33700000000000002,0.024,0.090999999999999998],"type":"bar","name":"2018","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Denmark","Norway","Iceland","Netherlands","Switzerland","Sweden","New Zealand","Canada","Austria","Australia","Costa Rica","Israel","Luxembourg","UK","Ireland","Germany","Belgium","USA","Czech Republic","United Arab Emirates","Malta","Mexico","France","Taiwan","Chile","Guatemala","Saudi Arabia","Qatar","Spain","Panama","Brazil","Uruguay","Singapore","El Salvador","Italy","Bahrain","Slovakia","Trinidad and Tobago","Poland","Uzbekistan","Lithuania","Colombia","Slovenia","Nicaragua","Kosovo","Argentina","Romania","Cyprus","Ecuador","Kuwait","Thailand","Latvia","South Korea","Estonia","Jamaica","Mauritius","Japan","Honduras","Kazakhstan","Bolivia","Hungary","Paraguay","North Cyprus","Peru","Portugal","Pakistan","Russia","Philippines","Serbia","Moldova","Libya","Montenegro","Tajikistan","Croatia","Hong Kong","Dominican Republic","Bosnia and Herzegovina","Turkey","Malaysia","Belarus","Greece","Mongolia","North Macedonia","Nigeria","Kyrgyzstan","Turkmenistan","Algeria","Morocco","Azerbaijan","Lebanon","Indonesia","China","Vietnam","Bhutan","Cameroon","Bulgaria","Ghana","Ivory Coast","Nepal","Jordan","Benin","Republic of Congo","Gabon","Laos","South Africa","Albania","Venezuela","Cambodia","Palestinian Territories","Senegal","Somalia","Namibia","Niger","Burkina Faso","Armenia","Iran","Guinea","Georgia","Gambia","Kenya","Mauritania","Mozambique","Tunisia","Bangladesh","Iraq","Democratic Republic of the Congo","Mali","Sierra Leone","Sri Lanka","Myanmar","Chad","Ukraine","Ethiopia","Swaziland","Uganda","Egypt","Zambia","Togo","India","Liberia","Comoros","Madagascar","Lesotho","Burundi","Zimbabwe","Haiti","Botswana","Syria","Malawi","Yemen","Rwanda","Tanzania","Afghanistan","Central African Republic","South Sudan"],"y":[1.3400000000000001,1.383,1.488,1.3799999999999999,1.3959999999999999,1.452,1.387,1.3029999999999999,1.365,1.3759999999999999,1.3720000000000001,1.034,1.276,1.609,1.333,1.4990000000000001,1.373,1.3560000000000001,1.4330000000000001,1.2689999999999999,1.5029999999999999,1.3,1.0700000000000001,1.3240000000000001,1.3680000000000001,1.159,0.80000000000000004,1.403,1.6839999999999999,1.286,1.149,1.004,1.1240000000000001,1.5720000000000001,0.79400000000000004,1.294,1.3620000000000001,1.246,1.2310000000000001,1.206,0.745,1.238,0.98499999999999999,1.258,0.69399999999999995,0.88200000000000001,1.0920000000000001,1.1619999999999999,1.2629999999999999,0.91200000000000003,1.5,1.05,1.1870000000000001,1.3009999999999999,1.2370000000000001,0.83099999999999996,1.1200000000000001,1.327,0.64200000000000002,1.173,0.77600000000000002,1.2010000000000001,0.85499999999999998,1.2629999999999999,0.95999999999999996,1.2210000000000001,0.67700000000000005,1.1830000000000001,0.80700000000000005,1.004,0.68500000000000005,1.044,1.0509999999999999,0.49299999999999999,1.155,1.4379999999999999,1.0149999999999999,0.94499999999999995,1.1830000000000001,1.2210000000000001,1.0669999999999999,1.181,0.94799999999999995,0.98299999999999998,0.69599999999999995,0.55100000000000005,1.052,1.002,0.80100000000000005,1.0429999999999999,0.98699999999999999,0.93100000000000005,1.0289999999999999,0.74099999999999999,0.81299999999999994,0.54900000000000004,1.0920000000000001,0.61099999999999999,0.56899999999999995,0.44600000000000001,0.83699999999999997,0.39300000000000002,0.67300000000000004,1.0569999999999999,0.76400000000000001,0.95999999999999996,0.94699999999999995,0.95999999999999996,0.57399999999999995,0.65700000000000003,0.45000000000000001,0,0.879,0.13800000000000001,0.33100000000000002,0.84999999999999998,1.1000000000000001,0.38,0.88600000000000001,0.308,0.51200000000000001,0.56999999999999995,0.20399999999999999,0.92100000000000004,0.56200000000000006,1.0429999999999999,0.094,0.38500000000000001,0.26800000000000002,0.94899999999999995,0.70999999999999996,0.34999999999999998,0.81999999999999995,0.33600000000000002,0.81100000000000005,0.33200000000000002,0.91300000000000003,0.57799999999999996,0.27500000000000002,0.755,0.072999999999999995,0.27400000000000002,0.27400000000000002,0.48899999999999999,0.045999999999999999,0.36599999999999999,0.32300000000000001,1.0409999999999999,0.61899999999999999,0.191,0.28699999999999998,0.35899999999999999,0.47599999999999998,0.34999999999999998,0.025999999999999999,0.30599999999999999],"type":"bar","name":"2019","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>At Region Level</strong></p>
<pre class="r"><code>hap_df |&gt;
  mutate(region = fct_reorder(region, gdp_per_capita))|&gt;
  group_by(region, year)|&gt;
  summarise(
    average_gdp_per_capita = mean(gdp_per_capita, na.rm = TRUE)
  ) |&gt;
  plot_ly (
  x = ~region, y = ~average_gdp_per_capita, color = ~year,
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;GDP Per Capita By Region&quot;,
    xaxis = list(title = &quot;Region&quot;),
    yaxis = list(title = &quot;Average Score&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-442b07b20b898b4768d8" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-442b07b20b898b4768d8">{"x":{"visdat":{"b30a6e650250":["function () ","plotlyVisDat"]},"cur_data":"b30a6e650250","attrs":{"b30a6e650250":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"GDP Per Capita By Region","xaxis":{"domain":[0,1],"automargin":true,"title":"Region","type":"category","categoryorder":"array","categoryarray":["Sub-Saharan Africa","Southern Asia","Southeastern Asia","Latin America and Caribbean","Middle East and Northern Africa","Central and Eastern Europe","Eastern Asia","Australia and New Zealand","Western Europe","North America"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Sub-Saharan Africa","Southern Asia","Southeastern Asia","Latin America and Caribbean","Middle East and Northern Africa","Central and Eastern Europe","Eastern Asia","Australia and New Zealand","Western Europe","North America"],"y":[0.38047300000000001,0.56048571428571425,0.78905444444444439,0.87681545454545451,1.0669735,0.94243827586206896,1.15178,1.2918799999999999,1.2985957142857143,1.3603999999999998],"type":"bar","name":"2015","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Sub-Saharan Africa","Southern Asia","Southeastern Asia","Latin America and Caribbean","Middle East and Northern Africa","Central and Eastern Europe","Eastern Asia","Australia and New Zealand","Western Europe","North America"],"y":[0.47432131578947367,0.66067142857142858,0.89638111111111107,0.99341000000000002,1.1393231578947369,1.0475368965517242,1.2773116666666666,1.4025449999999999,1.4170557142857143,1.4740549999999999],"type":"bar","name":"2016","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Sub-Saharan Africa","Southern Asia","Southeastern Asia","Latin America and Caribbean","Middle East and Northern Africa","Central and Eastern Europe","Eastern Asia","Australia and New Zealand","Western Europe","North America"],"y":[0.50174888562506603,0.69747881378446286,0.96525286138057798,1.0069808174263351,1.168535430180399,1.0920510189286596,1.3187161087989816,1.4450604915618901,1.4574108634676262,1.5127318501472451],"type":"bar","name":"2017","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Sub-Saharan Africa","Southern Asia","Southeastern Asia","Latin America and Caribbean","Middle East and Northern Africa","Central and Eastern Europe","Eastern Asia","Australia and New Zealand","Western Europe","North America"],"y":[0.44284615384615383,0.62514285714285711,0.89400000000000002,0.9013181818181818,1.0811578947368421,0.9893448275862069,1.2055,1.304,1.321047619047619,1.3639999999999999],"type":"bar","name":"2018","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Sub-Saharan Africa","Southern Asia","Southeastern Asia","Latin America and Caribbean","Middle East and Northern Africa","Central and Eastern Europe","Eastern Asia","Australia and New Zealand","Western Europe","North America"],"y":[0.44374999999999998,0.65028571428571424,0.93000000000000005,0.92428571428571427,1.0590526315789475,1.0210689655172414,1.2351666666666667,1.3374999999999999,1.3573333333333333,1.399],"type":"bar","name":"2019","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>Regional Trend</strong></p>
<pre class="r"><code>regional_hap_df |&gt;
  filter(factor == &quot;gdp_per_capita&quot;)|&gt;
  plot_ly(
      x = ~year, y = ~average_score, color = ~region,
      mode = &#39;lines+markers&#39;, type = &#39;scatter&#39;, colors = &#39;viridis&#39;,
      name = ~region) |&gt;
    layout(
      title = paste(&quot;Regional Trend for GDP Per Captia from 2015 to 2019&quot;),
      xaxis = list(title = &quot;Year&quot;),
      yaxis = list(title = &quot;Average Score&quot;),
      autosize = F, width = 820, height = 500
    )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0e82775a5a62fcbbdf3f" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-0e82775a5a62fcbbdf3f">{"x":{"visdat":{"b30a4d02b14f":["function () ","plotlyVisDat"]},"cur_data":"b30a4d02b14f","attrs":{"b30a4d02b14f":{"x":{},"y":{},"mode":"lines+markers","name":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"width":820,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Regional Trend for GDP Per Captia from 2015 to 2019","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2015","2016","2017","2018","2019"],"y":[1.2918799999999999,1.4025449999999999,1.4450604915618901,1.304,1.3374999999999999],"mode":"lines+markers","name":"Australia and New Zealand","type":"scatter","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.94243827586206896,1.0475368965517242,1.0920510189286596,0.9893448275862069,1.0210689655172414],"mode":"lines+markers","name":"Central and Eastern Europe","type":"scatter","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"line":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[1.15178,1.2773116666666666,1.3187161087989816,1.2055,1.2351666666666667],"mode":"lines+markers","name":"Eastern Asia","type":"scatter","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"line":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.87681545454545451,0.99341000000000002,1.0069808174263351,0.9013181818181818,0.92428571428571427],"mode":"lines+markers","name":"Latin America and Caribbean","type":"scatter","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"line":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[1.0669735,1.1393231578947369,1.168535430180399,1.0811578947368421,1.0590526315789475],"mode":"lines+markers","name":"Middle East and Northern Africa","type":"scatter","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"line":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[1.3603999999999998,1.4740549999999999,1.5127318501472451,1.3639999999999999,1.399],"mode":"lines+markers","name":"North America","type":"scatter","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"line":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.78905444444444439,0.89638111111111107,0.96525286138057798,0.89400000000000002,0.93000000000000005],"mode":"lines+markers","name":"Southeastern Asia","type":"scatter","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"line":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.56048571428571425,0.66067142857142858,0.69747881378446286,0.62514285714285711,0.65028571428571424],"mode":"lines+markers","name":"Southern Asia","type":"scatter","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"line":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.38047300000000001,0.47432131578947367,0.50174888562506603,0.44284615384615383,0.44374999999999998],"mode":"lines+markers","name":"Sub-Saharan Africa","type":"scatter","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"line":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[1.2985957142857143,1.4170557142857143,1.4574108634676262,1.321047619047619,1.3573333333333333],"mode":"lines+markers","name":"Western Europe","type":"scatter","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>At <em>countries level</em>, from 2015 to 2019, Qatar has the highest
GDP Per Capita and Somalia and Central Africa has the lowest. Qatar,
Luxembourger, UAE, Singapore, Kuwait are the top 5 countries with the
highest GDP Per Capita. Somalia, Central Africa Republic, Burundi,
Democratic Republic of the Congo, Liberia are the bottom 5 countries
with the lowest GDP Per Capita.</p>
<p>At <em>regional level</em>, from 2015 to 2019, North America has the
highest GDP and Sub-Saharan Africa has the lowest. The trend between 10
regions is relatively similar, with peak at 2017 and decreased from 2017
to 2018.</p>
</div>
<div id="social-support" class="section level3">
<h3>Social Support</h3>
<p><strong>At Country Level</strong></p>
<pre class="r"><code>hap_df |&gt;
  mutate(country = fct_reorder(country, social_support))|&gt;
  plot_ly (
  x = ~country, y = ~social_support, color = ~year,
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;Social Support/Having Someone to Count On In Time of Trouble&quot;,
    xaxis = list(
      title = &quot;country&quot;,
      tickfont = list(size = 6)
      ),
    yaxis = list(title = &quot;Score&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3892bed5c58be0070781" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-3892bed5c58be0070781">{"x":{"visdat":{"b30a4de00b7f":["function () ","plotlyVisDat"]},"cur_data":"b30a4de00b7f","attrs":{"b30a4de00b7f":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Social Support/Having Someone to Count On In Time of Trouble","xaxis":{"domain":[0,1],"automargin":true,"title":"country","tickfont":{"size":6},"type":"category","categoryorder":"array","categoryarray":["Central African Republic","Benin","Syria","Togo","Burundi","Malawi","Afghanistan","Georgia","South Sudan","Djibouti","Pakistan","Haiti","Iran","Somalia","Bangladesh","India","Comoros","Somaliland Region","Chad","Rwanda","Niger","Morocco","Guinea","Republic of Congo","Albania","Ivory Coast","Sierra Leone","Liberia","Ethiopia","Ghana","Tunisia","Suriname","Laos","Cameroon","Madagascar","Yemen","Gambia","Mozambique","Croatia","Iraq","Angola","Armenia","Tanzania","Egypt","Kenya","Zambia","Cambodia","Burkina Faso","Bosnia and Herzegovina","Puerto Rico","Belize","Oman","Zimbabwe","Uganda","Tajikistan","Mali","Macedonia","Swaziland","Nigeria","Sudan","Senegal","Myanmar","China","Democratic Republic of the Congo","United Arab Emirates","South Korea","Lebanon","Cyprus","Kosovo","Honduras","Botswana","Algeria","Azerbaijan","Romania","Gabon","Palestinian Territories","Greece","Mauritania","Malaysia","Nepal","Lesotho","El Salvador","North Cyprus","Namibia","Indonesia","Bolivia","Mauritius","Mexico","Peru","Jordan","Montenegro","Moldova","Philippines","Guatemala","Serbia","Kuwait","Sri Lanka","Hong Kong","Qatar","Vietnam","Chile","Ecuador","Saudi Arabia","Nicaragua","North Macedonia","Libya","Bhutan","Bahrain","Turkey","Hungary","South Africa","Singapore","Portugal","Jamaica","Panama","Israel","Trinidad and Tobago","Kazakhstan","Taiwan","France","Ukraine","Kyrgyzstan","Dominican Republic","Colombia","Latvia","Thailand","Uruguay","Costa Rica","Japan","USA","Venezuela","Netherlands","Brazil","Argentina","UK","Czech Republic","Bulgaria","Poland","Italy","Belarus","Russia","Slovenia","Germany","Luxembourg","Austria","Belgium","Lithuania","Paraguay","Estonia","Sweden","Canada","Spain","Malta","Mongolia","Turkmenistan","Slovakia","Australia","Switzerland","Uzbekistan","Norway","Finland","New Zealand","Denmark","Ireland","Iceland"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Switzerland","Iceland","Denmark","Norway","Canada","Finland","Netherlands","Sweden","New Zealand","Australia","Israel","Costa Rica","Austria","Mexico","USA","Brazil","Luxembourg","Ireland","Belgium","United Arab Emirates","UK","Oman","Venezuela","Singapore","Panama","Germany","Chile","Qatar","France","Argentina","Czech Republic","Uruguay","Colombia","Thailand","Saudi Arabia","Spain","Malta","Taiwan","Kuwait","Suriname","Trinidad and Tobago","El Salvador","Guatemala","Uzbekistan","Slovakia","Japan","South Korea","Ecuador","Bahrain","Italy","Bolivia","Moldova","Paraguay","Kazakhstan","Slovenia","Lithuania","Nicaragua","Peru","Belarus","Poland","Malaysia","Croatia","Libya","Russia","Jamaica","North Cyprus","Cyprus","Algeria","Kosovo","Turkmenistan","Mauritius","Hong Kong","Estonia","Indonesia","Vietnam","Turkey","Kyrgyzstan","Nigeria","Bhutan","Azerbaijan","Pakistan","Jordan","Montenegro","China","Zambia","Romania","Serbia","Portugal","Latvia","Philippines","Somalia","Morocco","Macedonia","Mozambique","Albania","Bosnia and Herzegovina","Lesotho","Dominican Republic","Laos","Mongolia","Swaziland","Greece","Lebanon","Hungary","Honduras","Tajikistan","Tunisia","Palestinian Territories","Bangladesh","Iran","Ukraine","Iraq","South Africa","Ghana","Zimbabwe","Liberia","India","Sudan","Haiti","Democratic Republic of the Congo","Nepal","Ethiopia","Sierra Leone","Mauritania","Kenya","Djibouti","Armenia","Botswana","Myanmar","Georgia","Malawi","Sri Lanka","Cameroon","Bulgaria","Egypt","Yemen","Angola","Mali","Republic of Congo","Comoros","Uganda","Senegal","Gabon","Niger","Cambodia","Tanzania","Madagascar","Central African Republic","Chad","Guinea","Ivory Coast","Burkina Faso","Afghanistan","Rwanda","Benin","Syria","Burundi","Togo"],"y":[1.34951,1.4022300000000001,1.3605799999999999,1.3309500000000001,1.3226100000000001,1.31826,1.28017,1.2890699999999999,1.3196699999999999,1.3092299999999999,1.22393,1.2378800000000001,1.29704,0.91451000000000005,1.2471099999999999,1.2328699999999999,1.21963,1.36948,1.28566,1.12575,1.28548,1.08182,1.25596,1.02,1.1984999999999999,1.2993699999999999,1.1244700000000001,1.0786,1.2603800000000001,1.24823,1.2064299999999999,1.2089000000000001,1.2401800000000001,1.2650399999999999,1.0839300000000001,1.31379,1.30203,1.0761700000000001,1.16594,0.97199999999999998,1.18354,1.0250699999999999,1.04356,1.34043,1.26999,1.25712,0.95774000000000004,0.99902999999999997,1.21624,1.19777,0.97841,1.01528,1.30477,1.1224099999999999,1.2738499999999999,1.25745,1.14184,0.97458999999999996,1.23289,1.27948,1.07023,0.79623999999999995,1.1186199999999999,1.23617,1.1510199999999999,1.0700799999999999,0.89317999999999997,1.07772,0.81198000000000004,1.22668,0.98521000000000003,1.0581799999999999,1.2279100000000001,1.08708,0.91225999999999996,0.94632000000000005,1.1511499999999999,0.90432000000000001,1.10395,0.93793000000000004,0.41410999999999998,1.05392,0.90556999999999999,0.94674999999999998,0.91612000000000005,0.88588,1.0096400000000001,1.1393500000000001,1.09562,1.0351600000000001,0.95152000000000003,0.64095000000000002,1.0023200000000001,1.02626,0.80434000000000005,0.91915999999999998,1.0410299999999999,1.1720200000000001,0.73802999999999996,1.3006,1.07284,0.92932999999999999,0.80001,1.2021500000000001,0.95347999999999999,0.85563,0.60428999999999999,0.92557999999999996,0.43106,0.54447000000000001,1.20278,0.81889000000000001,1.18468,0.67954000000000003,1.0327599999999999,0.78968000000000005,0.38174000000000002,1.0140400000000001,0.74302000000000001,1.0012000000000001,0.86448999999999998,0.60406000000000004,0.95570999999999995,0.86907999999999996,0.99875999999999998,0.59206999999999999,0.77710999999999997,1.1046400000000001,0.70904999999999996,0.38562000000000002,0.41133999999999998,1.01905,0.88766999999999996,1.1061399999999999,0.747,0.68093000000000004,0.86040000000000005,1.0352600000000001,0.66290000000000004,0.79273000000000005,1.1329899999999999,0.97619,0.90527999999999997,0.77264999999999995,0.62736000000000003,1.00268,0.66800999999999999,0,0.76061999999999996,0.46475,0.77115,0.85187999999999997,0.30285000000000001,0.77370000000000005,0.35386000000000001,0.47488999999999998,0.41587000000000002,0.13994999999999999],"type":"bar","name":"2015","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Denmark","Switzerland","Iceland","Norway","Finland","Canada","Netherlands","New Zealand","Australia","Sweden","Israel","Austria","USA","Costa Rica","Puerto Rico","Germany","Brazil","Belgium","Ireland","Luxembourg","Mexico","Singapore","UK","Chile","Panama","Argentina","Czech Republic","United Arab Emirates","Uruguay","Malta","Colombia","France","Thailand","Saudi Arabia","Taiwan","Qatar","Spain","Algeria","Guatemala","Suriname","Kuwait","Bahrain","Trinidad and Tobago","Venezuela","Slovakia","El Salvador","Malaysia","Nicaragua","Uzbekistan","Italy","Ecuador","Belize","Japan","Kazakhstan","Moldova","Russia","Poland","South Korea","Bolivia","Lithuania","Belarus","North Cyprus","Slovenia","Peru","Turkmenistan","Mauritius","Libya","Latvia","Cyprus","Paraguay","Romania","Estonia","Jamaica","Croatia","Hong Kong","Somalia","Kosovo","Turkey","Indonesia","Jordan","Azerbaijan","Philippines","China","Bhutan","Kyrgyzstan","Serbia","Bosnia and Herzegovina","Montenegro","Dominican Republic","Morocco","Hungary","Pakistan","Lebanon","Portugal","Macedonia","Vietnam","Somaliland Region","Tunisia","Greece","Tajikistan","Mongolia","Laos","Nigeria","Honduras","Iran","Zambia","Nepal","Palestinian Territories","Albania","Bangladesh","Sierra Leone","Iraq","Namibia","Cameroon","Ethiopia","South Africa","Sri Lanka","India","Myanmar","Egypt","Armenia","Kenya","Ukraine","Ghana","Democratic Republic of the Congo","Georgia","Republic of Congo","Senegal","Bulgaria","Mauritania","Zimbabwe","Malawi","Sudan","Gabon","Mali","Haiti","Botswana","Comoros","Ivory Coast","Cambodia","Angola","Niger","South Sudan","Chad","Burkina Faso","Uganda","Yemen","Madagascar","Tanzania","Liberia","Guinea","Rwanda","Benin","Afghanistan","Togo","Syria","Burundi"],"y":[1.16374,1.14524,1.18326,1.1269,1.1346400000000001,1.0961000000000001,1.02912,1.1727799999999999,1.10476,1.0876399999999999,0.99536999999999998,1.0838300000000001,1.04782,1.02152,1.0811299999999999,1.0977399999999999,1.03938,1.0524899999999999,1.16157,1.03999,0.71460000000000001,0.86758000000000002,1.0867199999999999,0.90586999999999995,0.98912,1.06612,1.00793,0.87114000000000003,1.0314300000000001,1.0987899999999999,1.02169,1.00508,1.04477,0.84828999999999999,0.92623999999999995,0.87963999999999998,1.1294500000000001,0.83309,0.87119000000000002,0.77866000000000002,0.87758000000000003,0.94396999999999998,0.98568999999999996,1.03302,1.0826800000000001,0.80974999999999997,0.88024999999999998,0.89520999999999995,1.1680999999999999,1.0416700000000001,0.85973999999999995,0.68654999999999999,1.06054,0.95543999999999996,0.83131999999999995,1.05261,1.0468500000000001,0.72194000000000003,0.83779000000000003,1.0641099999999999,1.04993,0.81825999999999999,1.05613,0.81254999999999999,1.03817,0.75695000000000001,0.95076000000000005,0.95025000000000004,0.70696999999999999,1.11111,0.72802999999999995,1.0516300000000001,0.96372000000000002,0.60809000000000002,0.87021000000000004,0.33612999999999998,0.66061999999999999,0.87717000000000001,0.87624999999999997,0.86216000000000004,0.76041999999999998,0.87877000000000005,0.79381000000000002,0.90835999999999995,0.95433999999999997,0.81328999999999996,0.64366999999999996,0.74173,0.99495999999999996,0.38595000000000002,0.93164000000000002,0.26135000000000003,0.64183999999999997,0.94367000000000001,0.78236000000000006,0.79117000000000004,0.75861999999999996,0.43164999999999998,0.75473000000000001,0.75602000000000003,1.0898300000000001,0.54969999999999997,0.64498,0.75595999999999997,0.38857000000000003,0.63759999999999994,0.69699,0.71628999999999998,0.50163000000000002,0.24748999999999999,0.628,0.59204999999999997,0.70362000000000002,0.62541999999999998,0.37931999999999999,0.96052999999999999,0.84782999999999997,0.29247000000000001,0.69981000000000004,0.49813000000000002,0.62477000000000005,0.76239999999999997,1.01413,0.49353000000000002,0.80676000000000003,0.19248999999999999,0.47799000000000003,0.77415999999999996,0.92542000000000002,0.84141999999999995,0.71477999999999997,0.14699999999999999,0.81928000000000001,0.72367999999999999,0.86333000000000004,0.29560999999999998,0.89185999999999999,0.60323000000000004,0.57576000000000005,0.53749999999999998,0.66366000000000003,0.60529999999999995,0.18518999999999999,0.63178000000000001,0.63053999999999999,0.90981000000000001,0.47493000000000002,0.46115,0.77622999999999998,0.50353000000000003,0.31090000000000001,0.61585999999999996,0.10419,0.11037,0,0.14865999999999999,0.23441999999999999],"type":"bar","name":"2016","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Norway","Denmark","Iceland","Switzerland","Finland","Netherlands","Canada","New Zealand","Sweden","Australia","Israel","Costa Rica","Austria","USA","Ireland","Germany","Belgium","Luxembourg","UK","Chile","United Arab Emirates","Brazil","Czech Republic","Argentina","Mexico","Singapore","Malta","Uruguay","Guatemala","Panama","France","Thailand","Taiwan","Spain","Qatar","Colombia","Saudi Arabia","Trinidad and Tobago","Kuwait","Slovakia","Bahrain","Malaysia","Nicaragua","Ecuador","El Salvador","Poland","Uzbekistan","Italy","Russia","Belize","Japan","Lithuania","Algeria","Latvia","South Korea","Moldova","Romania","Bolivia","Turkmenistan","Kazakhstan","North Cyprus","Slovenia","Peru","Mauritius","Cyprus","Estonia","Belarus","Libya","Turkey","Paraguay","Hong Kong","Philippines","Serbia","Jordan","Hungary","Jamaica","Croatia","Kosovo","China","Pakistan","Indonesia","Venezuela","Montenegro","Morocco","Azerbaijan","Dominican Republic","Greece","Lebanon","Portugal","Bosnia and Herzegovina","Honduras","Macedonia","Somalia","Vietnam","Nigeria","Tajikistan","Bhutan","Kyrgyzstan","Nepal","Mongolia","South Africa","Tunisia","Palestinian Territories","Egypt","Bulgaria","Sierra Leone","Cameroon","Iran","Albania","Bangladesh","Namibia","Kenya","Mozambique","Myanmar","Senegal","Zambia","Iraq","Gabon","Ethiopia","Sri Lanka","Armenia","India","Mauritania","Republic of Congo","Georgia","Democratic Republic of the Congo","Mali","Ivory Coast","Cambodia","Sudan","Ghana","Ukraine","Uganda","Burkina Faso","Niger","Malawi","Chad","Zimbabwe","Lesotho","Angola","Afghanistan","Botswana","Benin","Madagascar","Haiti","Yemen","South Sudan","Liberia","Guinea","Togo","Rwanda","Syria","Tanzania","Burundi","Central African Republic"],"y":[1.5335235595703101,1.5511215925216699,1.6105740070343,1.51691174507141,1.5402467250823999,1.42893922328949,1.4813489913940401,1.54819512367249,1.4781621694564799,1.51004195213318,1.3762899637222299,1.41640365123749,1.4599449634552,1.4199205636978101,1.5582311153411901,1.4725203514099101,1.46231269836426,1.4575836658477801,1.49646008014679,1.28402495384216,1.2664102315902701,1.4313060045242301,1.4338852167129501,1.44045114517212,1.2108621597289999,1.35381436347961,1.4884116649627701,1.4122278690338099,1.2555851936340301,1.3731925487518299,1.3877768516540501,1.42579245567322,1.38456535339355,1.5320909023284901,1.27429687976837,1.4021829366684,1.28667759895325,1.3802285194396999,1.25969874858856,1.50505924224854,1.3231104612350499,1.28464603424072,1.28721570968628,1.2861688137054399,1.1821250915527299,1.44571197032928,1.5489691495895399,1.44492328166962,1.46928238868713,1.0814177989959699,1.4363378286361701,1.47351610660553,1.1462174654007,1.4047149419784499,1.12827444076538,1.25182557106018,1.15009129047394,1.2276190519332899,1.4931491613388099,1.3843690156936601,1.1863033771514899,1.4525188207626301,1.2187703847885101,1.20956099033356,1.13136327266693,1.4766710996627801,1.44494521617889,1.3575643301010101,1.3377531766891499,1.50728487968445,1.2627909183502199,1.25391757488251,1.25818979740143,1.2390888929367101,1.34313309192657,1.3682180643081701,0.96798300743103005,1.1378535032272299,1.1608374118804901,0.672690689563751,1.2744446992874101,1.4313375949859599,1.23837649822235,0.77486443519592296,1.15240025520325,1.40241670608521,1.2394145727157599,1.1296242475509599,1.36704301834106,1.0693359375,1.1439449787139899,1.2078930139541599,0.72115135192871105,1.2774913311004601,1.21577048301697,1.27146327495575,1.34012651443481,1.3942385911941499,1.17928326129913,1.4930112361907999,1.38478863239288,0.86835145950317405,1.1556471586227399,0.99747139215469405,1.4343794584274301,0.98413604497909501,0.94601821899414096,0.71155124902725198,0.80368524789810203,0.73513174057006803,1.0984708070755,1.0679507255554199,0.87070101499557495,1.12323594093323,1.17969191074371,1.0031872987747199,0.97861319780349698,1.1556202173232999,0.86466920375823997,1.25997638702393,1.0074837207794201,0.75437259674072299,1.2720308303832999,0.83204436302185103,0.57061493396759,1.2290234565734901,1.2814733982086199,0.90478003025054898,1.0062383413314799,1.2140085697174099,0.87366473674774203,1.39453756809235,1.12982773780823,1.04328000545502,0.99302500486373901,0.51256883144378695,0.95385587215423595,1.08309590816498,1.1900951862335201,1.1044119596481301,0.58154332637786899,1.2215549945831301,0.435299843549728,0.91302037239074696,0.64044982194900502,0.93538224697113004,0.60132312774658203,0.87211793661117598,0.79124468564987205,0.43188253045082098,0.94570702314376798,0.39610260725021401,1.0419898033142101,0.62979358434677102,0],"type":"bar","name":"2017","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Norway","Denmark","Iceland","Switzerland","Netherlands","Canada","New Zealand","Sweden","Australia","UK","Austria","Costa Rica","Ireland","Germany","Belgium","Luxembourg","USA","Israel","United Arab Emirates","Czech Republic","Malta","France","Mexico","Chile","Taiwan","Panama","Brazil","Argentina","Guatemala","Uruguay","Qatar","Saudi Arabia","Singapore","Malaysia","Spain","Colombia","Trinidad and Tobago","Slovakia","El Salvador","Nicaragua","Poland","Bahrain","Uzbekistan","Kuwait","Thailand","Italy","Ecuador","Belize","Lithuania","Slovenia","Romania","Latvia","Japan","Mauritius","Jamaica","South Korea","North Cyprus","Russia","Kazakhstan","Cyprus","Bolivia","Estonia","Paraguay","Peru","Kosovo","Moldova","Turkmenistan","Hungary","Libya","Philippines","Honduras","Belarus","Turkey","Pakistan","Hong Kong","Portugal","Serbia","Greece","Lebanon","Montenegro","Croatia","Dominican Republic","Algeria","Morocco","China","Azerbaijan","Tajikistan","Macedonia","Jordan","Nigeria","Kyrgyzstan","Bosnia and Herzegovina","Mongolia","Vietnam","Indonesia","Bhutan","Somalia","Cameroon","Bulgaria","Nepal","Venezuela","Gabon","Palestinian Territories","South Africa","Iran","Ivory Coast","Ghana","Senegal","Laos","Tunisia","Albania","Sierra Leone","Republic of Congo","Bangladesh","Sri Lanka","Iraq","Mali","Namibia","Cambodia","Burkina Faso","Egypt","Mozambique","Kenya","Zambia","Mauritania","Ethiopia","Georgia","Armenia","Myanmar","Chad","Democratic Republic of the Congo","India","Niger","Uganda","Benin","Sudan","Ukraine","Togo","Guinea","Lesotho","Angola","Madagascar","Zimbabwe","Afghanistan","Botswana","Malawi","Haiti","Liberia","Syria","Rwanda","Yemen","Tanzania","South Sudan","Central African Republic","Burundi"],"y":[1.5920000000000001,1.5820000000000001,1.5900000000000001,1.6439999999999999,1.5489999999999999,1.488,1.532,1.601,1.5009999999999999,1.573,1.4330000000000001,1.504,1.4590000000000001,1.583,1.474,1.4830000000000001,1.52,1.4710000000000001,1.5589999999999999,0.77600000000000002,1.4890000000000001,1.5249999999999999,1.466,1.252,1.331,1.4359999999999999,1.4379999999999999,1.474,1.468,1.268,1.4590000000000001,1.3029999999999999,1.331,1.4510000000000001,1.258,1.538,1.4390000000000001,1.492,1.5369999999999999,1.2310000000000001,1.319,1.448,1.3660000000000001,1.5840000000000001,1.3009999999999999,1.417,1.5009999999999999,1.3300000000000001,1.101,1.5269999999999999,1.506,1.2190000000000001,1.454,1.462,1.387,1.4930000000000001,1.204,1.2110000000000001,1.4790000000000001,1.516,1.1910000000000001,1.2230000000000001,1.532,1.522,1.2490000000000001,1.23,1.3009999999999999,1.5329999999999999,1.401,1.3500000000000001,1.3120000000000001,1.2050000000000001,1.498,1.3799999999999999,0.81000000000000005,1.29,1.429,1.369,1.202,1.179,1.2789999999999999,1.161,1.4410000000000001,1.1539999999999999,0.79700000000000004,1.1419999999999999,1.161,1.1659999999999999,1.2390000000000001,1.2649999999999999,1.1719999999999999,1.4159999999999999,1.0780000000000001,1.5169999999999999,1.365,1.2150000000000001,1.335,0.71199999999999997,0.89100000000000001,1.5149999999999999,1.228,1.4690000000000001,1.1639999999999999,1.2170000000000001,1.4099999999999999,0.77100000000000002,0.872,0.89600000000000002,1.117,1.034,0.90600000000000003,0.81699999999999995,0.81299999999999994,0.81100000000000005,0.84999999999999998,1.3140000000000001,0.97099999999999997,1.2330000000000001,1.2809999999999999,1.0880000000000001,1.097,1.0249999999999999,0.90200000000000002,1.048,1.0469999999999999,1.2450000000000001,0.94999999999999996,0.59199999999999997,0.98999999999999999,1.1739999999999999,0.90700000000000003,1.1359999999999999,0.747,0.86699999999999999,1.0900000000000001,0.372,1.24,1.413,0.47399999999999998,0.79200000000000004,1.2150000000000001,1.125,0.90800000000000003,1.0940000000000001,0.53700000000000003,1.1739999999999999,0.54100000000000004,0.71399999999999997,0.85799999999999998,0.38200000000000001,0.89600000000000002,1.073,0.99099999999999999,0.60799999999999998,0,0.627],"type":"bar","name":"2018","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Denmark","Norway","Iceland","Netherlands","Switzerland","Sweden","New Zealand","Canada","Austria","Australia","Costa Rica","Israel","Luxembourg","UK","Ireland","Germany","Belgium","USA","Czech Republic","United Arab Emirates","Malta","Mexico","France","Taiwan","Chile","Guatemala","Saudi Arabia","Qatar","Spain","Panama","Brazil","Uruguay","Singapore","El Salvador","Italy","Bahrain","Slovakia","Trinidad and Tobago","Poland","Uzbekistan","Lithuania","Colombia","Slovenia","Nicaragua","Kosovo","Argentina","Romania","Cyprus","Ecuador","Kuwait","Thailand","Latvia","South Korea","Estonia","Jamaica","Mauritius","Japan","Honduras","Kazakhstan","Bolivia","Hungary","Paraguay","North Cyprus","Peru","Portugal","Pakistan","Russia","Philippines","Serbia","Moldova","Libya","Montenegro","Tajikistan","Croatia","Hong Kong","Dominican Republic","Bosnia and Herzegovina","Turkey","Malaysia","Belarus","Greece","Mongolia","North Macedonia","Nigeria","Kyrgyzstan","Turkmenistan","Algeria","Morocco","Azerbaijan","Lebanon","Indonesia","China","Vietnam","Bhutan","Cameroon","Bulgaria","Ghana","Ivory Coast","Nepal","Jordan","Benin","Republic of Congo","Gabon","Laos","South Africa","Albania","Venezuela","Cambodia","Palestinian Territories","Senegal","Somalia","Namibia","Niger","Burkina Faso","Armenia","Iran","Guinea","Georgia","Gambia","Kenya","Mauritania","Mozambique","Tunisia","Bangladesh","Iraq","Democratic Republic of the Congo","Mali","Sierra Leone","Sri Lanka","Myanmar","Chad","Ukraine","Ethiopia","Swaziland","Uganda","Egypt","Zambia","Togo","India","Liberia","Comoros","Madagascar","Lesotho","Burundi","Zimbabwe","Haiti","Botswana","Syria","Malawi","Yemen","Rwanda","Tanzania","Afghanistan","Central African Republic","South Sudan"],"y":[1.587,1.573,1.5820000000000001,1.6240000000000001,1.522,1.526,1.4870000000000001,1.5569999999999999,1.5049999999999999,1.4750000000000001,1.548,1.4410000000000001,1.4550000000000001,1.4790000000000001,1.538,1.5529999999999999,1.454,1.504,1.4570000000000001,1.4870000000000001,1.3100000000000001,1.52,1.323,1.472,1.4299999999999999,1.369,1.2689999999999999,1.357,1.3129999999999999,1.484,1.4419999999999999,1.4390000000000001,1.4650000000000001,1.4630000000000001,1.242,1.488,1.3680000000000001,1.504,1.4770000000000001,1.4379999999999999,1.5289999999999999,1.5149999999999999,1.4099999999999999,1.5229999999999999,1.325,1.232,1.4319999999999999,1.232,1.2230000000000001,1.3120000000000001,1.319,1.409,1.4650000000000001,1.2190000000000001,1.528,1.478,1.4019999999999999,1.419,1.236,1.508,1.2090000000000001,1.4099999999999999,1.4750000000000001,1.252,1.274,1.431,0.88600000000000001,1.452,1.2929999999999999,1.383,1.3280000000000001,1.3029999999999999,1.361,1.0980000000000001,1.266,1.2769999999999999,1.401,1.212,1.3600000000000001,1.171,1.4650000000000001,1.1559999999999999,1.5309999999999999,1.294,1.111,1.4379999999999999,1.538,1.1599999999999999,0.78200000000000003,1.147,1.224,1.2030000000000001,1.125,1.3460000000000001,1.321,0.91000000000000003,1.5129999999999999,0.86799999999999999,0.80800000000000005,1.226,1.2250000000000001,0.437,0.79900000000000004,1.1830000000000001,1.03,1.351,0.84799999999999998,1.427,1.1220000000000001,1.2470000000000001,1.1339999999999999,0.69799999999999995,1.3129999999999999,0.77400000000000002,1.056,1.0549999999999999,0.84199999999999997,0.82899999999999996,0.66600000000000004,0.93899999999999995,0.98299999999999998,1.167,0.98599999999999999,1,0.92800000000000005,0.97999999999999998,1.125,1.105,0.84099999999999997,1.2649999999999999,1.181,0.76600000000000001,1.3899999999999999,1.0329999999999999,1.149,1.069,1.0389999999999999,1.0580000000000001,0.57199999999999995,0.76500000000000001,0.92200000000000004,0.75700000000000001,0.91600000000000004,1.169,0.44700000000000001,1.1140000000000001,0.68799999999999994,1.145,0.378,0.56000000000000005,1.163,0.71099999999999997,0.88500000000000001,0.51700000000000002,0,0.57499999999999996],"type":"bar","name":"2019","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>At Region Level</strong></p>
<pre class="r"><code>hap_df |&gt;
  mutate(region = fct_reorder(region, social_support))|&gt;
  group_by(region, year)|&gt;
  summarise(
    average_social_support = mean(social_support, na.rm = TRUE)
  ) |&gt;
  plot_ly (
  x = ~region, y = ~average_social_support, color = ~year,
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;Social Support By Region&quot;,
    xaxis = list(title = &quot;Region&quot;),
    yaxis = list(title = &quot;Average Score&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-fafae848c04d216522cd" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-fafae848c04d216522cd">{"x":{"visdat":{"b30a28edf06e":["function () ","plotlyVisDat"]},"cur_data":"b30a28edf06e","attrs":{"b30a28edf06e":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Social Support By Region","xaxis":{"domain":[0,1],"automargin":true,"title":"Region","type":"category","categoryorder":"array","categoryarray":["Southern Asia","Sub-Saharan Africa","Middle East and Northern Africa","Southeastern Asia","Eastern Asia","Central and Eastern Europe","Latin America and Caribbean","Western Europe","North America","Australia and New Zealand"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Southern Asia","Sub-Saharan Africa","Middle East and Northern Africa","Southeastern Asia","Eastern Asia","Central and Eastern Europe","Latin America and Caribbean","Western Europe","North America","Australia and New Zealand"],"y":[0.6453214285714286,0.80908500000000005,0.92049000000000003,0.94046777777777779,1.0994266666666666,1.0530424137931034,1.1047204545454545,1.2473019047619047,1.2848600000000001,1.3144499999999999],"type":"bar","name":"2015","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Southern Asia","Sub-Saharan Africa","Middle East and Northern Africa","Southeastern Asia","Eastern Asia","Central and Eastern Europe","Latin America and Caribbean","Western Europe","North America","Australia and New Zealand"],"y":[0.48069428571428569,0.59365552631578944,0.69564421052631575,0.79175555555555555,0.91042833333333339,0.86185517241379306,0.89843208333333335,1.0424523809523809,1.07196,1.1387700000000001],"type":"bar","name":"2016","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Southern Asia","Sub-Saharan Africa","Middle East and Northern Africa","Southeastern Asia","Eastern Asia","Central and Eastern Europe","Latin America and Caribbean","Western Europe","North America","Australia and New Zealand"],"y":[0.93187493085861162,0.95391888954700588,1.0955113548981519,1.2499475926160799,1.3109695315361016,1.2822854169483835,1.290156085382808,1.4449456589562553,1.450634777545925,1.5291185379028351],"type":"bar","name":"2017","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Southern Asia","Sub-Saharan Africa","Middle East and Northern Africa","Southeastern Asia","Eastern Asia","Central and Eastern Europe","Latin America and Caribbean","Western Europe","North America","Australia and New Zealand"],"y":[0.97442857142857142,0.94776923076923081,1.1108421052631579,1.2571111111111111,1.3418333333333332,1.3258620689655172,1.3353181818181818,1.4764761904761905,1.5015000000000001,1.587],"type":"bar","name":"2018","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Southern Asia","Sub-Saharan Africa","Middle East and Northern Africa","Southeastern Asia","Eastern Asia","Central and Eastern Europe","Latin America and Caribbean","Western Europe","North America","Australia and New Zealand"],"y":[0.98685714285714288,0.91667500000000002,1.1486842105263158,1.2464444444444445,1.3334999999999999,1.3387931034482758,1.3397142857142856,1.4728571428571429,1.4809999999999999,1.5525],"type":"bar","name":"2019","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>Regional Trend</strong></p>
<pre class="r"><code>regional_hap_df |&gt;
  filter(factor == &quot;social_support&quot;)|&gt;
  plot_ly(
      x = ~year, y = ~average_score, color = ~region,
      mode = &#39;lines+markers&#39;, type = &#39;scatter&#39;, colors = &#39;viridis&#39;,
      name = ~region) |&gt;
    layout(
      title = paste(&quot;Regional Trend for Social Support from 2015 to 2019&quot;),
      xaxis = list(title = &quot;Year&quot;),
      yaxis = list(title = &quot;Average Score&quot;),
      autosize = F, width = 820, height = 500
    )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2cf184f985199b3ba344" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-2cf184f985199b3ba344">{"x":{"visdat":{"b30a51ce8242":["function () ","plotlyVisDat"]},"cur_data":"b30a51ce8242","attrs":{"b30a51ce8242":{"x":{},"y":{},"mode":"lines+markers","name":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"width":820,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Regional Trend for Social Support from 2015 to 2019","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2015","2016","2017","2018","2019"],"y":[1.3144499999999999,1.1387700000000001,1.5291185379028351,1.587,1.5525],"mode":"lines+markers","name":"Australia and New Zealand","type":"scatter","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[1.0530424137931034,0.86185517241379306,1.2822854169483835,1.3258620689655172,1.3387931034482758],"mode":"lines+markers","name":"Central and Eastern Europe","type":"scatter","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"line":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[1.0994266666666666,0.91042833333333339,1.3109695315361016,1.3418333333333332,1.3334999999999999],"mode":"lines+markers","name":"Eastern Asia","type":"scatter","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"line":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[1.1047204545454545,0.89843208333333335,1.290156085382808,1.3353181818181818,1.3397142857142856],"mode":"lines+markers","name":"Latin America and Caribbean","type":"scatter","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"line":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.92049000000000003,0.69564421052631575,1.0955113548981519,1.1108421052631579,1.1486842105263158],"mode":"lines+markers","name":"Middle East and Northern Africa","type":"scatter","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"line":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[1.2848600000000001,1.07196,1.450634777545925,1.5015000000000001,1.4809999999999999],"mode":"lines+markers","name":"North America","type":"scatter","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"line":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.94046777777777779,0.79175555555555555,1.2499475926160799,1.2571111111111111,1.2464444444444445],"mode":"lines+markers","name":"Southeastern Asia","type":"scatter","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"line":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.6453214285714286,0.48069428571428569,0.93187493085861162,0.97442857142857142,0.98685714285714288],"mode":"lines+markers","name":"Southern Asia","type":"scatter","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"line":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.80908500000000005,0.59365552631578944,0.95391888954700588,0.94776923076923081,0.91667500000000002],"mode":"lines+markers","name":"Sub-Saharan Africa","type":"scatter","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"line":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[1.2473019047619047,1.0424523809523809,1.4449456589562553,1.4764761904761905,1.4728571428571429],"mode":"lines+markers","name":"Western Europe","type":"scatter","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>At <em>countries level</em>, from 2015 to 2019, Iceland has the
highest social support score. Benin and Syria has the lowest. Iceland,
Ireland, Denmark, New Zealand and Finland are the top 5 countries with
the highest social support score. Benin, Syria, Togo, Burundi, Malawi
are the bottom 5 countries with the lowest social support scores.</p>
<p>At <em>regional level</em>, from 2015 to 2019, Australia and New
Zealand has the highest social support score and Southern Asia has the
lowest. The trend between 10 regions is relatively similar, with a
decreased from 2015 to 2016, then an increase trend afterwards.</p>
</div>
<div id="life-expectancy" class="section level3">
<h3>Life Expectancy</h3>
<p><strong>At Country Level</strong></p>
<pre class="r"><code>hap_df |&gt;
  mutate(country = fct_reorder(country, health_life_expectancy))|&gt;
  plot_ly (
  x = ~country, y = ~health_life_expectancy, color = ~year,
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;Healthy Life Expectancy&quot;,
    xaxis = list(
      title = &quot;country&quot;,
      tickfont = list(size = 6)
      ),
    yaxis = list(title = &quot;Score&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a5bf9d36246dbd255bc8" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-a5bf9d36246dbd255bc8">{"x":{"visdat":{"b30a5ada4f57":["function () ","plotlyVisDat"]},"cur_data":"b30a5ada4f57","attrs":{"b30a5ada4f57":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Healthy Life Expectancy","xaxis":{"domain":[0,1],"automargin":true,"title":"country","tickfont":{"size":6},"type":"category","categoryorder":"array","categoryarray":["Sierra Leone","Swaziland","Central African Republic","Chad","Nigeria","Lesotho","Ivory Coast","Angola","Somalia","Mozambique","Burundi","Mali","South Sudan","Cameroon","Democratic Republic of the Congo","Guinea","Uganda","Benin","Zimbabwe","Togo","Burkina Faso","Afghanistan","Liberia","Niger","South Africa","Haiti","Mauritania","Zambia","Sudan","Malawi","Republic of Congo","Somaliland Region","Ghana","Yemen","Botswana","Namibia","Djibouti","Comoros","Tanzania","Ethiopia","Rwanda","Madagascar","Gabon","Kenya","Pakistan","Gambia","Myanmar","Senegal","Belize","Cambodia","India","Laos","Bolivia","Philippines","Turkmenistan","Indonesia","Bhutan","Iraq","Nepal","Syria","Egypt","Libya","Suriname","Trinidad and Tobago","Tajikistan","Mongolia","Kosovo","Bangladesh","Kyrgyzstan","Uzbekistan","Russia","Palestinian Territories","Azerbaijan","Guatemala","Ukraine","Morocco","Dominican Republic","Paraguay","Algeria","Moldova","Honduras","Kazakhstan","Saudi Arabia","Colombia","El Salvador","Jordan","Georgia","Venezuela","Armenia","Malaysia","Macedonia","Latvia","Sri Lanka","Peru","Brazil","Kuwait","Mauritius","Serbia","Turkey","Jamaica","Tunisia","Iran","Bahrain","Belarus","Nicaragua","Vietnam","Thailand","Bulgaria","Lithuania","Montenegro","Romania","United Arab Emirates","Hungary","Ecuador","Croatia","Estonia","Argentina","Qatar","Bosnia and Herzegovina","Panama","Mexico","Oman","Uruguay","Slovakia","Puerto Rico","Poland","Lebanon","Albania","China","Costa Rica","USA","Chile","North Macedonia","Czech Republic","Slovenia","Taiwan","Germany","Norway","Denmark","Finland","Portugal","Ireland","New Zealand","Netherlands","Greece","Israel","Malta","UK","Austria","Belgium","Canada","Luxembourg","France","Cyprus","North Cyprus","Australia","Sweden","Iceland","Switzerland","Italy","South Korea","Spain","Japan","Singapore","Hong Kong"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Switzerland","Iceland","Denmark","Norway","Canada","Finland","Netherlands","Sweden","New Zealand","Australia","Israel","Costa Rica","Austria","Mexico","USA","Brazil","Luxembourg","Ireland","Belgium","United Arab Emirates","UK","Oman","Venezuela","Singapore","Panama","Germany","Chile","Qatar","France","Argentina","Czech Republic","Uruguay","Colombia","Thailand","Saudi Arabia","Spain","Malta","Taiwan","Kuwait","Suriname","Trinidad and Tobago","El Salvador","Guatemala","Uzbekistan","Slovakia","Japan","South Korea","Ecuador","Bahrain","Italy","Bolivia","Moldova","Paraguay","Kazakhstan","Slovenia","Lithuania","Nicaragua","Peru","Belarus","Poland","Malaysia","Croatia","Libya","Russia","Jamaica","North Cyprus","Cyprus","Algeria","Kosovo","Turkmenistan","Mauritius","Hong Kong","Estonia","Indonesia","Vietnam","Turkey","Kyrgyzstan","Nigeria","Bhutan","Azerbaijan","Pakistan","Jordan","Montenegro","China","Zambia","Romania","Serbia","Portugal","Latvia","Philippines","Somalia","Morocco","Macedonia","Mozambique","Albania","Bosnia and Herzegovina","Lesotho","Dominican Republic","Laos","Mongolia","Swaziland","Greece","Lebanon","Hungary","Honduras","Tajikistan","Tunisia","Palestinian Territories","Bangladesh","Iran","Ukraine","Iraq","South Africa","Ghana","Zimbabwe","Liberia","India","Sudan","Haiti","Democratic Republic of the Congo","Nepal","Ethiopia","Sierra Leone","Mauritania","Kenya","Djibouti","Armenia","Botswana","Myanmar","Georgia","Malawi","Sri Lanka","Cameroon","Bulgaria","Egypt","Yemen","Angola","Mali","Republic of Congo","Comoros","Uganda","Senegal","Gabon","Niger","Cambodia","Tanzania","Madagascar","Central African Republic","Chad","Guinea","Ivory Coast","Burkina Faso","Afghanistan","Rwanda","Benin","Syria","Burundi","Togo"],"y":[0.94142999999999999,0.94784000000000002,0.87463999999999997,0.88521000000000005,0.90563000000000005,0.88910999999999996,0.89283999999999997,0.91086999999999996,0.90837000000000001,0.93156000000000005,0.91386999999999996,0.86026999999999998,0.89041999999999999,0.81444000000000005,0.86178999999999994,0.69701999999999997,0.91893999999999998,0.89532999999999996,0.89666999999999997,0.80925000000000002,0.90942999999999996,0.76275999999999999,0.72052000000000005,1.02525,0.79661000000000004,0.89185999999999999,0.85857000000000006,0.79732999999999998,0.94579000000000002,0.78722999999999999,0.84482999999999997,0.81159999999999999,0.69077,0.73850000000000005,0.72024999999999995,0.95562000000000002,0.88721000000000005,0.87529999999999997,0.72492000000000001,0.60819999999999996,0.61482999999999999,0.67737000000000003,0.64424999999999999,0.59772000000000003,0.78902000000000005,0.99111000000000005,0.96538000000000002,0.79074999999999995,0.74716000000000005,0.95445999999999998,0.53920000000000001,0.61826000000000003,0.66098000000000001,0.64368000000000003,0.87336999999999998,0.73128000000000004,0.74314000000000002,0.73016999999999999,0.73607999999999996,0.77903,0.72394000000000003,0.78805000000000003,0.70379999999999998,0.66925999999999997,0.68740999999999997,0.92356000000000005,0.92356000000000005,0.61765999999999999,0.63131999999999999,0.53886000000000001,0.70950000000000002,1.01328,0.77361000000000002,0.63793,0.74675999999999998,0.73172000000000004,0.65088000000000001,0.16006999999999999,0.57406999999999997,0.64044999999999996,0.51466000000000001,0.69638999999999995,0.72521000000000002,0.81657999999999997,0.29924000000000001,0.76890000000000003,0.74836000000000003,0.87519000000000002,0.72436999999999996,0.58113999999999999,0.43873000000000001,0.60953999999999997,0.73545000000000005,0.091310000000000002,0.81325000000000003,0.79081000000000001,0.076119999999999993,0.66825000000000001,0.54908999999999997,0.60267999999999999,0.075660000000000005,0.88212999999999997,0.83947000000000005,0.75905,0.69510000000000005,0.57379000000000002,0.73792999999999997,0.66015000000000001,0.60163999999999995,0.69804999999999995,0.67390000000000005,0.60236999999999996,0.27688000000000001,0.40132000000000001,0.33474999999999999,0.34200999999999998,0.51529000000000003,0.36878,0.38846999999999998,0.098059999999999994,0.56874000000000002,0.44055,0,0.35874,0.41435,0.36291000000000001,0.72989999999999999,0.047759999999999997,0.48246,0.72926000000000002,0.22561999999999999,0.70806000000000002,0.23402000000000001,0.76649,0.61712,0.40064,0.16683000000000001,0.20583000000000001,0.31051000000000001,0.36314999999999997,0.33861000000000002,0.43540000000000001,0.43371999999999999,0.29707,0.61114000000000002,0.38214999999999999,0.46721000000000001,0.066989999999999994,0.15010000000000001,0.24009,0.15185000000000001,0.27124999999999999,0.30335000000000001,0.42864000000000002,0.31909999999999999,0.72192999999999996,0.22395999999999999,0.28443000000000002],"type":"bar","name":"2015","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Denmark","Switzerland","Iceland","Norway","Finland","Canada","Netherlands","New Zealand","Australia","Sweden","Israel","Austria","USA","Costa Rica","Puerto Rico","Germany","Brazil","Belgium","Ireland","Luxembourg","Mexico","Singapore","UK","Chile","Panama","Argentina","Czech Republic","United Arab Emirates","Uruguay","Malta","Colombia","France","Thailand","Saudi Arabia","Taiwan","Qatar","Spain","Algeria","Guatemala","Suriname","Kuwait","Bahrain","Trinidad and Tobago","Venezuela","Slovakia","El Salvador","Malaysia","Nicaragua","Uzbekistan","Italy","Ecuador","Belize","Japan","Kazakhstan","Moldova","Russia","Poland","South Korea","Bolivia","Lithuania","Belarus","North Cyprus","Slovenia","Peru","Turkmenistan","Mauritius","Libya","Latvia","Cyprus","Paraguay","Romania","Estonia","Jamaica","Croatia","Hong Kong","Somalia","Kosovo","Turkey","Indonesia","Jordan","Azerbaijan","Philippines","China","Bhutan","Kyrgyzstan","Serbia","Bosnia and Herzegovina","Montenegro","Dominican Republic","Morocco","Hungary","Pakistan","Lebanon","Portugal","Macedonia","Vietnam","Somaliland Region","Tunisia","Greece","Tajikistan","Mongolia","Laos","Nigeria","Honduras","Iran","Zambia","Nepal","Palestinian Territories","Albania","Bangladesh","Sierra Leone","Iraq","Namibia","Cameroon","Ethiopia","South Africa","Sri Lanka","India","Myanmar","Egypt","Armenia","Kenya","Ukraine","Ghana","Democratic Republic of the Congo","Georgia","Republic of Congo","Senegal","Bulgaria","Mauritania","Zimbabwe","Malawi","Sudan","Gabon","Mali","Haiti","Botswana","Comoros","Ivory Coast","Cambodia","Angola","Niger","South Sudan","Chad","Burkina Faso","Uganda","Yemen","Madagascar","Tanzania","Liberia","Guinea","Rwanda","Benin","Afghanistan","Togo","Syria","Burundi"],"y":[0.79503999999999997,0.86302999999999996,0.86733000000000005,0.79579,0.81091000000000002,0.8276,0.81230999999999998,0.83096000000000003,0.85119999999999996,0.83121,0.84916999999999998,0.80564999999999998,0.77900000000000003,0.76146000000000003,0.77758000000000005,0.81486999999999998,0.61414999999999997,0.81959000000000004,0.81455,0.84541999999999995,0.71143000000000001,0.94718999999999998,0.80991000000000002,0.81882999999999995,0.70835000000000004,0.69711000000000001,0.76375999999999999,0.72992999999999997,0.72182999999999997,0.80315000000000003,0.59658999999999995,0.83794999999999997,0.64915,0.59267000000000003,0.79564999999999997,0.71723000000000003,0.87895999999999996,0.61804000000000003,0.54039000000000004,0.50932999999999995,0.63568999999999998,0.65695999999999999,0.52607999999999999,0.61904000000000003,0.70367000000000002,0.59599999999999997,0.62365999999999999,0.65212999999999999,0.50163000000000002,0.85102,0.68613000000000002,0.45568999999999998,0.91491,0.57386000000000004,0.52309000000000005,0.58991000000000005,0.69057999999999997,0.88644999999999996,0.46970000000000001,0.64673999999999998,0.63104000000000005,0.84141999999999995,0.79151000000000005,0.62994000000000006,0.44006000000000001,0.66188999999999998,0.52303999999999995,0.63951999999999998,0.8488,0.58294999999999997,0.67601999999999995,0.68098000000000003,0.59469000000000005,0.70523999999999998,0.95277000000000001,0.11466,0.54000000000000004,0.64717999999999998,0.49374000000000001,0.60711999999999999,0.54503999999999997,0.47036,0.73560999999999999,0.49758999999999998,0.55449000000000004,0.64580000000000004,0.70765999999999996,0.63532999999999995,0.57669000000000004,0.59470999999999996,0.67608000000000001,0.40305999999999997,0.76171,0.79362999999999995,0.64737999999999996,0.66156999999999999,0.33107999999999999,0.59577000000000002,0.80028999999999995,0.53119000000000005,0.55469000000000002,0.38290999999999997,0.05108,0.58382999999999996,0.64232,0.23573,0.50073000000000001,0.56843999999999995,0.73007,0.52988999999999997,0,0.51075999999999999,0.34744999999999998,0.12698000000000001,0.34577999999999998,0.18611,0.62007000000000001,0.45090999999999998,0.39879999999999999,0.52115999999999996,0.64083000000000001,0.30147000000000002,0.58628000000000002,0.29681000000000002,0.188,0.64034999999999997,0.28211999999999998,0.40456999999999999,0.67806,0.28638999999999998,0.1595,0.29364000000000001,0.29759000000000002,0.34939999999999999,0.16347,0.27494000000000002,0.34752,0.29981000000000002,0.044760000000000001,0.42493999999999998,0.049910000000000003,0.26162000000000002,0.15781000000000001,0.038240000000000003,0.21296999999999999,0.19625000000000001,0.31047999999999998,0.37108999999999998,0.35699999999999998,0.23164999999999999,0.18829000000000001,0.31864999999999999,0.21027999999999999,0.17344000000000001,0.24811,0.62994000000000006,0.15747],"type":"bar","name":"2016","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Norway","Denmark","Iceland","Switzerland","Finland","Netherlands","Canada","New Zealand","Sweden","Australia","Israel","Costa Rica","Austria","USA","Ireland","Germany","Belgium","Luxembourg","UK","Chile","United Arab Emirates","Brazil","Czech Republic","Argentina","Mexico","Singapore","Malta","Uruguay","Guatemala","Panama","France","Thailand","Taiwan","Spain","Qatar","Colombia","Saudi Arabia","Trinidad and Tobago","Kuwait","Slovakia","Bahrain","Malaysia","Nicaragua","Ecuador","El Salvador","Poland","Uzbekistan","Italy","Russia","Belize","Japan","Lithuania","Algeria","Latvia","South Korea","Moldova","Romania","Bolivia","Turkmenistan","Kazakhstan","North Cyprus","Slovenia","Peru","Mauritius","Cyprus","Estonia","Belarus","Libya","Turkey","Paraguay","Hong Kong","Philippines","Serbia","Jordan","Hungary","Jamaica","Croatia","Kosovo","China","Pakistan","Indonesia","Venezuela","Montenegro","Morocco","Azerbaijan","Dominican Republic","Greece","Lebanon","Portugal","Bosnia and Herzegovina","Honduras","Macedonia","Somalia","Vietnam","Nigeria","Tajikistan","Bhutan","Kyrgyzstan","Nepal","Mongolia","South Africa","Tunisia","Palestinian Territories","Egypt","Bulgaria","Sierra Leone","Cameroon","Iran","Albania","Bangladesh","Namibia","Kenya","Mozambique","Myanmar","Senegal","Zambia","Iraq","Gabon","Ethiopia","Sri Lanka","Armenia","India","Mauritania","Republic of Congo","Georgia","Democratic Republic of the Congo","Mali","Ivory Coast","Cambodia","Sudan","Ghana","Ukraine","Uganda","Burkina Faso","Niger","Malawi","Chad","Zimbabwe","Lesotho","Angola","Afghanistan","Botswana","Benin","Madagascar","Haiti","Yemen","South Sudan","Liberia","Guinea","Togo","Rwanda","Syria","Tanzania","Burundi","Central African Republic"],"y":[0.79666650295257602,0.79256552457809404,0.83355212211608898,0.85813128948211703,0.80915766954421997,0.81069612503051802,0.83455765247345004,0.81675970554351796,0.83087515830993697,0.84388679265975997,0.83840399980545,0.75950926542282104,0.81532841920852706,0.77428662776946999,0.80978262424469005,0.79895073175430298,0.81809186935424805,0.84508949518203702,0.80533593893051103,0.81947970390319802,0.726798236370087,0.61655235290527299,0.75444400310516402,0.69513708353042603,0.70997899770736705,0.94949239492416404,0.82194423675537098,0.71921682357788097,0.54023998975753795,0.70615613460540805,0.844465851783752,0.647239029407501,0.793984234333038,0.88896059989929199,0.71009808778762795,0.59502792358398404,0.59014832973480202,0.51998329162597701,0.63210570812225297,0.71273291110992398,0.65313303470611594,0.61878442764282204,0.65309596061706499,0.68563622236251798,0.59601855278015103,0.69947534799575795,0.49827262759208701,0.85314434766769398,0.547349333763123,0.45019176602363598,0.91347587108612105,0.62894994020462003,0.61758464574813798,0.63856697082519498,0.90021407604217496,0.58946520090103105,0.68515831232070901,0.47363024950027499,0.437726080417633,0.60604155063629195,0.83464723825454701,0.79082822799682595,0.63016611337661699,0.63800746202468905,0.84471470117569003,0.695168316364288,0.63771426677703902,0.52016901969909701,0.63760560750961304,0.57925069332122803,0.943062424659729,0.46800905466079701,0.65078467130661,0.60459005832672097,0.687763452529907,0.64102238416671797,0.701288521289825,0.54145205020904497,0.74141550064086903,0.40204778313636802,0.492345720529556,0.61714422702789296,0.66746467351913497,0.59771066904068004,0.54077577590942405,0.57487374544143699,0.81019890308380105,0.73508107662200917,0.79584354162216198,0.705186307430267,0.582569479942322,0.64494818449020397,0.113989137113094,0.652168989181519,0.056915730237960802,0.52923512458801303,0.49587929248809798,0.55345779657363903,0.50413078069686901,0.55778348445892301,0.18708007037639601,0.61321204900741599,0.56566697359085105,0.52018725872039795,0.70821768045425404,0.0055647538974881198,0.13289211690425901,0.63933318853378296,0.73115974664688099,0.53324103355407704,0.33861181139946001,0.30998834967613198,0.106654435396194,0.39752256870269798,0.409362852573395,0.25783589482307401,0.50118046998977706,0.356578588485718,0.35340970754623402,0.62513083219528198,0.63752442598342896,0.455427616834641,0.28534927964210499,0.28995743393897999,0.64954698085784901,0.191407024860382,0.169365674257278,0.048642169684171697,0.42978340387344399,0.29092082381248502,0.295637726783752,0.57590395212173495,0.217632606625557,0.21584425866603901,0.26850500702857999,0.31508958339691201,0.041134715080261203,0.19676375389099099,0,0.049868665635585799,0.18074677884578699,0.34175550937652599,0.20993021130561801,0.375223308801651,0.27732113003730802,0.310080915689468,0.16348600387573201,0.22991819679737099,0.194129139184952,0.247105568647385,0.32642480731010398,0.50053334236144997,0.36450928449630698,0.15161079168319699,0.018772685900330498],"type":"bar","name":"2017","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Norway","Denmark","Iceland","Switzerland","Netherlands","Canada","New Zealand","Sweden","Australia","UK","Austria","Costa Rica","Ireland","Germany","Belgium","Luxembourg","USA","Israel","United Arab Emirates","Czech Republic","Malta","France","Mexico","Chile","Taiwan","Panama","Brazil","Argentina","Guatemala","Uruguay","Qatar","Saudi Arabia","Singapore","Malaysia","Spain","Colombia","Trinidad and Tobago","Slovakia","El Salvador","Nicaragua","Poland","Bahrain","Uzbekistan","Kuwait","Thailand","Italy","Ecuador","Belize","Lithuania","Slovenia","Romania","Latvia","Japan","Mauritius","Jamaica","South Korea","North Cyprus","Russia","Kazakhstan","Cyprus","Bolivia","Estonia","Paraguay","Peru","Kosovo","Moldova","Turkmenistan","Hungary","Libya","Philippines","Honduras","Belarus","Turkey","Pakistan","Hong Kong","Portugal","Serbia","Greece","Lebanon","Montenegro","Croatia","Dominican Republic","Algeria","Morocco","China","Azerbaijan","Tajikistan","Macedonia","Jordan","Nigeria","Kyrgyzstan","Bosnia and Herzegovina","Mongolia","Vietnam","Indonesia","Bhutan","Somalia","Cameroon","Bulgaria","Nepal","Venezuela","Gabon","Palestinian Territories","South Africa","Iran","Ivory Coast","Ghana","Senegal","Laos","Tunisia","Albania","Sierra Leone","Republic of Congo","Bangladesh","Sri Lanka","Iraq","Mali","Namibia","Cambodia","Burkina Faso","Egypt","Mozambique","Kenya","Zambia","Mauritania","Ethiopia","Georgia","Armenia","Myanmar","Chad","Democratic Republic of the Congo","India","Niger","Uganda","Benin","Sudan","Ukraine","Togo","Guinea","Lesotho","Angola","Madagascar","Zimbabwe","Afghanistan","Botswana","Malawi","Haiti","Liberia","Syria","Rwanda","Yemen","Tanzania","South Sudan","Central African Republic","Burundi"],"y":[0.874,0.86099999999999999,0.86799999999999999,0.91400000000000003,0.92700000000000005,0.878,0.89600000000000002,0.876,0.91300000000000003,0.91000000000000003,0.88800000000000001,0.89100000000000001,0.81699999999999995,0.876,0.86099999999999999,0.89400000000000002,0.89600000000000002,0.81899999999999995,0.88300000000000001,0.67000000000000004,0.85399999999999998,0.88400000000000001,0.90800000000000003,0.76100000000000001,0.80800000000000005,0.85699999999999998,0.75900000000000001,0.67500000000000004,0.74399999999999999,0.60799999999999998,0.77100000000000002,0.748,0.63300000000000001,1.008,0.66900000000000004,0.96499999999999997,0.63500000000000001,0.56399999999999995,0.77600000000000002,0.63900000000000001,0.69999999999999996,0.78100000000000003,0.69799999999999995,0.60499999999999998,0.67500000000000004,0.70699999999999996,0.94599999999999995,0.73599999999999999,0.47399999999999998,0.71599999999999997,0.85599999999999998,0.72599999999999998,0.67100000000000004,0.98799999999999999,0.68400000000000005,0.69299999999999995,0.95499999999999996,0.90900000000000003,0.59899999999999998,0.63100000000000001,0.90900000000000003,0.50800000000000001,0.73699999999999999,0.61499999999999999,0.67400000000000004,0.57799999999999996,0.62,0.51700000000000002,0.73199999999999998,0.55300000000000005,0.51300000000000001,0.622,0.69999999999999996,0.68600000000000005,0.42399999999999999,1.03,0.88400000000000001,0.68500000000000005,0.879,0.78500000000000003,0.72899999999999998,0.73699999999999999,0.61399999999999999,0.68700000000000006,0.66900000000000004,0.79900000000000004,0.60299999999999998,0.59799999999999998,0.69099999999999995,0.64500000000000002,0.048000000000000001,0.59399999999999997,0.75800000000000001,0.57499999999999996,0.70199999999999996,0.52200000000000002,0.52700000000000002,0.115,0.182,0.71199999999999997,0.53900000000000003,0.65700000000000003,0.40400000000000003,0.60199999999999998,0.33000000000000002,0.69099999999999995,0.080000000000000002,0.33700000000000002,0.433,0.441,0.68999999999999995,0.79000000000000004,0,0.34300000000000003,0.57899999999999996,0.67200000000000004,0.53600000000000003,0.152,0.36499999999999999,0.45700000000000002,0.254,0.55300000000000005,0.17299999999999999,0.45400000000000001,0.29499999999999998,0.29199999999999998,0.39100000000000001,0.64300000000000002,0.66600000000000004,0.42899999999999999,0.052999999999999999,0.20399999999999999,0.48499999999999999,0.221,0.23699999999999999,0.23999999999999999,0.312,0.60899999999999999,0.253,0.21099999999999999,0.079000000000000001,0.26900000000000002,0.40200000000000002,0.248,0.255,0.41699999999999998,0.30599999999999999,0.28899999999999998,0.26700000000000002,0.53900000000000003,0.40000000000000002,0.34300000000000003,0.38100000000000001,0.17699999999999999,0.01,0.14499999999999999],"type":"bar","name":"2018","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Denmark","Norway","Iceland","Netherlands","Switzerland","Sweden","New Zealand","Canada","Austria","Australia","Costa Rica","Israel","Luxembourg","UK","Ireland","Germany","Belgium","USA","Czech Republic","United Arab Emirates","Malta","Mexico","France","Taiwan","Chile","Guatemala","Saudi Arabia","Qatar","Spain","Panama","Brazil","Uruguay","Singapore","El Salvador","Italy","Bahrain","Slovakia","Trinidad and Tobago","Poland","Uzbekistan","Lithuania","Colombia","Slovenia","Nicaragua","Kosovo","Argentina","Romania","Cyprus","Ecuador","Kuwait","Thailand","Latvia","South Korea","Estonia","Jamaica","Mauritius","Japan","Honduras","Kazakhstan","Bolivia","Hungary","Paraguay","North Cyprus","Peru","Portugal","Pakistan","Russia","Philippines","Serbia","Moldova","Libya","Montenegro","Tajikistan","Croatia","Hong Kong","Dominican Republic","Bosnia and Herzegovina","Turkey","Malaysia","Belarus","Greece","Mongolia","North Macedonia","Nigeria","Kyrgyzstan","Turkmenistan","Algeria","Morocco","Azerbaijan","Lebanon","Indonesia","China","Vietnam","Bhutan","Cameroon","Bulgaria","Ghana","Ivory Coast","Nepal","Jordan","Benin","Republic of Congo","Gabon","Laos","South Africa","Albania","Venezuela","Cambodia","Palestinian Territories","Senegal","Somalia","Namibia","Niger","Burkina Faso","Armenia","Iran","Guinea","Georgia","Gambia","Kenya","Mauritania","Mozambique","Tunisia","Bangladesh","Iraq","Democratic Republic of the Congo","Mali","Sierra Leone","Sri Lanka","Myanmar","Chad","Ukraine","Ethiopia","Swaziland","Uganda","Egypt","Zambia","Togo","India","Liberia","Comoros","Madagascar","Lesotho","Burundi","Zimbabwe","Haiti","Botswana","Syria","Malawi","Yemen","Rwanda","Tanzania","Afghanistan","Central African Republic","South Sudan"],"y":[0.98599999999999999,0.996,1.028,1.026,0.999,1.052,1.0089999999999999,1.026,1.0389999999999999,1.016,1.036,0.96299999999999997,1.0289999999999999,1.012,0.996,0.999,0.98699999999999999,0.98599999999999999,0.874,0.92000000000000004,0.82499999999999996,0.999,0.86099999999999999,1.0449999999999999,0.91400000000000003,0.92000000000000004,0.746,0.79500000000000004,0.871,1.0620000000000001,0.91000000000000003,0.80200000000000005,0.89100000000000001,1.141,0.78900000000000003,1.0389999999999999,0.871,0.88100000000000001,0.71299999999999997,0.88400000000000001,0.75600000000000001,0.81799999999999995,0.84099999999999997,0.95299999999999996,0.83499999999999996,0.75800000000000001,0.88100000000000001,0.82499999999999996,1.042,0.86799999999999999,0.80800000000000005,0.82799999999999996,0.81200000000000006,1.036,0.874,0.83099999999999996,0.79800000000000004,1.0880000000000001,0.82799999999999996,0.72899999999999998,0.70599999999999996,0.82799999999999996,0.77700000000000002,1.042,0.85399999999999998,0.999,0.53500000000000003,0.72599999999999998,0.65700000000000003,0.85399999999999998,0.73899999999999999,0.67300000000000004,0.871,0.71799999999999997,0.91400000000000003,1.1220000000000001,0.77900000000000003,0.84499999999999997,0.80800000000000005,0.82799999999999996,0.78900000000000003,0.999,0.66700000000000004,0.83799999999999997,0.245,0.72299999999999998,0.65700000000000003,0.78500000000000003,0.78200000000000003,0.76900000000000002,0.81499999999999995,0.66000000000000003,0.89300000000000002,0.85099999999999998,0.60399999999999998,0.33100000000000002,0.81499999999999995,0.48599999999999999,0.23200000000000001,0.67700000000000005,0.81499999999999995,0.39700000000000002,0.50800000000000001,0.57099999999999995,0.55100000000000005,0.46899999999999997,0.874,0.80500000000000005,0.63700000000000001,0.67200000000000004,0.57099999999999995,0.26800000000000002,0.47699999999999998,0.36599999999999999,0.38,0.81499999999999995,0.78500000000000003,0.375,0.752,0.42799999999999999,0.58099999999999996,0.48899999999999999,0.39000000000000001,0.81499999999999995,0.72299999999999998,0.57399999999999995,0.35699999999999998,0.308,0.24199999999999999,0.83099999999999996,0.55500000000000005,0.192,0.73899999999999999,0.53200000000000003,0,0.443,0.64400000000000002,0.42599999999999999,0.40999999999999998,0.58799999999999997,0.443,0.505,0.55500000000000005,0.16800000000000001,0.38,0.433,0.44900000000000001,0.53800000000000003,0.44,0.495,0.46300000000000002,0.61399999999999999,0.499,0.36099999999999999,0.105,0.29499999999999998],"type":"bar","name":"2019","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>At Region Level</strong></p>
<pre class="r"><code>hap_df |&gt;
  mutate(region = fct_reorder(region, health_life_expectancy))|&gt;
  group_by(region, year)|&gt;
  summarise(
    average_life_expectancy = mean(health_life_expectancy, na.rm = TRUE)
  ) |&gt;
  plot_ly (
  x = ~region, y = ~average_life_expectancy, color = ~year,
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;Healthy Life Expectancy By Region&quot;,
    xaxis = list(title = &quot;Region&quot;),
    yaxis = list(title = &quot;Average Score&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-cc3047ab84496571a70e" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-cc3047ab84496571a70e">{"x":{"visdat":{"b30a4c2bbfa4":["function () ","plotlyVisDat"]},"cur_data":"b30a4c2bbfa4","attrs":{"b30a4c2bbfa4":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Healthy Life Expectancy By Region","xaxis":{"domain":[0,1],"automargin":true,"title":"Region","type":"category","categoryorder":"array","categoryarray":["Sub-Saharan Africa","Southern Asia","Southeastern Asia","Middle East and Northern Africa","Latin America and Caribbean","Central and Eastern Europe","North America","Western Europe","Australia and New Zealand","Eastern Asia"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Sub-Saharan Africa","Southern Asia","Southeastern Asia","Middle East and Northern Africa","Latin America and Caribbean","Central and Eastern Europe","North America","Western Europe","Australia and New Zealand","Eastern Asia"],"y":[0.28233174999999999,0.54083000000000003,0.67735666666666672,0.70561549999999995,0.7038704545454546,0.71877379310344824,0.88371,0.90914809523809526,0.91996500000000003,0.87738833333333333],"type":"bar","name":"2015","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Sub-Saharan Africa","Southern Asia","Southeastern Asia","Middle East and Northern Africa","Latin America and Caribbean","Central and Eastern Europe","North America","Western Europe","Australia and New Zealand","Eastern Asia"],"y":[0.23987236842105264,0.45367000000000002,0.56136888888888892,0.61643789473684207,0.61270250000000004,0.63159206896551723,0.80330000000000001,0.8257538095238095,0.84108000000000005,0.80667999999999995],"type":"bar","name":"2016","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Sub-Saharan Africa","Southern Asia","Southeastern Asia","Middle East and Northern Africa","Latin America and Caribbean","Central and Eastern Europe","North America","Western Europe","Australia and New Zealand","Eastern Asia"],"y":[0.22476602925990632,0.45665773110730312,0.58191819861531258,0.60598014059819671,0.61100918596441101,0.63608973910068645,0.80442214012145996,0.8246734709966751,0.83032324910163902,0.80832259853680921],"type":"bar","name":"2017","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Sub-Saharan Africa","Southern Asia","Southeastern Asia","Middle East and Northern Africa","Latin America and Caribbean","Central and Eastern Europe","North America","Western Europe","Australia and New Zealand","Eastern Asia"],"y":[0.26061538461538464,0.49728571428571428,0.60533333333333328,0.64663157894736845,0.65286363636363631,0.68668965517241376,0.85749999999999993,0.89642857142857146,0.89300000000000002,0.86733333333333329],"type":"bar","name":"2018","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Sub-Saharan Africa","Southern Asia","Southeastern Asia","Middle East and Northern Africa","Latin America and Caribbean","Central and Eastern Europe","North America","Western Europe","Australia and New Zealand","Eastern Asia"],"y":[0.40755000000000002,0.61699999999999999,0.74533333333333329,0.75105263157894742,0.81185714285714283,0.80951724137931036,0.95649999999999991,1.0151904761904762,1.0310000000000001,0.95333333333333337],"type":"bar","name":"2019","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>Regional Trend</strong></p>
<pre class="r"><code>regional_hap_df |&gt;
  filter(factor == &quot;healthy_life_expectancy&quot;)|&gt;
  plot_ly(
      x = ~year, y = ~average_score, color = ~region,
      mode = &#39;lines+markers&#39;, type = &#39;scatter&#39;, colors = &#39;viridis&#39;,
      name = ~region) |&gt;
    layout(
      title = paste(&quot;Regional Trend for Life Expectancy from 2015 to 2019&quot;),
      xaxis = list(title = &quot;Year&quot;),
      yaxis = list(title = &quot;Average Score&quot;),
      autosize = F, width = 820, height = 500
    )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0328510ffe49dcdcbc05" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-0328510ffe49dcdcbc05">{"x":{"visdat":{"b30a1bb78590":["function () ","plotlyVisDat"]},"cur_data":"b30a1bb78590","attrs":{"b30a1bb78590":{"x":{},"y":{},"mode":"lines+markers","name":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"width":820,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Regional Trend for Life Expectancy from 2015 to 2019","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2015","2016","2017","2018","2019"],"y":[0.91996500000000003,0.84108000000000005,0.83032324910163902,0.89300000000000002,1.0310000000000001],"mode":"lines+markers","name":"Australia and New Zealand","type":"scatter","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.71877379310344824,0.63159206896551723,0.63608973910068645,0.68668965517241376,0.80951724137931036],"mode":"lines+markers","name":"Central and Eastern Europe","type":"scatter","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"line":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.87738833333333333,0.80667999999999995,0.80832259853680921,0.86733333333333329,0.95333333333333337],"mode":"lines+markers","name":"Eastern Asia","type":"scatter","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"line":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.7038704545454546,0.61270250000000004,0.61100918596441101,0.65286363636363631,0.81185714285714283],"mode":"lines+markers","name":"Latin America and Caribbean","type":"scatter","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"line":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.70561549999999995,0.61643789473684207,0.60598014059819671,0.64663157894736845,0.75105263157894742],"mode":"lines+markers","name":"Middle East and Northern Africa","type":"scatter","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"line":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.88371,0.80330000000000001,0.80442214012145996,0.85749999999999993,0.95649999999999991],"mode":"lines+markers","name":"North America","type":"scatter","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"line":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.67735666666666672,0.56136888888888892,0.58191819861531258,0.60533333333333328,0.74533333333333329],"mode":"lines+markers","name":"Southeastern Asia","type":"scatter","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"line":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.54083000000000003,0.45367000000000002,0.45665773110730312,0.49728571428571428,0.61699999999999999],"mode":"lines+markers","name":"Southern Asia","type":"scatter","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"line":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.28233174999999999,0.23987236842105264,0.22476602925990632,0.26061538461538464,0.40755000000000002],"mode":"lines+markers","name":"Sub-Saharan Africa","type":"scatter","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"line":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.90914809523809526,0.8257538095238095,0.8246734709966751,0.89642857142857146,1.0151904761904762],"mode":"lines+markers","name":"Western Europe","type":"scatter","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>At <em>countries level</em>, from 2015 to 2019, Singapore and Hong
Kong, China has the highest life expectancy score. Singapore, Hong Kong,
China, Japan, Spain and South Korea are the top 5 countries with the
highest score. Sierra Leone, Swaziland, Central Africa Republic, Chad
and Nigeria are the bottom 5 countries with the lowest life expectancy
scores.</p>
<p>At <em>regional level</em>, from 2015 to 2019, Eastern Asia has the
highest healthy life expectancy and S Sub-Saharan Africa has the lowest.
The trend between 10 regions is relatively similar, with a increasing
trend from 2015 to 2019.</p>
</div>
<div id="freedom-to-make-choice" class="section level3">
<h3>Freedom to make Choice</h3>
<p><strong>At Country Level</strong></p>
<pre class="r"><code>hap_df |&gt;
  mutate(
    country = fct_reorder(country, freedom_to_make_life_choices))|&gt;
  plot_ly (
  x = ~country, y = ~freedom_to_make_life_choices, color = ~year,
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;Freedom to Make Life Choices&quot;,
    xaxis = list(
      title = &quot;country&quot;,
      tickfont = list(size = 6)
      ),
    yaxis = list(title = &quot;Score&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-df2a0443a78d475dad67" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-df2a0443a78d475dad67">{"x":{"visdat":{"b30a560cb0d8":["function () ","plotlyVisDat"]},"cur_data":"b30a560cb0d8","attrs":{"b30a560cb0d8":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Freedom to Make Life Choices","xaxis":{"domain":[0,1],"automargin":true,"title":"country","tickfont":{"size":6},"type":"category","categoryorder":"array","categoryarray":["Angola","Sudan","Haiti","Burundi","Greece","Syria","Afghanistan","Mauritania","South Sudan","Venezuela","Comoros","Ukraine","Chad","Madagascar","Montenegro","Armenia","Hungary","Bosnia and Herzegovina","Serbia","Algeria","Lithuania","Pakistan","Democratic Republic of the Congo","Turkey","Egypt","Yemen","Palestinian Territories","Moldova","Iraq","South Korea","Italy","Croatia","Kosovo","Tunisia","Central African Republic","Lebanon","Belarus","Latvia","Iran","Bulgaria","Swaziland","Gabon","Slovakia","Sierra Leone","Burkina Faso","Mali","Macedonia","Liberia","Zimbabwe","North Macedonia","Georgia","Guinea","Taiwan","Togo","Russia","Senegal","Azerbaijan","Lesotho","Chile","Niger","Albania","Gambia","Tanzania","Somaliland Region","Mongolia","Nigeria","Honduras","Malaysia","Israel","Cyprus","Jordan","Spain","Ethiopia","Republic of Congo","Libya","Morocco","Turkmenistan","Ghana","South Africa","Benin","El Salvador","Cameroon","Kenya","Mexico","Tajikistan","Brazil","Kazakhstan","Nepal","Saudi Arabia","Malawi","Uganda","Ivory Coast","Peru","Kyrgyzstan","Romania","Djibouti","Zambia","Czech Republic","Nicaragua","Indonesia","Puerto Rico","India","France","Argentina","North Cyprus","Colombia","Bangladesh","Estonia","Ecuador","Mozambique","Jamaica","Hong Kong","Botswana","Japan","Kuwait","Mauritius","UK","Bhutan","Namibia","USA","Portugal","Paraguay","Myanmar","China","Trinidad and Tobago","Poland","Guatemala","Bahrain","Sri Lanka","Belgium","Panama","Belize","Singapore","Dominican Republic","Thailand","Bolivia","Suriname","Germany","Austria","Somalia","Vietnam","Laos","Slovenia","Ireland","Uruguay","Costa Rica","Rwanda","Philippines","Netherlands","Malta","Luxembourg","United Arab Emirates","Australia","Qatar","Canada","Sweden","New Zealand","Finland","Switzerland","Denmark","Iceland","Oman","Cambodia","Norway","Uzbekistan"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Switzerland","Iceland","Denmark","Norway","Canada","Finland","Netherlands","Sweden","New Zealand","Australia","Israel","Costa Rica","Austria","Mexico","USA","Brazil","Luxembourg","Ireland","Belgium","United Arab Emirates","UK","Oman","Venezuela","Singapore","Panama","Germany","Chile","Qatar","France","Argentina","Czech Republic","Uruguay","Colombia","Thailand","Saudi Arabia","Spain","Malta","Taiwan","Kuwait","Suriname","Trinidad and Tobago","El Salvador","Guatemala","Uzbekistan","Slovakia","Japan","South Korea","Ecuador","Bahrain","Italy","Bolivia","Moldova","Paraguay","Kazakhstan","Slovenia","Lithuania","Nicaragua","Peru","Belarus","Poland","Malaysia","Croatia","Libya","Russia","Jamaica","North Cyprus","Cyprus","Algeria","Kosovo","Turkmenistan","Mauritius","Hong Kong","Estonia","Indonesia","Vietnam","Turkey","Kyrgyzstan","Nigeria","Bhutan","Azerbaijan","Pakistan","Jordan","Montenegro","China","Zambia","Romania","Serbia","Portugal","Latvia","Philippines","Somalia","Morocco","Macedonia","Mozambique","Albania","Bosnia and Herzegovina","Lesotho","Dominican Republic","Laos","Mongolia","Swaziland","Greece","Lebanon","Hungary","Honduras","Tajikistan","Tunisia","Palestinian Territories","Bangladesh","Iran","Ukraine","Iraq","South Africa","Ghana","Zimbabwe","Liberia","India","Sudan","Haiti","Democratic Republic of the Congo","Nepal","Ethiopia","Sierra Leone","Mauritania","Kenya","Djibouti","Armenia","Botswana","Myanmar","Georgia","Malawi","Sri Lanka","Cameroon","Bulgaria","Egypt","Yemen","Angola","Mali","Republic of Congo","Comoros","Uganda","Senegal","Gabon","Niger","Cambodia","Tanzania","Madagascar","Central African Republic","Chad","Guinea","Ivory Coast","Burkina Faso","Afghanistan","Rwanda","Benin","Syria","Burundi","Togo"],"y":[0.66556999999999999,0.62877000000000005,0.64937999999999996,0.66973000000000005,0.63297000000000003,0.64168999999999998,0.61575999999999997,0.65980000000000005,0.63937999999999995,0.65124000000000004,0.41319,0.63375999999999999,0.62433000000000005,0.48181000000000002,0.54603999999999997,0.49048999999999998,0.61582999999999999,0.61777000000000004,0.58450000000000002,0.64156999999999997,0.59624999999999995,0.63273999999999997,0.42908000000000002,0.54252,0.54210000000000003,0.61477000000000004,0.44131999999999999,0.64039999999999997,0.55010999999999999,0.44973999999999997,0.46364,0.60362000000000005,0.53466000000000002,0.55664000000000002,0.31047999999999998,0.45950999999999997,0.60365000000000002,0.39739999999999998,0.55498999999999998,0.59657000000000004,0.55884,0.40350000000000003,0.57733000000000001,0.65820999999999996,0.31751000000000001,0.49614999999999998,0.33207999999999999,0.48574000000000001,0.45491999999999999,0.26235999999999998,0.57413999999999998,0.32818000000000003,0.53898999999999997,0.51649,0.60855000000000004,0.21342,0.55474999999999997,0.41496,0.37938,0.53122000000000003,0.53024000000000004,0.25883,0.41667999999999999,0.36679,0.50441999999999998,0.49026999999999998,0.40672000000000003,0.28578999999999999,0.24748999999999999,0.47610000000000002,0.56066000000000005,0.59608000000000005,0.44888,0.46611000000000002,0.59443999999999997,0.22814999999999999,0.43476999999999999,0.34333999999999998,0.53205999999999998,0.37030000000000002,0.12102,0.40661000000000003,0.18260000000000001,0.51697000000000004,0.48826999999999998,0.35067999999999999,0.20107,0.51468999999999998,0.29670999999999997,0.62544999999999995,0.46582000000000001,0.41691,0.33456999999999998,0.34037000000000001,0.35732999999999998,0.092450000000000004,0.31767000000000001,0.57672000000000001,0.59591000000000005,0.43625999999999998,0.30658000000000002,0.076990000000000003,0.33916000000000002,0.32112000000000002,0.40148,0.47216000000000002,0.26268000000000002,0.24499000000000001,0.40820000000000001,0.30032999999999999,0.25123000000000001,0,0.33206999999999998,0.42342000000000002,0.25861000000000001,0.28531000000000001,0.39785999999999999,0.10081,0.24424999999999999,0.22605,0.38281999999999999,0.4345,0.40839999999999999,0.24232000000000001,0.42215000000000003,0.46073999999999998,0.19847000000000001,0.49495,0.44017000000000001,0.40577000000000002,0.43053999999999998,0.53725999999999996,0.49308999999999997,0.30586999999999998,0.17288000000000001,0.35571000000000003,0.10384,0.38857000000000003,0.41465999999999997,0.22917000000000001,0.45727000000000001,0.36771999999999999,0.31913999999999998,0.47692000000000001,0.66246000000000005,0.32878000000000002,0.19184000000000001,0.48879,0.23501,0.37724999999999997,0.46866000000000002,0.39493,0.23413999999999999,0.59201000000000004,0.48449999999999999,0.15684000000000001,0.11849999999999999,0.36453000000000002],"type":"bar","name":"2015","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Denmark","Switzerland","Iceland","Norway","Finland","Canada","Netherlands","New Zealand","Australia","Sweden","Israel","Austria","USA","Costa Rica","Puerto Rico","Germany","Brazil","Belgium","Ireland","Luxembourg","Mexico","Singapore","UK","Chile","Panama","Argentina","Czech Republic","United Arab Emirates","Uruguay","Malta","Colombia","France","Thailand","Saudi Arabia","Taiwan","Qatar","Spain","Algeria","Guatemala","Suriname","Kuwait","Bahrain","Trinidad and Tobago","Venezuela","Slovakia","El Salvador","Malaysia","Nicaragua","Uzbekistan","Italy","Ecuador","Belize","Japan","Kazakhstan","Moldova","Russia","Poland","South Korea","Bolivia","Lithuania","Belarus","North Cyprus","Slovenia","Peru","Turkmenistan","Mauritius","Libya","Latvia","Cyprus","Paraguay","Romania","Estonia","Jamaica","Croatia","Hong Kong","Somalia","Kosovo","Turkey","Indonesia","Jordan","Azerbaijan","Philippines","China","Bhutan","Kyrgyzstan","Serbia","Bosnia and Herzegovina","Montenegro","Dominican Republic","Morocco","Hungary","Pakistan","Lebanon","Portugal","Macedonia","Vietnam","Somaliland Region","Tunisia","Greece","Tajikistan","Mongolia","Laos","Nigeria","Honduras","Iran","Zambia","Nepal","Palestinian Territories","Albania","Bangladesh","Sierra Leone","Iraq","Namibia","Cameroon","Ethiopia","South Africa","Sri Lanka","India","Myanmar","Egypt","Armenia","Kenya","Ukraine","Ghana","Democratic Republic of the Congo","Georgia","Republic of Congo","Senegal","Bulgaria","Mauritania","Zimbabwe","Malawi","Sudan","Gabon","Mali","Haiti","Botswana","Comoros","Ivory Coast","Cambodia","Angola","Niger","South Sudan","Chad","Burkina Faso","Uganda","Yemen","Madagascar","Tanzania","Liberia","Guinea","Rwanda","Benin","Afghanistan","Togo","Syria","Burundi"],"y":[0.57940999999999998,0.58557000000000003,0.56623999999999997,0.59609000000000001,0.57103999999999999,0.57369999999999999,0.55210999999999999,0.58147000000000004,0.56837000000000004,0.58218000000000003,0.36431999999999998,0.54354999999999998,0.48163,0.55225000000000002,0.46822999999999998,0.53466000000000002,0.40425,0.51354,0.54008,0.54869999999999997,0.37708999999999998,0.48770000000000002,0.50036000000000003,0.37789,0.48926999999999998,0.42283999999999999,0.41417999999999999,0.56215000000000004,0.54388000000000003,0.54993999999999998,0.44735000000000003,0.46561999999999998,0.49553000000000003,0.37903999999999999,0.32377,0.56679000000000002,0.37545000000000001,0.21006,0.50378999999999996,0.52234000000000003,0.43165999999999999,0.47375,0.48453000000000002,0.19847000000000001,0.23391000000000001,0.37269000000000002,0.39030999999999999,0.46582000000000001,0.60848000000000002,0.18826999999999999,0.4027,0.51231000000000004,0.46761000000000003,0.4052,0.25202000000000002,0.32682,0.45190000000000002,0.25168000000000001,0.50961000000000001,0.18929000000000001,0.29091,0.43596000000000001,0.53164,0.37502000000000002,0.37408000000000002,0.46145000000000003,0.40672000000000003,0.27995999999999999,0.29507,0.46234999999999998,0.36712,0.41510999999999998,0.43597000000000002,0.23907,0.48079,0.56777999999999995,0.14396,0.23888999999999999,0.39237,0.36022999999999999,0.35326999999999997,0.54854000000000003,0.44012000000000001,0.46073999999999998,0.40211999999999998,0.15717999999999999,0.09511,0.15110999999999999,0.52259,0.25646000000000002,0.19769999999999999,0.14621999999999999,0.26228000000000001,0.44727,0.27667999999999998,0.55954000000000004,0.39129999999999998,0.23552999999999999,0.058220000000000001,0.43408000000000002,0.35971999999999998,0.52168000000000003,0.27854000000000001,0.26755000000000001,0.22544,0.42662,0.37012,0.17743999999999999,0.31866,0.39778000000000002,0.30685000000000001,0.24856,0.48614000000000002,0.42736000000000002,0.36703000000000002,0.42482999999999999,0.50817000000000001,0.40284999999999999,0.42692000000000002,0.18847,0.14036999999999999,0.40576000000000001,0.12859000000000001,0.40972999999999998,0.15601999999999999,0.32461000000000001,0.37938,0.31056,0.21218999999999999,0.1268,0.25429000000000002,0.4143,0,0.28098000000000001,0.27544000000000002,0.12071999999999999,0.44089,0.15412000000000001,0.40662999999999999,0.58852000000000004,0.0058900000000000003,0.38041000000000003,0.19661999999999999,0.12806999999999999,0.3337,0.43652999999999997,0.22869999999999999,0.13683999999999999,0.31759999999999999,0.25747999999999999,0.30953000000000003,0.54320000000000002,0.39746999999999999,0.1643,0.34677999999999998,0.069120000000000001,0.043200000000000002],"type":"bar","name":"2016","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Norway","Denmark","Iceland","Switzerland","Finland","Netherlands","Canada","New Zealand","Sweden","Australia","Israel","Costa Rica","Austria","USA","Ireland","Germany","Belgium","Luxembourg","UK","Chile","United Arab Emirates","Brazil","Czech Republic","Argentina","Mexico","Singapore","Malta","Uruguay","Guatemala","Panama","France","Thailand","Taiwan","Spain","Qatar","Colombia","Saudi Arabia","Trinidad and Tobago","Kuwait","Slovakia","Bahrain","Malaysia","Nicaragua","Ecuador","El Salvador","Poland","Uzbekistan","Italy","Russia","Belize","Japan","Lithuania","Algeria","Latvia","South Korea","Moldova","Romania","Bolivia","Turkmenistan","Kazakhstan","North Cyprus","Slovenia","Peru","Mauritius","Cyprus","Estonia","Belarus","Libya","Turkey","Paraguay","Hong Kong","Philippines","Serbia","Jordan","Hungary","Jamaica","Croatia","Kosovo","China","Pakistan","Indonesia","Venezuela","Montenegro","Morocco","Azerbaijan","Dominican Republic","Greece","Lebanon","Portugal","Bosnia and Herzegovina","Honduras","Macedonia","Somalia","Vietnam","Nigeria","Tajikistan","Bhutan","Kyrgyzstan","Nepal","Mongolia","South Africa","Tunisia","Palestinian Territories","Egypt","Bulgaria","Sierra Leone","Cameroon","Iran","Albania","Bangladesh","Namibia","Kenya","Mozambique","Myanmar","Senegal","Zambia","Iraq","Gabon","Ethiopia","Sri Lanka","Armenia","India","Mauritania","Republic of Congo","Georgia","Democratic Republic of the Congo","Mali","Ivory Coast","Cambodia","Sudan","Ghana","Ukraine","Uganda","Burkina Faso","Niger","Malawi","Chad","Zimbabwe","Lesotho","Angola","Afghanistan","Botswana","Benin","Madagascar","Haiti","Yemen","South Sudan","Liberia","Guinea","Togo","Rwanda","Syria","Tanzania","Burundi","Central African Republic"],"y":[0.63542258739471402,0.62600672245025601,0.62716263532638505,0.62007057666778598,0.61795085668563798,0.58538448810577404,0.61110091209411599,0.61406213045120195,0.61292409896850597,0.60160738229751598,0.40598860383033802,0.58013164997100797,0.56776618957519498,0.50574052333831798,0.57311034202575695,0.56251138448715199,0.53977072238922097,0.59662789106368996,0.50819003582000699,0.37689527869224498,0.60834527015686002,0.43745374679565402,0.49094617366790799,0.494519203901291,0.41273000836372398,0.54984056949615501,0.58876705169677701,0.57939225435257002,0.53131061792373702,0.55002683401107799,0.47022211551666299,0.58020073175430298,0.36146658658981301,0.40878123044967701,0.60413098335266102,0.47748741507530201,0.44975057244300798,0.51863074302673295,0.49633759260177601,0.29581746459007302,0.53674691915512096,0.40226498246192899,0.44755184650421098,0.45519819855690002,0.43245252966880798,0.52034211158752397,0.65824866294860795,0.25645071268081698,0.37378311157226601,0.54750937223434404,0.50562554597854603,0.23423178493976601,0.23333580791950201,0.32570791244506803,0.25792166590690602,0.24072904884815199,0.45700374245643599,0.55873292684555098,0.41827192902565002,0.437454283237457,0.47120362520217901,0.57257580757141102,0.45000287890434298,0.49124732613563499,0.35511153936386097,0.479131430387497,0.29540026187896701,0.46573323011398299,0.30074059963226302,0.47350779175758401,0.49096864461898798,0.58521467447280895,0.20871552824974099,0.41842114925384499,0.17586351931095101,0.47430723905563399,0.25577229261398299,0.26028794050216703,0.47278770804405201,0.23521526157855999,0.44332346320152299,0.153997123241425,0.19498905539512601,0.40815833210945102,0.398155838251114,0.55258983373642001,0.095731250941753401,0.288515985012054,0.49846529960632302,0.204403176903725,0.34807986021041898,0.32590597867965698,0.60212695598602295,0.57105559110641502,0.39495256543159502,0.47156670689582803,0.50153768062591597,0.45494338870048501,0.44030594825744601,0.39414396882057201,0.479246735572815,0.28968068957328802,0.25471106171607999,0.282110154628754,0.289231717586517,0.31869769096374501,0.43038874864578203,0.24932260811328899,0.38149863481521601,0.47835665941238398,0.52030354738235496,0.45276376605033902,0.48079109191894498,0.51449203491210904,0.37792226672172502,0.46160349249839799,0.28855553269386303,0.31232857704162598,0.40884274244308499,0.56121325492858898,0.198303267359734,0.46998700499534601,0.096098043024539906,0.43502587080001798,0.30941003561019897,0.23596134781837499,0.30661374330520602,0.44770619273185702,0.63337582349777199,0.0149958552792668,0.423026293516159,0.122974775731564,0.443185955286026,0.32436785101890597,0.36365869641303999,0.46691465377807601,0.16234202682971999,0.336384207010269,0.39066129922866799,0,0.10617952048778501,0.505196332931519,0.42596277594566301,0.18919676542282099,0.030369857326149899,0.24946372210979501,0.14706243574619299,0.33288118243217502,0.34858751296997098,0.38042613863945002,0.58184385299682595,0.081539444625377697,0.39001777768135099,0.059900753200054203,0.270842045545578],"type":"bar","name":"2017","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Norway","Denmark","Iceland","Switzerland","Netherlands","Canada","New Zealand","Sweden","Australia","UK","Austria","Costa Rica","Ireland","Germany","Belgium","Luxembourg","USA","Israel","United Arab Emirates","Czech Republic","Malta","France","Mexico","Chile","Taiwan","Panama","Brazil","Argentina","Guatemala","Uruguay","Qatar","Saudi Arabia","Singapore","Malaysia","Spain","Colombia","Trinidad and Tobago","Slovakia","El Salvador","Nicaragua","Poland","Bahrain","Uzbekistan","Kuwait","Thailand","Italy","Ecuador","Belize","Lithuania","Slovenia","Romania","Latvia","Japan","Mauritius","Jamaica","South Korea","North Cyprus","Russia","Kazakhstan","Cyprus","Bolivia","Estonia","Paraguay","Peru","Kosovo","Moldova","Turkmenistan","Hungary","Libya","Philippines","Honduras","Belarus","Turkey","Pakistan","Hong Kong","Portugal","Serbia","Greece","Lebanon","Montenegro","Croatia","Dominican Republic","Algeria","Morocco","China","Azerbaijan","Tajikistan","Macedonia","Jordan","Nigeria","Kyrgyzstan","Bosnia and Herzegovina","Mongolia","Vietnam","Indonesia","Bhutan","Somalia","Cameroon","Bulgaria","Nepal","Venezuela","Gabon","Palestinian Territories","South Africa","Iran","Ivory Coast","Ghana","Senegal","Laos","Tunisia","Albania","Sierra Leone","Republic of Congo","Bangladesh","Sri Lanka","Iraq","Mali","Namibia","Cambodia","Burkina Faso","Egypt","Mozambique","Kenya","Zambia","Mauritania","Ethiopia","Georgia","Armenia","Myanmar","Chad","Democratic Republic of the Congo","India","Niger","Uganda","Benin","Sudan","Ukraine","Togo","Guinea","Lesotho","Angola","Madagascar","Zimbabwe","Afghanistan","Botswana","Malawi","Haiti","Liberia","Syria","Rwanda","Yemen","Tanzania","South Sudan","Central African Republic","Burundi"],"y":[0.68100000000000005,0.68600000000000005,0.68300000000000005,0.67700000000000005,0.66000000000000003,0.63800000000000001,0.65300000000000002,0.66900000000000004,0.65900000000000003,0.64700000000000002,0.46400000000000002,0.61699999999999999,0.63200000000000001,0.61399999999999999,0.58599999999999997,0.58299999999999996,0.63200000000000001,0.54700000000000004,0.53300000000000003,0.28399999999999997,0.54300000000000004,0.64500000000000002,0.52000000000000002,0.47899999999999998,0.43099999999999999,0.41799999999999998,0.59699999999999998,0.49299999999999999,0.56999999999999995,0.60399999999999998,0.625,0.65400000000000003,0.50900000000000001,0.63100000000000001,0.35599999999999998,0.44900000000000001,0.53100000000000003,0.57499999999999996,0.35399999999999998,0.46100000000000002,0.52700000000000002,0.54600000000000004,0.59399999999999997,0.72399999999999998,0.55400000000000005,0.63700000000000001,0.28100000000000003,0.55600000000000005,0.59299999999999997,0.34999999999999998,0.63300000000000001,0.52800000000000002,0.36299999999999999,0.55300000000000005,0.58399999999999996,0.57499999999999996,0.24399999999999999,0.495,0.39900000000000002,0.45400000000000001,0.42299999999999999,0.60599999999999998,0.55300000000000005,0.54100000000000004,0.53000000000000003,0.44800000000000001,0.23200000000000001,0.41699999999999998,0.25900000000000001,0.496,0.64300000000000002,0.45900000000000002,0.307,0.32400000000000001,0.33400000000000002,0.52400000000000002,0.56200000000000006,0.28799999999999998,0.13100000000000001,0.503,0.25900000000000001,0.38,0.57799999999999996,0.076999999999999999,0.46000000000000002,0.59699999999999998,0.42999999999999999,0.29199999999999998,0.39400000000000002,0.46800000000000003,0.46200000000000002,0.54000000000000004,0.28000000000000003,0.39500000000000002,0.61799999999999999,0.53800000000000003,0.54100000000000004,0.67400000000000004,0.45400000000000001,0.35899999999999999,0.52600000000000002,0.13300000000000001,0.35599999999999998,0.26600000000000001,0.51600000000000001,0.45900000000000002,0.46700000000000003,0.499,0.40600000000000003,0.626,0.27100000000000002,0.41899999999999998,0.35499999999999998,0.51400000000000001,0.57999999999999996,0.58499999999999996,0.30399999999999999,0.36699999999999999,0.51900000000000002,0.69599999999999995,0.312,0.312,0.53100000000000003,0.504,0.503,0.129,0.45200000000000001,0.375,0.26000000000000001,0.57999999999999996,0.189,0.312,0.53900000000000003,0.39000000000000001,0.45000000000000001,0.44,0.016,0.16300000000000001,0.434,0.39400000000000002,0.42299999999999999,0,0.221,0.40600000000000003,0.085000000000000006,0.55700000000000005,0.53100000000000003,0.025000000000000001,0.41899999999999998,0.087999999999999995,0.63600000000000001,0.24399999999999999,0.48099999999999998,0.112,0.30499999999999999,0.065000000000000002],"type":"bar","name":"2018","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Denmark","Norway","Iceland","Netherlands","Switzerland","Sweden","New Zealand","Canada","Austria","Australia","Costa Rica","Israel","Luxembourg","UK","Ireland","Germany","Belgium","USA","Czech Republic","United Arab Emirates","Malta","Mexico","France","Taiwan","Chile","Guatemala","Saudi Arabia","Qatar","Spain","Panama","Brazil","Uruguay","Singapore","El Salvador","Italy","Bahrain","Slovakia","Trinidad and Tobago","Poland","Uzbekistan","Lithuania","Colombia","Slovenia","Nicaragua","Kosovo","Argentina","Romania","Cyprus","Ecuador","Kuwait","Thailand","Latvia","South Korea","Estonia","Jamaica","Mauritius","Japan","Honduras","Kazakhstan","Bolivia","Hungary","Paraguay","North Cyprus","Peru","Portugal","Pakistan","Russia","Philippines","Serbia","Moldova","Libya","Montenegro","Tajikistan","Croatia","Hong Kong","Dominican Republic","Bosnia and Herzegovina","Turkey","Malaysia","Belarus","Greece","Mongolia","North Macedonia","Nigeria","Kyrgyzstan","Turkmenistan","Algeria","Morocco","Azerbaijan","Lebanon","Indonesia","China","Vietnam","Bhutan","Cameroon","Bulgaria","Ghana","Ivory Coast","Nepal","Jordan","Benin","Republic of Congo","Gabon","Laos","South Africa","Albania","Venezuela","Cambodia","Palestinian Territories","Senegal","Somalia","Namibia","Niger","Burkina Faso","Armenia","Iran","Guinea","Georgia","Gambia","Kenya","Mauritania","Mozambique","Tunisia","Bangladesh","Iraq","Democratic Republic of the Congo","Mali","Sierra Leone","Sri Lanka","Myanmar","Chad","Ukraine","Ethiopia","Swaziland","Uganda","Egypt","Zambia","Togo","India","Liberia","Comoros","Madagascar","Lesotho","Burundi","Zimbabwe","Haiti","Botswana","Syria","Malawi","Yemen","Rwanda","Tanzania","Afghanistan","Central African Republic","South Sudan"],"y":[0.59599999999999997,0.59199999999999997,0.60299999999999998,0.59099999999999997,0.55700000000000005,0.57199999999999995,0.57399999999999995,0.58499999999999996,0.58399999999999996,0.53200000000000003,0.55700000000000005,0.55800000000000005,0.371,0.52600000000000002,0.45000000000000001,0.51600000000000001,0.495,0.47299999999999998,0.45400000000000001,0.45700000000000002,0.59799999999999998,0.56399999999999995,0.433,0.436,0.35099999999999998,0.35699999999999998,0.53500000000000003,0.439,0.55500000000000005,0.36199999999999999,0.51600000000000001,0.39000000000000001,0.52300000000000002,0.55600000000000005,0.42999999999999999,0.23100000000000001,0.53600000000000003,0.33400000000000002,0.48899999999999999,0.48299999999999998,0.63100000000000001,0.29099999999999998,0.46999999999999997,0.56399999999999995,0.435,0.48899999999999999,0.47099999999999997,0.46200000000000002,0.40600000000000003,0.498,0.49299999999999999,0.55700000000000005,0.26400000000000001,0.159,0.495,0.48999999999999999,0.498,0.44500000000000001,0.50700000000000001,0.40999999999999998,0.51100000000000001,0.19900000000000001,0.51400000000000001,0.41699999999999998,0.45500000000000002,0.50800000000000001,0.313,0.33400000000000002,0.55800000000000005,0.28199999999999997,0.245,0.41599999999999998,0.19700000000000001,0.38900000000000001,0.29599999999999999,0.44,0.497,0.21199999999999999,0.19500000000000001,0.50800000000000001,0.23499999999999999,0.067000000000000004,0.317,0.34499999999999997,0.42599999999999999,0.50800000000000001,0.39400000000000002,0.085999999999999993,0.41799999999999998,0.35099999999999998,0.216,0.49099999999999999,0.52100000000000002,0.54300000000000004,0.45700000000000002,0.38100000000000001,0.311,0.38100000000000001,0.35199999999999998,0.439,0.38300000000000001,0.34899999999999998,0.372,0.29499999999999998,0.54700000000000004,0.38900000000000001,0.38300000000000001,0.154,0.60899999999999999,0.22500000000000001,0.29199999999999998,0.55900000000000005,0.40100000000000002,0.318,0.255,0.28299999999999997,0.30499999999999999,0.33200000000000002,0.34599999999999997,0.38200000000000001,0.43099999999999999,0.066000000000000003,0.49399999999999999,0.16700000000000001,0.52700000000000002,0.24099999999999999,0.26900000000000002,0.32700000000000001,0.309,0.46999999999999997,0.52500000000000002,0.17399999999999999,0.17799999999999999,0.34399999999999997,0.313,0.35599999999999998,0.24099999999999999,0.43099999999999999,0.29299999999999998,0.498,0.37,0.14199999999999999,0.14799999999999999,0.35899999999999999,0.22,0.36099999999999999,0.025999999999999999,0.45500000000000002,0.012999999999999999,0.443,0.14299999999999999,0.55500000000000005,0.41699999999999998,0,0.22500000000000001,0.01],"type":"bar","name":"2019","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>At Region Level</strong></p>
<pre class="r"><code>hap_df |&gt;
  mutate(region = fct_reorder(region, freedom_to_make_life_choices))|&gt;
  group_by(region, year)|&gt;
  summarise(
    average_freedom = mean(freedom_to_make_life_choices, na.rm = TRUE)
  ) |&gt;
  plot_ly (
  x = ~region, y = ~average_freedom, color = ~year,
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;Freedom to Make Choice By Region&quot;,
    xaxis = list(title = &quot;Region&quot;),
    yaxis = list(title = &quot;Average Score&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-18d14daf860b73371db0" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-18d14daf860b73371db0">{"x":{"visdat":{"b30a41e5064a":["function () ","plotlyVisDat"]},"cur_data":"b30a41e5064a","attrs":{"b30a41e5064a":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Freedom to Make Choice By Region","xaxis":{"domain":[0,1],"automargin":true,"title":"Region","type":"category","categoryorder":"array","categoryarray":["Middle East and Northern Africa","Central and Eastern Europe","Sub-Saharan Africa","Eastern Asia","Southern Asia","Latin America and Caribbean","Southeastern Asia","North America","Western Europe","Australia and New Zealand"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Middle East and Northern Africa","Central and Eastern Europe","Sub-Saharan Africa","Eastern Asia","Southern Asia","Latin America and Caribbean","Southeastern Asia","North America","Western Europe","Australia and New Zealand"],"y":[0.36175099999999999,0.35826862068965515,0.36594399999999999,0.46249000000000001,0.37333714285714287,0.50173954545454547,0.5571044444444444,0.58950499999999995,0.54992619047619051,0.64531000000000005],"type":"bar","name":"2015","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Middle East and Northern Africa","Central and Eastern Europe","Sub-Saharan Africa","Eastern Asia","Southern Asia","Latin America and Caribbean","Southeastern Asia","North America","Western Europe","Australia and New Zealand"],"y":[0.30976894736842103,0.30052827586206898,0.31542421052631581,0.38728166666666669,0.35002571428571427,0.42664625,0.49012333333333336,0.52766500000000005,0.47758714285714288,0.5749200000000001],"type":"bar","name":"2016","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Middle East and Northern Africa","Central and Eastern Europe","Sub-Saharan Africa","Eastern Asia","Southern Asia","Latin America and Caribbean","Southeastern Asia","North America","Western Europe","Australia and New Zealand"],"y":[0.36376780310743728,0.34660915799182035,0.35410449016266143,0.41381901999314619,0.39897076146943228,0.44922169137068779,0.53497098386287689,0.55842071771621704,0.51512530268657764,0.60783475637435891],"type":"bar","name":"2017","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Middle East and Northern Africa","Central and Eastern Europe","Sub-Saharan Africa","Eastern Asia","Southern Asia","Latin America and Caribbean","Southeastern Asia","North America","Western Europe","Australia and New Zealand"],"y":[0.38947368421052631,0.39824137931034481,0.39448717948717948,0.45516666666666666,0.45571428571428574,0.50549999999999995,0.59166666666666667,0.60000000000000009,0.55647619047619046,0.65800000000000003],"type":"bar","name":"2018","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Middle East and Northern Africa","Central and Eastern Europe","Sub-Saharan Africa","Eastern Asia","Southern Asia","Latin America and Caribbean","Southeastern Asia","North America","Western Europe","Australia and New Zealand"],"y":[0.31794736842105265,0.35751724137931035,0.33734999999999998,0.37216666666666665,0.38628571428571429,0.44090476190476191,0.5437777777777778,0.51900000000000002,0.47942857142857143,0.57099999999999995],"type":"bar","name":"2019","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>Regional Trend</strong></p>
<pre class="r"><code>regional_hap_df |&gt;
  filter(factor == &quot;freedom_to_make_life_choices&quot;)|&gt;
  plot_ly(
      x = ~year, y = ~average_score, color = ~region,
      mode = &#39;lines+markers&#39;, type = &#39;scatter&#39;, colors = &#39;viridis&#39;,
      name = ~region) |&gt;
    layout(
      title = paste(&quot;Regional Trend for Freedom to Make Life Choices from 2015 to 2019&quot;),
      xaxis = list(title = &quot;Year&quot;),
      yaxis = list(title = &quot;Average Score&quot;),
      autosize = F, width = 820, height = 500
    )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f64f3f2b48d4aaca315e" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-f64f3f2b48d4aaca315e">{"x":{"visdat":{"b30a568e99b1":["function () ","plotlyVisDat"]},"cur_data":"b30a568e99b1","attrs":{"b30a568e99b1":{"x":{},"y":{},"mode":"lines+markers","name":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"width":820,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Regional Trend for Freedom to Make Life Choices from 2015 to 2019","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2015","2016","2017","2018","2019"],"y":[0.64531000000000005,0.5749200000000001,0.60783475637435891,0.65800000000000003,0.57099999999999995],"mode":"lines+markers","name":"Australia and New Zealand","type":"scatter","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.35826862068965515,0.30052827586206898,0.34660915799182035,0.39824137931034481,0.35751724137931035],"mode":"lines+markers","name":"Central and Eastern Europe","type":"scatter","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"line":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.46249000000000001,0.38728166666666669,0.41381901999314619,0.45516666666666666,0.37216666666666665],"mode":"lines+markers","name":"Eastern Asia","type":"scatter","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"line":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.50173954545454547,0.42664625,0.44922169137068779,0.50549999999999995,0.44090476190476191],"mode":"lines+markers","name":"Latin America and Caribbean","type":"scatter","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"line":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.36175099999999999,0.30976894736842103,0.36376780310743728,0.38947368421052631,0.31794736842105265],"mode":"lines+markers","name":"Middle East and Northern Africa","type":"scatter","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"line":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.58950499999999995,0.52766500000000005,0.55842071771621704,0.60000000000000009,0.51900000000000002],"mode":"lines+markers","name":"North America","type":"scatter","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"line":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.5571044444444444,0.49012333333333336,0.53497098386287689,0.59166666666666667,0.5437777777777778],"mode":"lines+markers","name":"Southeastern Asia","type":"scatter","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"line":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.37333714285714287,0.35002571428571427,0.39897076146943228,0.45571428571428574,0.38628571428571429],"mode":"lines+markers","name":"Southern Asia","type":"scatter","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"line":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.36594399999999999,0.31542421052631581,0.35410449016266143,0.39448717948717948,0.33734999999999998],"mode":"lines+markers","name":"Sub-Saharan Africa","type":"scatter","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"line":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.54992619047619051,0.47758714285714288,0.51512530268657764,0.55647619047619046,0.47942857142857143],"mode":"lines+markers","name":"Western Europe","type":"scatter","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>At <em>countries level</em>, from 2015 to 2019, Norway and Uzbekistan
has the highest freedom score. Norway, Uzbekistan, Iceland, Finland,
Switzerland are the top 5 countries with the highest score. Angola,
Sudan, Haiti, Burundi, and Greece are the bottom 5 countries with the
lowest freedom scores.</p>
<p>At <em>regional level</em>, from 2015 to 2019, Australia and New
Zealand has the highest freedom score and Middle East and Northern
Africa has the lowest. The trend between 10 regions is relatively
similar.</p>
</div>
<div id="perception-of-corruption" class="section level3">
<h3>Perception of Corruption</h3>
<p><strong>At Country Level</strong></p>
<pre class="r"><code>hap_df |&gt;
  mutate(country = fct_reorder(country, perception_of_corruption))|&gt;
  plot_ly (
  x = ~country, y = ~perception_of_corruption, color = ~year,
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;Perception of Corruption&quot;,
    xaxis = list(
      title = &quot;country&quot;,
      tickfont = list(size = 6)
      ),
    yaxis = list(title = &quot;Score&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4f9c462618c7ae27ac23" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-4f9c462618c7ae27ac23">{"x":{"visdat":{"b30a60697b1b":["function () ","plotlyVisDat"]},"cur_data":"b30a60697b1b","attrs":{"b30a60697b1b":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Perception of Corruption","xaxis":{"domain":[0,1],"automargin":true,"title":"country","tickfont":{"size":6},"type":"category","categoryorder":"array","categoryarray":["Bosnia and Herzegovina","Romania","Bulgaria","Moldova","Lithuania","Trinidad and Tobago","Indonesia","Portugal","Ukraine","Slovakia","Hungary","China","Italy","Thailand","Jamaica","Russia","Nigeria","Ghana","Mongolia","North Macedonia","Czech Republic","Armenia","Lebanon","Liberia","Croatia","Kyrgyzstan","Albania","Serbia","Cyprus","Greece","Slovenia","Colombia","Peru","Central African Republic","Kosovo","Cameroon","Mauritius","Chad","Poland","Macedonia","Kenya","Iran","Argentina","Democratic Republic of the Congo","Uganda","Afghanistan","South Korea","Tunisia","Bolivia","Yemen","Venezuela","Malaysia","Latvia","Tanzania","Benin","Madagascar","Cambodia","Angola","Spain","Panama","Sierra Leone","South Africa","Nepal","Honduras","Sri Lanka","Malawi","Gabon","Guatemala","Taiwan","Namibia","Paraguay","Chile","Swaziland","Morocco","Israel","Zambia","India","Vietnam","Montenegro","Zimbabwe","Palestinian Territories","El Salvador","Republic of Congo","Burundi","Sudan","Belize","Botswana","Costa Rica","Togo","Egypt","Mali","Philippines","Senegal","Iraq","Turkey","Haiti","Libya","Guinea","Brazil","Kazakhstan","South Sudan","Pakistan","Dominican Republic","Lesotho","Puerto Rico","Burkina Faso","Bangladesh","Ivory Coast","Nicaragua","Suriname","Mexico","Jordan","USA","Mauritania","Niger","Ecuador","Iceland","Tajikistan","Algeria","Ethiopia","Malta","Syria","North Cyprus","Belarus","Mozambique","Japan","Bhutan","Gambia","Estonia","Uruguay","France","Azerbaijan","Comoros","Myanmar","Laos","Kuwait","Austria","Belgium","Georgia","Bahrain","Uzbekistan","Turkmenistan","Saudi Arabia","UK","Germany","Djibouti","Somalia","Hong Kong","Netherlands","Ireland","Australia","Canada","Luxembourg","Oman","United Arab Emirates","Norway","Switzerland","Somaliland Region","Sweden","New Zealand","Finland","Denmark","Qatar","Rwanda","Singapore"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Switzerland","Iceland","Denmark","Norway","Canada","Finland","Netherlands","Sweden","New Zealand","Australia","Israel","Costa Rica","Austria","Mexico","USA","Brazil","Luxembourg","Ireland","Belgium","United Arab Emirates","UK","Oman","Venezuela","Singapore","Panama","Germany","Chile","Qatar","France","Argentina","Czech Republic","Uruguay","Colombia","Thailand","Saudi Arabia","Spain","Malta","Taiwan","Kuwait","Suriname","Trinidad and Tobago","El Salvador","Guatemala","Uzbekistan","Slovakia","Japan","South Korea","Ecuador","Bahrain","Italy","Bolivia","Moldova","Paraguay","Kazakhstan","Slovenia","Lithuania","Nicaragua","Peru","Belarus","Poland","Malaysia","Croatia","Libya","Russia","Jamaica","North Cyprus","Cyprus","Algeria","Kosovo","Turkmenistan","Mauritius","Hong Kong","Estonia","Indonesia","Vietnam","Turkey","Kyrgyzstan","Nigeria","Bhutan","Azerbaijan","Pakistan","Jordan","Montenegro","China","Zambia","Romania","Serbia","Portugal","Latvia","Philippines","Somalia","Morocco","Macedonia","Mozambique","Albania","Bosnia and Herzegovina","Lesotho","Dominican Republic","Laos","Mongolia","Swaziland","Greece","Lebanon","Hungary","Honduras","Tajikistan","Tunisia","Palestinian Territories","Bangladesh","Iran","Ukraine","Iraq","South Africa","Ghana","Zimbabwe","Liberia","India","Sudan","Haiti","Democratic Republic of the Congo","Nepal","Ethiopia","Sierra Leone","Mauritania","Kenya","Djibouti","Armenia","Botswana","Myanmar","Georgia","Malawi","Sri Lanka","Cameroon","Bulgaria","Egypt","Yemen","Angola","Mali","Republic of Congo","Comoros","Uganda","Senegal","Gabon","Niger","Cambodia","Tanzania","Madagascar","Central African Republic","Chad","Guinea","Ivory Coast","Burkina Faso","Afghanistan","Rwanda","Benin","Syria","Burundi","Togo"],"y":[0.41977999999999999,0.14144999999999999,0.48357,0.36503000000000002,0.32956999999999997,0.41371999999999998,0.31813999999999998,0.43844,0.42921999999999999,0.35637000000000002,0.077850000000000003,0.10582999999999999,0.18676000000000001,0.21312,0.15890000000000001,0.17521,0.37797999999999998,0.28703000000000001,0.22539999999999999,0.38583000000000001,0.32067000000000001,0.32523999999999997,0.11069,0.49209999999999998,0.092700000000000005,0.21843000000000001,0.12869,0.52207999999999999,0.20646,0.084839999999999999,0.026519999999999998,0.24557999999999999,0.051200000000000002,0.031870000000000002,0.32523999999999997,0.063979999999999995,0.13586000000000001,0.081290000000000001,0.25608999999999998,0.13633000000000001,0.0114,0.11776,0.094719999999999999,0.30825999999999998,0.03431,0.18060000000000001,0.078570000000000001,0.18090000000000001,0.30599999999999999,0.029010000000000001,0.087999999999999995,0.016150000000000001,0.082419999999999993,0.084540000000000004,0.037870000000000001,0.01031,0.19317000000000001,0.059889999999999999,0.19089999999999999,0.042119999999999998,0.10501000000000001,0.024299999999999999,0.11022999999999999,0.03005,0.02299,0.14280000000000001,0.061460000000000001,0.17383000000000001,0.047410000000000001,0.30843999999999999,0.075209999999999999,0.37124000000000001,0.15184,0,0.10441,0.15745999999999999,0.042320000000000003,0.040300000000000002,0.15445,0.16064999999999999,0.10464,0.14293,0.14296,0.027810000000000001,0.12468,0.0064900000000000001,0.026169999999999999,0.01078,0.063320000000000001,0.12279,0.39928000000000002,0.085459999999999994,0.053269999999999998,0.15603,0.064130000000000006,0.0022699999999999999,0.12504000000000001,0.14233999999999999,0.24249000000000001,0.02666,0.030599999999999999,0.01397,0.04582,0.02758,0.068250000000000005,0.15071999999999999,0.063579999999999998,0.12905,0.12569,0.058630000000000002,0.029610000000000001,0.13788,0.088840000000000002,0.043549999999999998,0.080790000000000001,0.06232,0.084919999999999995,0.14660000000000001,0.17175000000000001,0.076249999999999998,0.059069999999999998,0.15048,0.087859999999999994,0.17460999999999999,0.058389999999999997,0.28105000000000002,0.039,0.12474,0.19034000000000001,0.38330999999999998,0.069769999999999999,0.091789999999999997,0.057860000000000002,0.0087200000000000003,0.063240000000000005,0.078539999999999999,0.071220000000000006,0.12352,0.11686000000000001,0.19900000000000001,0.072669999999999998,0.10713,0.11090999999999999,0.15639,0.072470000000000007,0.05747,0.081240000000000007,0.082890000000000005,0.052690000000000001,0.12139,0.17921999999999999,0.12831999999999999,0.097189999999999999,0.55191000000000001,0.080100000000000005,0.18906000000000001,0.10062,0.10731],"type":"bar","name":"2015","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Denmark","Switzerland","Iceland","Norway","Finland","Canada","Netherlands","New Zealand","Australia","Sweden","Israel","Austria","USA","Costa Rica","Puerto Rico","Germany","Brazil","Belgium","Ireland","Luxembourg","Mexico","Singapore","UK","Chile","Panama","Argentina","Czech Republic","United Arab Emirates","Uruguay","Malta","Colombia","France","Thailand","Saudi Arabia","Taiwan","Qatar","Spain","Algeria","Guatemala","Suriname","Kuwait","Bahrain","Trinidad and Tobago","Venezuela","Slovakia","El Salvador","Malaysia","Nicaragua","Uzbekistan","Italy","Ecuador","Belize","Japan","Kazakhstan","Moldova","Russia","Poland","South Korea","Bolivia","Lithuania","Belarus","North Cyprus","Slovenia","Peru","Turkmenistan","Mauritius","Libya","Latvia","Cyprus","Paraguay","Romania","Estonia","Jamaica","Croatia","Hong Kong","Somalia","Kosovo","Turkey","Indonesia","Jordan","Azerbaijan","Philippines","China","Bhutan","Kyrgyzstan","Serbia","Bosnia and Herzegovina","Montenegro","Dominican Republic","Morocco","Hungary","Pakistan","Lebanon","Portugal","Macedonia","Vietnam","Somaliland Region","Tunisia","Greece","Tajikistan","Mongolia","Laos","Nigeria","Honduras","Iran","Zambia","Nepal","Palestinian Territories","Albania","Bangladesh","Sierra Leone","Iraq","Namibia","Cameroon","Ethiopia","South Africa","Sri Lanka","India","Myanmar","Egypt","Armenia","Kenya","Ukraine","Ghana","Democratic Republic of the Congo","Georgia","Republic of Congo","Senegal","Bulgaria","Mauritania","Zimbabwe","Malawi","Sudan","Gabon","Mali","Haiti","Botswana","Comoros","Ivory Coast","Cambodia","Angola","Niger","South Sudan","Chad","Burkina Faso","Uganda","Yemen","Madagascar","Tanzania","Liberia","Guinea","Rwanda","Benin","Afghanistan","Togo","Syria","Burundi"],"y":[0.44452999999999998,0.41203000000000001,0.14974999999999999,0.35776000000000002,0.41004000000000002,0.31329000000000001,0.29926999999999998,0.41904000000000002,0.32330999999999999,0.40866999999999998,0.087279999999999996,0.21348,0.14868000000000001,0.10546999999999999,0.12275,0.28550999999999999,0.14166000000000001,0.26247999999999999,0.29754000000000003,0.35328999999999999,0.18354999999999999,0.46987000000000001,0.27399000000000001,0.11451,0.084229999999999999,0.072959999999999997,0.03986,0.35560999999999998,0.21393999999999999,0.17554,0.053990000000000003,0.17807999999999999,0.028330000000000001,0.30008000000000001,0.066299999999999998,0.48048999999999997,0.061370000000000001,0.16156999999999999,0.087010000000000004,0.12692000000000001,0.23669000000000001,0.25772,0.012409999999999999,0.083040000000000003,0.02947,0.10613,0.090810000000000002,0.16292000000000001,0.28333000000000003,0.025559999999999999,0.18037,0.10771,0.18984999999999999,0.11132,0.019029999999999998,0.035860000000000003,0.055,0.077160000000000006,0.077460000000000001,0.018200000000000001,0.17457,0.16578000000000001,0.03635,0.052920000000000002,0.28466999999999998,0.05203,0.10339,0.088900000000000007,0.05228,0.073959999999999998,0.00679,0.18518999999999999,0.042939999999999999,0.04002,0.31646999999999997,0.31180000000000002,0.06547,0.12348000000000001,0.0032200000000000002,0.13297,0.17913999999999999,0.11756999999999999,0.027449999999999999,0.16159999999999999,0.047620000000000003,0.043389999999999998,0,0.12720999999999999,0.12372,0.084040000000000004,0.044720000000000003,0.13880000000000001,0.030609999999999998,0.01521,0.070470000000000005,0.11556,0.36793999999999999,0.081699999999999995,0.041270000000000001,0.13508999999999999,0.032849999999999997,0.22423000000000001,0.030499999999999999,0.069059999999999996,0.0557,0.11479,0.070080000000000003,0.10613,0.053010000000000002,0.12583,0.081960000000000005,0.13636000000000001,0.10398,0.061260000000000002,0.17169999999999999,0.084150000000000003,0.079640000000000002,0.087220000000000006,0.20243,0.10392999999999999,0.036159999999999998,0.066860000000000003,0.018290000000000001,0.032599999999999997,0.060749999999999998,0.31879999999999997,0.097530000000000006,0.11681,0.0061500000000000001,0.17954999999999999,0.085819999999999994,0.075639999999999999,0.10038999999999999,0.093140000000000001,0.13647000000000001,0.14476,0.10768999999999999,0.18437000000000001,0.15529999999999999,0.080920000000000006,0.084339999999999998,0.17176,0.13014999999999999,0.049520000000000002,0.12533,0.064420000000000005,0.05892,0.075060000000000002,0.050990000000000001,0.048520000000000001,0.1192,0.50521000000000005,0.066809999999999994,0.071120000000000003,0.11587,0.17233000000000001,0.094189999999999996],"type":"bar","name":"2016","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Norway","Denmark","Iceland","Switzerland","Finland","Netherlands","Canada","New Zealand","Sweden","Australia","Israel","Costa Rica","Austria","USA","Ireland","Germany","Belgium","Luxembourg","UK","Chile","United Arab Emirates","Brazil","Czech Republic","Argentina","Mexico","Singapore","Malta","Uruguay","Guatemala","Panama","France","Thailand","Taiwan","Spain","Qatar","Colombia","Saudi Arabia","Trinidad and Tobago","Kuwait","Slovakia","Bahrain","Malaysia","Nicaragua","Ecuador","El Salvador","Poland","Uzbekistan","Italy","Russia","Belize","Japan","Lithuania","Algeria","Latvia","South Korea","Moldova","Romania","Bolivia","Turkmenistan","Kazakhstan","North Cyprus","Slovenia","Peru","Mauritius","Cyprus","Estonia","Belarus","Libya","Turkey","Paraguay","Hong Kong","Philippines","Serbia","Jordan","Hungary","Jamaica","Croatia","Kosovo","China","Pakistan","Indonesia","Venezuela","Montenegro","Morocco","Azerbaijan","Dominican Republic","Greece","Lebanon","Portugal","Bosnia and Herzegovina","Honduras","Macedonia","Somalia","Vietnam","Nigeria","Tajikistan","Bhutan","Kyrgyzstan","Nepal","Mongolia","South Africa","Tunisia","Palestinian Territories","Egypt","Bulgaria","Sierra Leone","Cameroon","Iran","Albania","Bangladesh","Namibia","Kenya","Mozambique","Myanmar","Senegal","Zambia","Iraq","Gabon","Ethiopia","Sri Lanka","Armenia","India","Mauritania","Republic of Congo","Georgia","Democratic Republic of the Congo","Mali","Ivory Coast","Cambodia","Sudan","Ghana","Ukraine","Uganda","Burkina Faso","Niger","Malawi","Chad","Zimbabwe","Lesotho","Angola","Afghanistan","Botswana","Benin","Madagascar","Haiti","Yemen","South Sudan","Liberia","Guinea","Togo","Rwanda","Syria","Tanzania","Burundi","Central African Republic"],"y":[0.315963834524155,0.40077006816864003,0.15352655947208399,0.367007285356522,0.38261154294013999,0.28266182541847201,0.287371516227722,0.382816702127457,0.38439872860908503,0.30118373036384599,0.085242100059986101,0.100106589496136,0.221060365438461,0.135638788342476,0.29838815331459001,0.276731938123703,0.25134313106536899,0.31883442401885997,0.265428066253662,0.082287982106208801,0.32448956370353699,0.111092761158943,0.036872927099466303,0.059739887714386,0.13277411460876501,0.46430778503418002,0.15306606888771099,0.178061872720718,0.0772232785820961,0.070983923971652998,0.17250242829322801,0.0316127352416515,0.063829235732555403,0.070914097130298601,0.439299255609512,0.046668741852045101,0.27343225479125999,0.0089648161083459906,0.21515955030918099,0.024210851639509201,0.25704216957092302,0.065600708127021803,0.130687981843948,0.140134647488594,0.089980959892272894,0.059307806193828597,0.24652822315692899,0.028028091415762901,0.032962881028652198,0.096581071615219102,0.163760736584663,0.0118656428530812,0.14609611034393299,0.073842726647853907,0.063282668590545696,0.0100912861526012,0.0043879006989300303,0.060477726161479901,0.259270340204239,0.119282886385918,0.15535335242748299,0.045128978788852699,0.047049086540937403,0.042181555181741701,0.041237976402044303,0.183248922228813,0.156313821673393,0.092610210180282607,0.099671579897403703,0.091065913438796997,0.29393374919891402,0.099331893026828794,0.040903780609369299,0.11980327218771,0.0366369374096394,0.055267781019210802,0.043103110045194598,0.057471618056297302,0.022794274613261199,0.124348066747189,0.015317135490477101,0.064491122961044298,0.088174194097518893,0.087763182818889604,0.18098750710487399,0.113945253193378,0.043289776891469997,0.037513829767704003,0.015869451686739901,0,0.073345452547073406,0.060277793556451797,0.28241032361984297,0.087633237242698697,0.0261215660721064,0.14637714624404899,0.17338038980960799,0.039439179003238699,0.072975546121597304,0.032902289181947701,0.072509497404098497,0.086723148822784396,0.089282602071762099,0.114381365478039,0.011051530949771401,0.071095176041126307,0.051306631416082403,0.048761073499917998,0.039864215999841697,0.123717859387398,0.093146972358226804,0.064641319215297699,0.179436385631561,0.18881620466709101,0.115460447967052,0.078213550150394398,0.10721575468778601,0.076046787202358204,0.16545571386814101,0.0736539661884308,0.0266744215041399,0.0922268852591515,0.13695700466632801,0.079618133604526506,0.25166663527488697,0.0602413564920425,0.10497024655342101,0.130061775445938,0.068105950951576205,0.089847519993782002,0.025336369872093201,0.023029470816254598,0.057069718837738002,0.120328105986118,0.13857294619083399,0.072711654007434803,0.053581882268190398,0.095375381410121904,0.11909464001655599,0.069720335304737105,0.061157830059528399,0.098583199083805098,0.060929015278816202,0.067231975495815305,0.099872149527072906,0.0567674227058887,0.116793513298035,0.038948249071836499,0.110937617719173,0.095665015280246707,0.45522001385688798,0.151347130537033,0.066035106778144795,0.084147945046424893,0.056565076112747199],"type":"bar","name":"2017","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Norway","Denmark","Iceland","Switzerland","Netherlands","Canada","New Zealand","Sweden","Australia","UK","Austria","Costa Rica","Ireland","Germany","Belgium","Luxembourg","USA","Israel","Czech Republic","Malta","France","Mexico","Chile","Taiwan","Panama","Brazil","Argentina","Guatemala","Uruguay","Qatar","Saudi Arabia","Singapore","Malaysia","Spain","Colombia","Trinidad and Tobago","Slovakia","El Salvador","Nicaragua","Poland","Bahrain","Uzbekistan","Kuwait","Thailand","Italy","Ecuador","Belize","Lithuania","Slovenia","Romania","Latvia","Japan","Mauritius","Jamaica","South Korea","North Cyprus","Russia","Kazakhstan","Cyprus","Bolivia","Estonia","Paraguay","Peru","Kosovo","Moldova","Turkmenistan","Hungary","Libya","Philippines","Honduras","Belarus","Turkey","Pakistan","Hong Kong","Portugal","Serbia","Greece","Lebanon","Montenegro","Croatia","Dominican Republic","Algeria","Morocco","China","Azerbaijan","Tajikistan","Macedonia","Jordan","Nigeria","Kyrgyzstan","Bosnia and Herzegovina","Mongolia","Vietnam","Indonesia","Bhutan","Somalia","Cameroon","Bulgaria","Nepal","Venezuela","Gabon","Palestinian Territories","South Africa","Iran","Ivory Coast","Ghana","Senegal","Laos","Tunisia","Albania","Sierra Leone","Republic of Congo","Bangladesh","Sri Lanka","Iraq","Mali","Namibia","Cambodia","Burkina Faso","Egypt","Mozambique","Kenya","Zambia","Mauritania","Ethiopia","Georgia","Armenia","Myanmar","Chad","Democratic Republic of the Congo","India","Niger","Uganda","Benin","Sudan","Ukraine","Togo","Guinea","Lesotho","Angola","Madagascar","Zimbabwe","Afghanistan","Botswana","Malawi","Haiti","Liberia","Syria","Rwanda","Yemen","Tanzania","South Sudan","Central African Republic","Burundi"],"y":[0.39300000000000002,0.34000000000000002,0.40799999999999997,0.13800000000000001,0.35699999999999998,0.29499999999999998,0.29099999999999998,0.38900000000000001,0.38300000000000001,0.30199999999999999,0.082000000000000003,0.224,0.10100000000000001,0.30599999999999999,0.28000000000000003,0.23999999999999999,0.32100000000000001,0.13300000000000001,0.27200000000000002,0.034000000000000002,0.14199999999999999,0.17599999999999999,0.095000000000000001,0.060999999999999999,0.078,0.063,0.087999999999999995,0.053999999999999999,0.070999999999999994,0.155,0.17100000000000001,0.127,0.45700000000000002,0.058999999999999997,0.073999999999999996,0.039,0.019,0.014,0.082000000000000003,0.128,0.064000000000000001,0.123,0.25900000000000001,0.106,0.029000000000000001,0.028000000000000001,0.12,0.088999999999999996,0.0060000000000000001,0.050999999999999997,0.001,0.066000000000000003,0.14999999999999999,0.050000000000000003,0.031,0.050999999999999997,0.154,0.025000000000000001,0.121,0.035000000000000003,0.053999999999999999,0.17399999999999999,0.073999999999999996,0.034000000000000002,0.023,0,0.036999999999999998,0.021999999999999999,0.14799999999999999,0.105,0.073999999999999996,0.154,0.109,0.113,0.29099999999999998,0.017000000000000001,0.042999999999999997,0.043999999999999997,0.13600000000000001,0.081000000000000003,0.039,0.106,0.13500000000000001,0.073999999999999996,0.10299999999999999,0.17599999999999999,0.034000000000000002,0.051999999999999998,0.13400000000000001,0.032000000000000001,0.035000000000000003,0,0.032000000000000001,0.079000000000000001,0.017999999999999999,0.17100000000000001,0.28199999999999997,0.042999999999999997,0.0089999999999999993,0.078,0.051999999999999998,0.051999999999999998,0.075999999999999998,0.056000000000000001,0.129,0.10299999999999999,0.029000000000000001,0.082000000000000003,0.17399999999999999,0.063,0.032000000000000001,0.052999999999999999,0.076999999999999999,0.14399999999999999,0.050000000000000003,0.095000000000000001,0.056000000000000001,0.064000000000000001,0.065000000000000002,0.128,0.107,0.158,0.055,0.082000000000000003,0.092999999999999999,0.14599999999999999,0.215,0.028000000000000001,0.17799999999999999,0.059999999999999998,0.051999999999999998,0.092999999999999999,0.099000000000000005,0.060999999999999999,0.067000000000000004,0.082000000000000003,0.010999999999999999,0.10100000000000001,0.094,0.112,0.060999999999999999,0.049000000000000002,0.099000000000000005,0.035999999999999997,0.091999999999999998,0.080000000000000002,0.104,0.029999999999999999,0.14399999999999999,0.44400000000000001,0.064000000000000001,0.097000000000000003,0.106,0.037999999999999999,0.075999999999999998],"type":"bar","name":"2018","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Denmark","Norway","Iceland","Netherlands","Switzerland","Sweden","New Zealand","Canada","Austria","Australia","Costa Rica","Israel","Luxembourg","UK","Ireland","Germany","Belgium","USA","Czech Republic","United Arab Emirates","Malta","Mexico","France","Taiwan","Chile","Guatemala","Saudi Arabia","Qatar","Spain","Panama","Brazil","Uruguay","Singapore","El Salvador","Italy","Bahrain","Slovakia","Trinidad and Tobago","Poland","Uzbekistan","Lithuania","Colombia","Slovenia","Nicaragua","Kosovo","Argentina","Romania","Cyprus","Ecuador","Kuwait","Thailand","Latvia","South Korea","Estonia","Jamaica","Mauritius","Japan","Honduras","Kazakhstan","Bolivia","Hungary","Paraguay","North Cyprus","Peru","Portugal","Pakistan","Russia","Philippines","Serbia","Moldova","Libya","Montenegro","Tajikistan","Croatia","Hong Kong","Dominican Republic","Bosnia and Herzegovina","Turkey","Malaysia","Belarus","Greece","Mongolia","North Macedonia","Nigeria","Kyrgyzstan","Turkmenistan","Algeria","Morocco","Azerbaijan","Lebanon","Indonesia","China","Vietnam","Bhutan","Cameroon","Bulgaria","Ghana","Ivory Coast","Nepal","Jordan","Benin","Republic of Congo","Gabon","Laos","South Africa","Albania","Venezuela","Cambodia","Palestinian Territories","Senegal","Somalia","Namibia","Niger","Burkina Faso","Armenia","Iran","Guinea","Georgia","Gambia","Kenya","Mauritania","Mozambique","Tunisia","Bangladesh","Iraq","Democratic Republic of the Congo","Mali","Sierra Leone","Sri Lanka","Myanmar","Chad","Ukraine","Ethiopia","Swaziland","Uganda","Egypt","Zambia","Togo","India","Liberia","Comoros","Madagascar","Lesotho","Burundi","Zimbabwe","Haiti","Botswana","Syria","Malawi","Yemen","Rwanda","Tanzania","Afghanistan","Central African Republic","South Sudan"],"y":[0.39300000000000002,0.40999999999999998,0.34100000000000003,0.11799999999999999,0.29799999999999999,0.34300000000000003,0.373,0.38,0.308,0.22600000000000001,0.28999999999999998,0.092999999999999999,0.082000000000000003,0.316,0.27800000000000002,0.31,0.26500000000000001,0.20999999999999999,0.128,0.035999999999999997,0.182,0.151,0.072999999999999995,0.183,0.097000000000000003,0.056000000000000001,0.078,0.13200000000000001,0.16700000000000001,0.079000000000000001,0.053999999999999999,0.085999999999999993,0.14999999999999999,0.45300000000000001,0.073999999999999996,0.029999999999999999,0.11,0.014,0.016,0.050000000000000003,0.23999999999999999,0.042000000000000003,0.034000000000000002,0.057000000000000002,0.127,0.0060000000000000001,0.050000000000000003,0.0050000000000000001,0.041000000000000002,0.086999999999999994,0.097000000000000003,0.028000000000000001,0.064000000000000001,0.056000000000000001,0.161,0.028000000000000001,0.059999999999999998,0.14000000000000001,0.078,0.096000000000000002,0.064000000000000001,0.02,0.080000000000000002,0.16200000000000001,0.027,0.025000000000000001,0.098000000000000004,0.031,0.107,0.039,0,0.152,0.080000000000000002,0.14399999999999999,0.021999999999999999,0.28699999999999998,0.10100000000000001,0.0060000000000000001,0.106,0.024,0.14199999999999999,0.034000000000000002,0.037999999999999999,0.034000000000000002,0.041000000000000002,0.023,0.028000000000000001,0.114,0.075999999999999998,0.182,0.027,0.028000000000000001,0.10000000000000001,0.072999999999999995,0.16700000000000001,0.036999999999999998,0.0040000000000000001,0.040000000000000001,0.089999999999999997,0.088999999999999996,0.13,0.082000000000000003,0.092999999999999999,0.055,0.16400000000000001,0.055,0.027,0.047,0.062,0.066000000000000003,0.071999999999999995,0.27000000000000002,0.056000000000000001,0.10199999999999999,0.113,0.064000000000000001,0.125,0.085999999999999993,0.16400000000000001,0.16700000000000001,0.052999999999999999,0.087999999999999995,0.13800000000000001,0.055,0.14299999999999999,0.088999999999999996,0.052999999999999999,0.051999999999999998,0.044999999999999998,0.047,0.17199999999999999,0.078,0.01,0.10000000000000001,0.13500000000000001,0.059999999999999998,0.067000000000000004,0.086999999999999994,0.085000000000000006,0.085000000000000006,0.033000000000000002,0.078,0.041000000000000002,0.092999999999999999,0.17999999999999999,0.088999999999999996,0.11,0.10000000000000001,0.14099999999999999,0.088999999999999996,0.076999999999999999,0.41099999999999998,0.14699999999999999,0.025000000000000001,0.035000000000000003,0.090999999999999998],"type":"bar","name":"2019","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>At Region Level</strong></p>
<pre class="r"><code>hap_df |&gt;
  mutate(region = fct_reorder(region, perception_of_corruption))|&gt;
  group_by(region, year)|&gt;
  summarise(
    average_corruption = mean(perception_of_corruption, na.rm = TRUE)
  ) |&gt;
  plot_ly (
  x = ~region, y = ~average_corruption, color = ~year,
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;Perception of Corruption By Region&quot;,
    xaxis = list(title = &quot;Region&quot;),
    yaxis = list(title = &quot;Average Score&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3557e643f4578009feac" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-3557e643f4578009feac">{"x":{"visdat":{"b30a4e718e8d":["function () ","plotlyVisDat"]},"cur_data":"b30a4e718e8d","attrs":{"b30a4e718e8d":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Perception of Corruption By Region","xaxis":{"domain":[0,1],"automargin":true,"title":"Region","type":"category","categoryorder":"array","categoryarray":["Central and Eastern Europe","Eastern Asia","Sub-Saharan Africa","Latin America and Caribbean","Southern Asia","Southeastern Asia","Middle East and Northern Africa","North America","Western Europe","Australia and New Zealand"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Central and Eastern Europe","Eastern Asia","Sub-Saharan Africa","Latin America and Caribbean","Southern Asia","Southeastern Asia","Middle East and Northern Africa","North America","Western Europe","Australia and New Zealand"],"y":[0.086673793103448277,0.127695,0.12387775000000001,0.11717181818181818,0.10253571428571429,0.15127555555555555,0.181702,0.24423499999999998,0.23146285714285714,0.39279500000000001],"type":"bar","name":"2015","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Central and Eastern Europe","Eastern Asia","Sub-Saharan Africa","Latin America and Caribbean","Southern Asia","Southeastern Asia","Middle East and Northern Africa","North America","Western Europe","Australia and New Zealand"],"y":[0.088071724137931032,0.11834666666666666,0.12037894736842106,0.10601625000000001,0.10489857142857142,0.14810444444444446,0.16152631578947368,0.230985,0.2325442857142857,0.37117500000000003],"type":"bar","name":"2016","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Central and Eastern Europe","Eastern Asia","Sub-Saharan Africa","Latin America and Caribbean","Southern Asia","Southeastern Asia","Middle East and Northern Africa","North America","Western Europe","Australia and New Zealand"],"y":[0.079619749497365347,0.10675049231698117,0.10057871086666215,0.087763777934014756,0.10306579193898614,0.12759070622269064,0.149084293528607,0.211505152285099,0.21899938884945147,0.34200021624565147],"type":"bar","name":"2017","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Central and Eastern Europe","Eastern Asia","Sub-Saharan Africa","Latin America and Caribbean","Southern Asia","Southeastern Asia","Middle East and Northern Africa","North America","Western Europe","Australia and New Zealand"],"y":[0.062275862068965515,0.11749999999999999,0.090794871794871793,0.076999999999999999,0.097857142857142865,0.12933333333333333,0.12294444444444444,0.21199999999999999,0.2112857142857143,0.34550000000000003],"type":"bar","name":"2018","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Central and Eastern Europe","Eastern Asia","Sub-Saharan Africa","Latin America and Caribbean","Southern Asia","Southeastern Asia","Middle East and Northern Africa","North America","Western Europe","Australia and New Zealand"],"y":[0.061758620689655173,0.11966666666666667,0.094500000000000001,0.072047619047619041,0.09342857142857143,0.12344444444444444,0.105,0.218,0.2183809523809524,0.33499999999999996],"type":"bar","name":"2019","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>Regional Trend</strong></p>
<pre class="r"><code>regional_hap_df |&gt;
  filter(factor == &quot;perception_of_corruption&quot;)|&gt;
  plot_ly(
      x = ~year, y = ~average_score, color = ~region,
      mode = &#39;lines+markers&#39;, type = &#39;scatter&#39;, colors = &#39;viridis&#39;,
      name = ~region) |&gt;
    layout(
      title = paste(&quot;Regional Trend for Perception of Corruption from 2015 to 2019&quot;),
      xaxis = list(title = &quot;Year&quot;),
      yaxis = list(title = &quot;Average Score&quot;),
      autosize = F, width = 820, height = 500
    )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-43b60044f9a0d0c9ee01" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-43b60044f9a0d0c9ee01">{"x":{"visdat":{"b30a1762a088":["function () ","plotlyVisDat"]},"cur_data":"b30a1762a088","attrs":{"b30a1762a088":{"x":{},"y":{},"mode":"lines+markers","name":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"width":820,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Regional Trend for Perception of Corruption from 2015 to 2019","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2015","2016","2017","2018","2019"],"y":[0.39279500000000001,0.37117500000000003,0.34200021624565147,0.34550000000000003,0.33499999999999996],"mode":"lines+markers","name":"Australia and New Zealand","type":"scatter","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.086673793103448277,0.088071724137931032,0.079619749497365347,0.062275862068965515,0.061758620689655173],"mode":"lines+markers","name":"Central and Eastern Europe","type":"scatter","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"line":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.127695,0.11834666666666666,0.10675049231698117,0.11749999999999999,0.11966666666666667],"mode":"lines+markers","name":"Eastern Asia","type":"scatter","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"line":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.11717181818181818,0.10601625000000001,0.087763777934014756,0.076999999999999999,0.072047619047619041],"mode":"lines+markers","name":"Latin America and Caribbean","type":"scatter","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"line":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.181702,0.16152631578947368,0.149084293528607,0.12294444444444444,0.105],"mode":"lines+markers","name":"Middle East and Northern Africa","type":"scatter","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"line":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.24423499999999998,0.230985,0.211505152285099,0.21199999999999999,0.218],"mode":"lines+markers","name":"North America","type":"scatter","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"line":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.15127555555555555,0.14810444444444446,0.12759070622269064,0.12933333333333333,0.12344444444444444],"mode":"lines+markers","name":"Southeastern Asia","type":"scatter","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"line":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.10253571428571429,0.10489857142857142,0.10306579193898614,0.097857142857142865,0.09342857142857143],"mode":"lines+markers","name":"Southern Asia","type":"scatter","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"line":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.12387775000000001,0.12037894736842106,0.10057871086666215,0.090794871794871793,0.094500000000000001],"mode":"lines+markers","name":"Sub-Saharan Africa","type":"scatter","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"line":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.23146285714285714,0.2325442857142857,0.21899938884945147,0.2112857142857143,0.2183809523809524],"mode":"lines+markers","name":"Western Europe","type":"scatter","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>At <em>countries level</em>, from 2015 to 2019, Rwanda and Singapore
has the lowest perception of corruption. Singapore, Rwanda, Qatar,
Finland and Denmark are the top 5 countries with the lowest perception
of corruption. Bosnia, Romania, Bulgaria, Moldova and Lithuania are the
bottom 5 countries with the highest perception of corruption.</p>
<p>At <em>regional level</em>, from 2015 to 2019, Australia and New
Zealand has the lowest proception of corruption Central and eastern
Europe has the lowest. There are relatively larger variation in trend
between the 10 regions compare to other factors, but all regions has
increasing perception of correction.</p>
</div>
<div id="generosity" class="section level3">
<h3>Generosity</h3>
<p><strong>At Country Level</strong></p>
<pre class="r"><code>hap_df |&gt;
  mutate(country = fct_reorder(country, generosity))|&gt;
  plot_ly (
  x = ~country, y = ~generosity, color = ~year,
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;Genersoity&quot;,
    xaxis = list(
      title = &quot;country&quot;,
      tickfont = list(size = 6)
      ),
    yaxis = list(title = &quot;Score&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a0b69037baba131770cd" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-a0b69037baba131770cd">{"x":{"visdat":{"b30a10fb67c2":["function () ","plotlyVisDat"]},"cur_data":"b30a10fb67c2","attrs":{"b30a10fb67c2":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Genersoity","xaxis":{"domain":[0,1],"automargin":true,"title":"country","tickfont":{"size":6},"type":"category","categoryorder":"array","categoryarray":["Greece","Lithuania","Morocco","Gabon","Azerbaijan","China","Tunisia","Russia","Georgia","Venezuela","Algeria","Namibia","Armenia","Hungary","Turkey","Estonia","Czech Republic","El Salvador","Portugal","Yemen","Botswana","Japan","Angola","Argentina","Belarus","Palestinian Territories","Egypt","Bulgaria","Ecuador","Mexico","Croatia","Republic of Congo","France","Peru","Swaziland","Romania","Jordan","South Africa","Slovakia","Lesotho","Saudi Arabia","Poland","Brazil","Kazakhstan","Colombia","Libya","Latvia","Montenegro","Kuwait","Italy","Suriname","Albania","Bangladesh","Bahrain","Uruguay","Togo","Spain","Vietnam","Iraq","Djibouti","Sudan","Benin","Comoros","Mali","Senegal","North Macedonia","Zimbabwe","South Korea","Chad","Dominican Republic","Ukraine","Serbia","Philippines","Niger","Burundi","Moldova","Ivory Coast","Mauritania","Bolivia","Cameroon","Madagascar","Panama","Jamaica","Mozambique","Costa Rica","Oman","Burkina Faso","Lebanon","Zambia","Puerto Rico","Belgium","Paraguay","Turkmenistan","Rwanda","Macedonia","Tajikistan","Honduras","Ghana","Nigeria","India","Finland","Central African Republic","Belize","Sierra Leone","Liberia","South Sudan","Slovenia","Ethiopia","Democratic Republic of the Congo","Taiwan","North Cyprus","Bosnia and Herzegovina","United Arab Emirates","Guinea","Gambia","Uganda","Cyprus","Somalia","Guatemala","Luxembourg","Nicaragua","Kosovo","Switzerland","Germany","Malawi","Kyrgyzstan","Singapore","Pakistan","Afghanistan","Tanzania","Chile","Austria","Trinidad and Tobago","Nepal","Qatar","Uzbekistan","Israel","Malaysia","Mongolia","Denmark","Laos","Norway","Mauritius","Sweden","Hong Kong","Kenya","Iran","Cambodia","USA","Sri Lanka","Ireland","Canada","Australia","Iceland","Haiti","Netherlands","Syria","Bhutan","New Zealand","UK","Somaliland Region","Indonesia","Malta","Thailand","Myanmar"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Switzerland","Iceland","Denmark","Norway","Canada","Finland","Netherlands","Sweden","New Zealand","Australia","Israel","Costa Rica","Austria","Mexico","USA","Brazil","Luxembourg","Ireland","Belgium","United Arab Emirates","UK","Oman","Venezuela","Singapore","Panama","Germany","Chile","Qatar","France","Argentina","Czech Republic","Uruguay","Colombia","Thailand","Saudi Arabia","Spain","Malta","Taiwan","Kuwait","Suriname","Trinidad and Tobago","El Salvador","Guatemala","Uzbekistan","Slovakia","Japan","South Korea","Ecuador","Bahrain","Italy","Bolivia","Moldova","Paraguay","Kazakhstan","Slovenia","Lithuania","Nicaragua","Peru","Belarus","Poland","Malaysia","Croatia","Libya","Russia","Jamaica","North Cyprus","Cyprus","Algeria","Kosovo","Turkmenistan","Mauritius","Hong Kong","Estonia","Indonesia","Vietnam","Turkey","Kyrgyzstan","Nigeria","Bhutan","Azerbaijan","Pakistan","Jordan","Montenegro","China","Zambia","Romania","Serbia","Portugal","Latvia","Philippines","Somalia","Morocco","Macedonia","Mozambique","Albania","Bosnia and Herzegovina","Lesotho","Dominican Republic","Laos","Mongolia","Swaziland","Greece","Lebanon","Hungary","Honduras","Tajikistan","Tunisia","Palestinian Territories","Bangladesh","Iran","Ukraine","Iraq","South Africa","Ghana","Zimbabwe","Liberia","India","Sudan","Haiti","Democratic Republic of the Congo","Nepal","Ethiopia","Sierra Leone","Mauritania","Kenya","Djibouti","Armenia","Botswana","Myanmar","Georgia","Malawi","Sri Lanka","Cameroon","Bulgaria","Egypt","Yemen","Angola","Mali","Republic of Congo","Comoros","Uganda","Senegal","Gabon","Niger","Cambodia","Tanzania","Madagascar","Central African Republic","Chad","Guinea","Ivory Coast","Burkina Faso","Afghanistan","Rwanda","Benin","Syria","Burundi","Togo"],"y":[0.29677999999999999,0.43630000000000002,0.34139000000000003,0.34699000000000002,0.45811000000000002,0.23351,0.47610000000000002,0.36262,0.47500999999999999,0.43562000000000001,0.33172000000000001,0.25496999999999997,0.33088000000000001,0.14074,0.40105000000000002,0.14574000000000001,0.28033999999999998,0.45900999999999997,0.2225,0.26428000000000001,0.51912000000000003,0.21542,0.058409999999999997,0.31104999999999999,0.24434,0.28214,0.33362999999999998,0.32573000000000002,0.12332,0.11451,0.10686,0.2324,0.18401000000000001,0.57630000000000003,0.13705999999999999,0.18226999999999999,0.51751999999999998,0.25375999999999999,0.16228000000000001,0.16991000000000001,0.31844,0.10692,0.27489000000000002,0.22836999999999999,0.16893,0.10705000000000001,0.18557000000000001,0.11541,0.17362,0.22822999999999999,0.20535999999999999,0.20951,0.34239999999999998,0.11827,0.25328000000000001,0.026409999999999999,0.27815000000000001,0.14982000000000001,0.11046,0.16758999999999999,0.33074999999999999,0.054440000000000002,0.18295,0.00199,0.21229999999999999,0.26168999999999998,0.30637999999999999,0.078219999999999998,0.28310000000000002,0.16979,0.37744,0.39478000000000002,0.086800000000000002,0.51534999999999997,0.1686,0.12253,0.30030000000000001,0.27233000000000002,0.47998000000000002,0.077990000000000004,0.33671000000000001,0.11053,0.16139999999999999,0.081850000000000006,0.19591,0.13747999999999999,0.19231000000000001,0.13719000000000001,0.18226000000000001,0.24990999999999999,0.50317999999999996,0.071720000000000006,0.22359000000000001,0.22269,0.14272000000000001,0.24807999999999999,0.16388,0.21684,0.42192000000000002,0.33229999999999998,0.18259,0,0.21854000000000001,0.128,0.23027,0.22974,0.064310000000000006,0.11251,0.21221999999999999,0.38085999999999998,0.15275,0.17921999999999999,0.11973,0.23086999999999999,0.18987000000000001,0.24362,0.26474999999999999,0.19062000000000001,0.46187,0.24834000000000001,0.32296000000000002,0.24324999999999999,0.21487999999999999,0.219,0.37541999999999998,0.18093000000000001,0.078549999999999995,0.10460999999999999,0.79588000000000003,0.055469999999999998,0.33128000000000002,0.40827999999999998,0.20618,0.11921,0.11291,0.091310000000000002,0.12343999999999999,0.18798000000000001,0.12388,0.17441000000000001,0.29065999999999997,0.20843,0.068220000000000003,0.19386999999999999,0.40359,0.34377000000000002,0.21332999999999999,0.23835000000000001,0.18386,0.28656999999999999,0.20165,0.21747,0.36509999999999998,0.22628000000000001,0.18260000000000001,0.47178999999999999,0.19727,0.16681000000000001],"type":"bar","name":"2015","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Denmark","Switzerland","Iceland","Norway","Finland","Canada","Netherlands","New Zealand","Australia","Sweden","Israel","Austria","USA","Costa Rica","Puerto Rico","Germany","Brazil","Belgium","Ireland","Luxembourg","Mexico","Singapore","UK","Chile","Panama","Argentina","Czech Republic","United Arab Emirates","Uruguay","Malta","Colombia","France","Thailand","Saudi Arabia","Taiwan","Qatar","Spain","Algeria","Guatemala","Suriname","Kuwait","Bahrain","Trinidad and Tobago","Venezuela","Slovakia","El Salvador","Malaysia","Nicaragua","Uzbekistan","Italy","Ecuador","Belize","Japan","Kazakhstan","Moldova","Russia","Poland","South Korea","Bolivia","Lithuania","Belarus","North Cyprus","Slovenia","Peru","Turkmenistan","Mauritius","Libya","Latvia","Cyprus","Paraguay","Romania","Estonia","Jamaica","Croatia","Hong Kong","Somalia","Kosovo","Turkey","Indonesia","Jordan","Azerbaijan","Philippines","China","Bhutan","Kyrgyzstan","Serbia","Bosnia and Herzegovina","Montenegro","Dominican Republic","Morocco","Hungary","Pakistan","Lebanon","Portugal","Macedonia","Vietnam","Somaliland Region","Tunisia","Greece","Tajikistan","Mongolia","Laos","Nigeria","Honduras","Iran","Zambia","Nepal","Palestinian Territories","Albania","Bangladesh","Sierra Leone","Iraq","Namibia","Cameroon","Ethiopia","South Africa","Sri Lanka","India","Myanmar","Egypt","Armenia","Kenya","Ukraine","Ghana","Democratic Republic of the Congo","Georgia","Republic of Congo","Senegal","Bulgaria","Mauritania","Zimbabwe","Malawi","Sudan","Gabon","Mali","Haiti","Botswana","Comoros","Ivory Coast","Cambodia","Angola","Niger","South Sudan","Chad","Burkina Faso","Uganda","Yemen","Madagascar","Tanzania","Liberia","Guinea","Rwanda","Benin","Afghanistan","Togo","Syria","Burundi"],"y":[0.36170999999999998,0.28083000000000002,0.47677999999999998,0.37895000000000001,0.25491999999999998,0.44834000000000002,0.47416000000000003,0.49401,0.47406999999999999,0.38253999999999999,0.32288,0.32865,0.41077000000000002,0.22553000000000001,0.22202,0.30452000000000001,0.15776000000000001,0.2424,0.44962999999999997,0.27571000000000001,0.11735,0.32706000000000002,0.50156000000000001,0.31595000000000001,0.24179999999999999,0.10989,0.099290000000000003,0.26590999999999998,0.18056,0.56237000000000004,0.15626000000000001,0.1216,0.58696000000000004,0.15457000000000001,0.25495000000000001,0.32388,0.17665,0.070440000000000003,0.28808,0.16664999999999999,0.15964999999999999,0.17147000000000001,0.31935000000000002,0.042500000000000003,0.13836999999999999,0.088770000000000002,0.41474,0.29772999999999999,0.34326000000000001,0.16683999999999999,0.10074,0.23683999999999999,0.10224,0.15010999999999999,0.19997000000000001,0.027359999999999999,0.14443,0.18823999999999999,0.21698000000000001,0.020250000000000001,0.13941999999999999,0.26322000000000001,0.25738,0.14527000000000001,0.22567000000000001,0.36951000000000001,0.17086999999999999,0.17444999999999999,0.27905999999999997,0.25296000000000002,0.12889,0.084229999999999999,0.22245000000000001,0.18434,0.40096999999999999,0.27224999999999999,0.27992,0.047070000000000001,0.56520999999999999,0.14262,0.056399999999999999,0.21673999999999999,0.049590000000000002,0.48546,0.38431999999999999,0.20737,0.29888999999999999,0.17191000000000001,0.21285999999999999,0.040529999999999997,0.099000000000000005,0.31185000000000002,0.23693,0.11691,0.23507,0.25074999999999997,0.51478999999999997,0.039359999999999999,0,0.25997999999999999,0.34538999999999997,0.43079000000000001,0.23219000000000001,0.2044,0.38538,0.17866000000000001,0.38159999999999999,0.11154,0.16839999999999999,0.19131999999999999,0.23896999999999999,0.19589000000000001,0.077950000000000005,0.2268,0.29521999999999998,0.13655999999999999,0.46977999999999998,0.25028,0.81971000000000005,0.12706000000000001,0.077929999999999999,0.41327999999999998,0.20363000000000001,0.21203,0.25457999999999997,0.067860000000000004,0.12077,0.19103000000000001,0.12792999999999999,0.22686000000000001,0.18503,0.30968000000000001,0.18076999999999999,0.062440000000000002,0.21063999999999999,0.47958000000000001,0.12425,0.1827,0.20338000000000001,0.40339000000000003,0.12071,0.2097,0.25899,0.18667,0.24353,0.27101999999999998,0.098210000000000006,0.22040000000000001,0.31472,0.24063000000000001,0.29914000000000002,0.23552000000000001,0.20180000000000001,0.31268000000000001,0.17516999999999999,0.48397000000000001,0.2029],"type":"bar","name":"2016","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Norway","Denmark","Iceland","Switzerland","Finland","Netherlands","Canada","New Zealand","Sweden","Australia","Israel","Costa Rica","Austria","USA","Ireland","Germany","Belgium","Luxembourg","UK","Chile","United Arab Emirates","Brazil","Czech Republic","Argentina","Mexico","Singapore","Malta","Uruguay","Guatemala","Panama","France","Thailand","Taiwan","Spain","Qatar","Colombia","Saudi Arabia","Trinidad and Tobago","Kuwait","Slovakia","Bahrain","Malaysia","Nicaragua","Ecuador","El Salvador","Poland","Uzbekistan","Italy","Russia","Belize","Japan","Lithuania","Algeria","Latvia","South Korea","Moldova","Romania","Bolivia","Turkmenistan","Kazakhstan","North Cyprus","Slovenia","Peru","Mauritius","Cyprus","Estonia","Belarus","Libya","Turkey","Paraguay","Hong Kong","Philippines","Serbia","Jordan","Hungary","Jamaica","Croatia","Kosovo","China","Pakistan","Indonesia","Venezuela","Montenegro","Morocco","Azerbaijan","Dominican Republic","Greece","Lebanon","Portugal","Bosnia and Herzegovina","Honduras","Macedonia","Somalia","Vietnam","Nigeria","Tajikistan","Bhutan","Kyrgyzstan","Nepal","Mongolia","South Africa","Tunisia","Palestinian Territories","Egypt","Bulgaria","Sierra Leone","Cameroon","Iran","Albania","Bangladesh","Namibia","Kenya","Mozambique","Myanmar","Senegal","Zambia","Iraq","Gabon","Ethiopia","Sri Lanka","Armenia","India","Mauritania","Republic of Congo","Georgia","Democratic Republic of the Congo","Mali","Ivory Coast","Cambodia","Sudan","Ghana","Ukraine","Uganda","Burkina Faso","Niger","Malawi","Chad","Zimbabwe","Lesotho","Angola","Afghanistan","Botswana","Benin","Madagascar","Haiti","Yemen","South Sudan","Liberia","Guinea","Togo","Rwanda","Syria","Tanzania","Burundi","Central African Republic"],"y":[0.36201223731040999,0.35528048872947698,0.475540220737457,0.29054927825927701,0.24548277258873,0.47048982977867099,0.43553972244262701,0.50000512599945102,0.38539925217628501,0.47769924998283397,0.33008265495300299,0.21461322903633101,0.31647232174873402,0.39257878065109297,0.42785832285880998,0.33626917004585299,0.23150333762168901,0.283180981874466,0.492774158716202,0.32666242122650102,0.36094194650650002,0.16234989464283001,0.088106758892536205,0.109457060694695,0.120990432798862,0.34596598148345897,0.57473057508468595,0.17509692907333399,0.28348839282989502,0.21055693924426999,0.12976230680942499,0.57212311029434204,0.258360475301743,0.190133571624756,0.33047387003898598,0.149014472961426,0.14761601388454401,0.325296461582184,0.22828979790210699,0.13654448091983801,0.172668486833572,0.41660892963409402,0.30167421698570301,0.150112465023994,0.078257985413074493,0.158465966582298,0.415983647108078,0.17278964817524001,0.052263822406530401,0.24001564085483601,0.12057276815176,0.010164656676352,0.069436646997928606,0.153074786067009,0.20667436718940699,0.208779126405716,0.133519917726517,0.22556072473526001,0.24992498755455,0.20196442306041701,0.266845703125,0.24264909327030201,0.12681971490383101,0.36093375086784402,0.27125430107116699,0.098890811204910306,0.15513750910759,0.15207366645336201,0.046693041920661899,0.22415065765380901,0.37446579337120101,0.193513423204422,0.22012588381767301,0.172170460224152,0.0784016624093056,0.23381833732128099,0.24800297617912301,0.31993144750595098,0.028806841000914601,0.31544601917266801,0.61170458793640103,0.065019629895687103,0.19791102409362801,0.032209955155849498,0.045269340276718098,0.18696784973144501,0,0.26445075869560197,0.095102712512016296,0.32886749505996699,0.23618887364864299,0.25376096367835999,0.29163131117820701,0.234968051314354,0.23094719648361201,0.24899764358997301,0.474054545164108,0.42858037352562001,0.39409616589546198,0.33846423029899603,0.13936237990856201,0.0496933571994305,0.114173173904419,0.12863144278526301,0.11317769438028299,0.293040901422501,0.23629845678806299,0.38724291324615501,0.20131294429302199,0.17225535213947299,0.077133744955062894,0.444860309362411,0.322228103876114,0.83807516098022505,0.183468893170357,0.24958014488220201,0.19963726401328999,0.043785378336906398,0.31265074014663702,0.49086356163024902,0.083488091826438904,0.23153848946094499,0.20187002420425401,0.120852127671242,0.054008815437555299,0.246455833315849,0.18335419893264801,0.20123746991157501,0.38592296838760398,0.182317450642586,0.25692394375801098,0.27006146311759899,0.32576605677604697,0.25086468458175698,0.228673845529556,0.287170469760895,0.21611385047435799,0.18914349377155301,0.15749727189540899,0.097926490008830996,0.31187093257904103,0.099348448216915103,0.20794846117496499,0.208732530474663,0.489203780889511,0.104125209152699,0.285670816898346,0.26654988527298001,0.26481509208679199,0.19689615070819899,0.25275602936744701,0.49366372823715199,0.354256361722946,0.204435184597969,0.28087648749351501],"type":"bar","name":"2017","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Norway","Denmark","Iceland","Switzerland","Netherlands","Canada","New Zealand","Sweden","Australia","UK","Austria","Costa Rica","Ireland","Germany","Belgium","Luxembourg","USA","Israel","United Arab Emirates","Czech Republic","Malta","France","Mexico","Chile","Taiwan","Panama","Brazil","Argentina","Guatemala","Uruguay","Qatar","Saudi Arabia","Singapore","Malaysia","Spain","Colombia","Trinidad and Tobago","Slovakia","El Salvador","Nicaragua","Poland","Bahrain","Uzbekistan","Kuwait","Thailand","Italy","Ecuador","Belize","Lithuania","Slovenia","Romania","Latvia","Japan","Mauritius","Jamaica","South Korea","North Cyprus","Russia","Kazakhstan","Cyprus","Bolivia","Estonia","Paraguay","Peru","Kosovo","Moldova","Turkmenistan","Hungary","Libya","Philippines","Honduras","Belarus","Turkey","Pakistan","Hong Kong","Portugal","Serbia","Greece","Lebanon","Montenegro","Croatia","Dominican Republic","Algeria","Morocco","China","Azerbaijan","Tajikistan","Macedonia","Jordan","Nigeria","Kyrgyzstan","Bosnia and Herzegovina","Mongolia","Vietnam","Indonesia","Bhutan","Somalia","Cameroon","Bulgaria","Nepal","Venezuela","Gabon","Palestinian Territories","South Africa","Iran","Ivory Coast","Ghana","Senegal","Laos","Tunisia","Albania","Sierra Leone","Republic of Congo","Bangladesh","Sri Lanka","Iraq","Mali","Namibia","Cambodia","Burkina Faso","Egypt","Mozambique","Kenya","Zambia","Mauritania","Ethiopia","Georgia","Armenia","Myanmar","Chad","Democratic Republic of the Congo","India","Niger","Uganda","Benin","Sudan","Ukraine","Togo","Guinea","Lesotho","Angola","Madagascar","Zimbabwe","Afghanistan","Botswana","Malawi","Haiti","Liberia","Syria","Rwanda","Yemen","Tanzania","South Sudan","Central African Republic","Burundi"],"y":[0.20200000000000001,0.28599999999999998,0.28399999999999997,0.35299999999999998,0.25600000000000001,0.33300000000000002,0.32100000000000001,0.36499999999999999,0.28499999999999998,0.36099999999999999,0.26200000000000001,0.24199999999999999,0.14299999999999999,0.307,0.27300000000000002,0.188,0.19600000000000001,0.29099999999999998,0.35399999999999998,0.186,0.064000000000000001,0.376,0.098000000000000004,0.069000000000000006,0.19700000000000001,0.151,0.125,0.11,0.062,0.17899999999999999,0.13,0.25600000000000001,0.098000000000000004,0.26100000000000001,0.311,0.14199999999999999,0.099000000000000005,0.17100000000000001,0.11799999999999999,0.065000000000000002,0.20799999999999999,0.108,0.24299999999999999,0.32800000000000001,0.16700000000000001,0.36399999999999999,0.13700000000000001,0.114,0.183,0.025999999999999999,0.16,0.087999999999999995,0.091999999999999998,0.079000000000000001,0.245,0.096000000000000002,0.17499999999999999,0.17899999999999999,0.065000000000000002,0.14799999999999999,0.20200000000000001,0.14099999999999999,0.085999999999999993,0.16200000000000001,0.091999999999999998,0.27400000000000002,0.17100000000000001,0.19900000000000001,0.060999999999999999,0.11600000000000001,0.12,0.19700000000000001,0.10100000000000001,0.106,0.216,0.246,0.055,0.13400000000000001,0,0.214,0.111,0.12,0.12,0.055,0.025999999999999999,0.029000000000000001,0.031,0.187,0.17299999999999999,0.13,0.20100000000000001,0.28100000000000003,0.216,0.253,0.17699999999999999,0.48399999999999999,0.36399999999999999,0.23799999999999999,0.183,0.064000000000000001,0.30199999999999999,0.056000000000000001,0.032000000000000001,0.085999999999999993,0.10299999999999999,0.28199999999999997,0.14599999999999999,0.21199999999999999,0.13800000000000001,0.23000000000000001,0.040000000000000001,0.14899999999999999,0.23799999999999999,0.090999999999999998,0.153,0.307,0.14799999999999999,0.13900000000000001,0.050999999999999997,0.25600000000000001,0.17499999999999999,0.091999999999999998,0.20599999999999999,0.35199999999999998,0.221,0.13400000000000001,0.22,0.037999999999999999,0.076999999999999999,0.59799999999999998,0.18099999999999999,0.19700000000000001,0.17199999999999999,0.17499999999999999,0.25900000000000001,0.16300000000000001,0.13400000000000001,0.187,0.158,0.185,0.11600000000000001,0.079000000000000001,0.155,0.13200000000000001,0.191,0.042000000000000003,0.20999999999999999,0.39200000000000002,0.20599999999999999,0.376,0.20000000000000001,0.083000000000000004,0.27000000000000002,0.224,0.218,0.14899999999999999],"type":"bar","name":"2018","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Finland","Denmark","Norway","Iceland","Netherlands","Switzerland","Sweden","New Zealand","Canada","Austria","Australia","Costa Rica","Israel","Luxembourg","UK","Ireland","Germany","Belgium","USA","Czech Republic","United Arab Emirates","Malta","Mexico","France","Taiwan","Chile","Guatemala","Saudi Arabia","Qatar","Spain","Panama","Brazil","Uruguay","Singapore","El Salvador","Italy","Bahrain","Slovakia","Trinidad and Tobago","Poland","Uzbekistan","Lithuania","Colombia","Slovenia","Nicaragua","Kosovo","Argentina","Romania","Cyprus","Ecuador","Kuwait","Thailand","Latvia","South Korea","Estonia","Jamaica","Mauritius","Japan","Honduras","Kazakhstan","Bolivia","Hungary","Paraguay","North Cyprus","Peru","Portugal","Pakistan","Russia","Philippines","Serbia","Moldova","Libya","Montenegro","Tajikistan","Croatia","Hong Kong","Dominican Republic","Bosnia and Herzegovina","Turkey","Malaysia","Belarus","Greece","Mongolia","North Macedonia","Nigeria","Kyrgyzstan","Turkmenistan","Algeria","Morocco","Azerbaijan","Lebanon","Indonesia","China","Vietnam","Bhutan","Cameroon","Bulgaria","Ghana","Ivory Coast","Nepal","Jordan","Benin","Republic of Congo","Gabon","Laos","South Africa","Albania","Venezuela","Cambodia","Palestinian Territories","Senegal","Somalia","Namibia","Niger","Burkina Faso","Armenia","Iran","Guinea","Georgia","Gambia","Kenya","Mauritania","Mozambique","Tunisia","Bangladesh","Iraq","Democratic Republic of the Congo","Mali","Sierra Leone","Sri Lanka","Myanmar","Chad","Ukraine","Ethiopia","Swaziland","Uganda","Egypt","Zambia","Togo","India","Liberia","Comoros","Madagascar","Lesotho","Burundi","Zimbabwe","Haiti","Botswana","Syria","Malawi","Yemen","Rwanda","Tanzania","Afghanistan","Central African Republic","South Sudan"],"y":[0.153,0.252,0.27100000000000002,0.35399999999999998,0.32200000000000001,0.26300000000000001,0.26700000000000002,0.33000000000000002,0.28499999999999998,0.24399999999999999,0.33200000000000002,0.14399999999999999,0.26100000000000001,0.19400000000000001,0.34799999999999998,0.29799999999999999,0.26100000000000001,0.16,0.28000000000000003,0.045999999999999999,0.26200000000000001,0.375,0.073999999999999996,0.111,0.24199999999999999,0.187,0.17499999999999999,0.080000000000000002,0.22,0.153,0.109,0.099000000000000005,0.127,0.27100000000000002,0.092999999999999999,0.158,0.255,0.121,0.185,0.11700000000000001,0.32200000000000001,0.042999999999999997,0.099000000000000005,0.14399999999999999,0.20000000000000001,0.26200000000000001,0.066000000000000003,0.083000000000000004,0.19,0.126,0.14199999999999999,0.35899999999999999,0.074999999999999997,0.17499999999999999,0.10299999999999999,0.107,0.215,0.069000000000000006,0.246,0.14599999999999999,0.13700000000000001,0.081000000000000003,0.184,0.191,0.083000000000000004,0.047,0.22,0.082000000000000003,0.11700000000000001,0.13700000000000001,0.18099999999999999,0.13300000000000001,0.14199999999999999,0.23000000000000001,0.11899999999999999,0.25800000000000001,0.113,0.26300000000000001,0.083000000000000004,0.26000000000000001,0.094,0,0.23499999999999999,0.185,0.215,0.29999999999999999,0.24399999999999999,0.072999999999999995,0.035999999999999997,0.035000000000000003,0.16600000000000001,0.498,0.058000000000000003,0.14699999999999999,0.37,0.187,0.081000000000000003,0.245,0.154,0.28499999999999998,0.11,0.17499999999999999,0.105,0.042999999999999997,0.26600000000000001,0.13,0.17799999999999999,0.064000000000000001,0.23200000000000001,0.10299999999999999,0.153,0.24299999999999999,0.070000000000000007,0.188,0.17699999999999999,0.095000000000000001,0.27000000000000002,0.20699999999999999,0.042999999999999997,0.26900000000000002,0.372,0.106,0.19700000000000001,0.058999999999999997,0.16600000000000001,0.14799999999999999,0.21199999999999999,0.153,0.252,0.24399999999999999,0.56599999999999995,0.19800000000000001,0.187,0.20899999999999999,0.073999999999999996,0.252,0.075999999999999998,0.247,0.17699999999999999,0.20000000000000001,0.23300000000000001,0.27500000000000002,0.16900000000000001,0.107,0.17599999999999999,0.151,0.41899999999999998,0.025000000000000001,0.33100000000000002,0.218,0.108,0.217,0.27600000000000002,0.158,0.23499999999999999,0.20200000000000001],"type":"bar","name":"2019","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>At Region Level</strong></p>
<pre class="r"><code>hap_df |&gt;
  mutate(region = fct_reorder(region, generosity))|&gt;
  group_by(region, year)|&gt;
  summarise(
    average_generosity = mean(generosity, na.rm = TRUE)
  ) |&gt;
  plot_ly (
  x = ~region, y = ~average_generosity, color = ~year,
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;Generosity By Region&quot;,
    xaxis = list(title = &quot;Region&quot;),
    yaxis = list(title = &quot;Average Score&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d3dcb04d51b2146ee197" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-d3dcb04d51b2146ee197">{"x":{"visdat":{"b30a50967abd":["function () ","plotlyVisDat"]},"cur_data":"b30a50967abd","attrs":{"b30a50967abd":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Generosity By Region","xaxis":{"domain":[0,1],"automargin":true,"title":"Region","type":"category","categoryorder":"array","categoryarray":["Central and Eastern Europe","Middle East and Northern Africa","Latin America and Caribbean","Eastern Asia","Sub-Saharan Africa","Western Europe","Southern Asia","Southeastern Asia","North America","Australia and New Zealand"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Central and Eastern Europe","Middle East and Northern Africa","Latin America and Caribbean","Eastern Asia","Sub-Saharan Africa","Western Europe","Southern Asia","Southeastern Asia","North America","Australia and New Zealand"],"y":[0.15226379310344829,0.1903755,0.21778772727272727,0.225885,0.22113674999999999,0.30210857142857145,0.34142857142857141,0.41926111111111114,0.42958000000000002,0.45531500000000003],"type":"bar","name":"2015","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Central and Eastern Europe","Middle East and Northern Africa","Latin America and Caribbean","Eastern Asia","Sub-Saharan Africa","Western Europe","Southern Asia","Southeastern Asia","North America","Australia and New Zealand"],"y":[0.17089758620689655,0.18674894736842104,0.20842833333333333,0.22356333333333334,0.22634842105263159,0.30471476190476188,0.34328142857142857,0.44614999999999999,0.42955500000000002,0.48404000000000003],"type":"bar","name":"2016","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Central and Eastern Europe","Middle East and Northern Africa","Latin America and Caribbean","Eastern Asia","Sub-Saharan Africa","Western Europe","Southern Asia","Southeastern Asia","North America","Australia and New Zealand"],"y":[0.1861161312473745,0.19917233621603561,0.21069618687033648,0.22122407921900361,0.22959933258019968,0.30349672337373101,0.34144643800599228,0.44986027665436262,0.41405925154685996,0.48885218799114249],"type":"bar","name":"2017","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Central and Eastern Europe","Middle East and Northern Africa","Latin America and Caribbean","Eastern Asia","Sub-Saharan Africa","Western Europe","Southern Asia","Southeastern Asia","North America","Australia and New Zealand"],"y":[0.13300000000000001,0.16094736842105262,0.1414090909090909,0.1555,0.1737948717948718,0.22171428571428572,0.24357142857142858,0.31122222222222223,0.30599999999999999,0.36299999999999999],"type":"bar","name":"2018","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Central and Eastern Europe","Middle East and Northern Africa","Latin America and Caribbean","Eastern Asia","Sub-Saharan Africa","Western Europe","Southern Asia","Southeastern Asia","North America","Australia and New Zealand"],"y":[0.14272413793103447,0.15347368421052632,0.14461904761904762,0.17283333333333334,0.187725,0.21961904761904763,0.23471428571428571,0.30177777777777776,0.28249999999999997,0.33100000000000002],"type":"bar","name":"2019","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>Regional Trend</strong></p>
<pre class="r"><code>regional_hap_df |&gt;
  filter(factor == &quot;generosity&quot;)|&gt;
  plot_ly(
      x = ~year, y = ~average_score, color = ~region,
      mode = &#39;lines+markers&#39;, type = &#39;scatter&#39;, colors = &#39;viridis&#39;,
      name = ~region) |&gt;
    layout(
      title = paste(&quot;Regional Trend for Generosity from 2015 to 2019&quot;),
      xaxis = list(title = &quot;Year&quot;),
      yaxis = list(title = &quot;Average Score&quot;),
      autosize = F, width = 820, height = 500
    )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0422814abdc8d0233b63" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-0422814abdc8d0233b63">{"x":{"visdat":{"b30a6a100df5":["function () ","plotlyVisDat"]},"cur_data":"b30a6a100df5","attrs":{"b30a6a100df5":{"x":{},"y":{},"mode":"lines+markers","name":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"width":820,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Regional Trend for Generosity from 2015 to 2019","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2015","2016","2017","2018","2019"],"y":[0.45531500000000003,0.48404000000000003,0.48885218799114249,0.36299999999999999,0.33100000000000002],"mode":"lines+markers","name":"Australia and New Zealand","type":"scatter","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.15226379310344829,0.17089758620689655,0.1861161312473745,0.13300000000000001,0.14272413793103447],"mode":"lines+markers","name":"Central and Eastern Europe","type":"scatter","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"line":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.225885,0.22356333333333334,0.22122407921900361,0.1555,0.17283333333333334],"mode":"lines+markers","name":"Eastern Asia","type":"scatter","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"line":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.21778772727272727,0.20842833333333333,0.21069618687033648,0.1414090909090909,0.14461904761904762],"mode":"lines+markers","name":"Latin America and Caribbean","type":"scatter","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"line":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.1903755,0.18674894736842104,0.19917233621603561,0.16094736842105262,0.15347368421052632],"mode":"lines+markers","name":"Middle East and Northern Africa","type":"scatter","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"line":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.42958000000000002,0.42955500000000002,0.41405925154685996,0.30599999999999999,0.28249999999999997],"mode":"lines+markers","name":"North America","type":"scatter","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"line":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.41926111111111114,0.44614999999999999,0.44986027665436262,0.31122222222222223,0.30177777777777776],"mode":"lines+markers","name":"Southeastern Asia","type":"scatter","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"line":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.34142857142857141,0.34328142857142857,0.34144643800599228,0.24357142857142858,0.23471428571428571],"mode":"lines+markers","name":"Southern Asia","type":"scatter","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"line":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.22113674999999999,0.22634842105263159,0.22959933258019968,0.1737948717948718,0.187725],"mode":"lines+markers","name":"Sub-Saharan Africa","type":"scatter","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"line":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.30210857142857145,0.30471476190476188,0.30349672337373101,0.22171428571428572,0.21961904761904763],"mode":"lines+markers","name":"Western Europe","type":"scatter","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>At <em>countries level</em>, from 2015 to 2019, Myanmar has the
highest generosity score. Myanmar, Thailand, Malta, Indonesia, and UK
are the top 5 countries with the highest score. Lithuania, Morocco,
Gabon, Azerbaijan, and China are the bottom 5 countries with the lowest
generosity scores.</p>
<p>At <em>regional level</em>, from 2015 to 2019, Australia and New
Zealand has the highest generosity proception of corruption Central and
eastern Europe has the lowest. The trend between 10 regions is
relatively similar.</p>
</div>
</div>
<div id="world-trend-of-the-mean-happiness-score-from-2015-to-2019"
class="section level2">
<h2>World Trend of the Mean Happiness Score from 2015 to 2019</h2>
<pre class="r"><code>combined_happiness |&gt;
  group_by(year, region) |&gt;
  mutate(region_avg = mean(score)) |&gt;
  arrange(desc(region_avg)) |&gt;
  summarize(region = unique(region), score = unique(region_avg)) |&gt;
  ggplot(aes(x = year, y = score, color = region)) +
  geom_point() + 
  geom_line() +
  labs(title = &quot;World Happiness Score Trend in 10 Regions&quot;, x = &quot;year&quot;, y = &quot;Happiness Score&quot;)</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p>According to the scatter plot, from 2015 to 2019, Australia and New
Zealand has stable happiness scores and it’s the highest amnong 10
regions. North America has second highest happiness score among 10
regions with the highest happiness score in year 2015 and gradually
decreasing trend. Western Europe has the third highest happiness score
with an increasing trend in 5 years. Latin America and Caribbean has the
fourth highest happiness score with a decreasing trend in 5 years.
Eastern Asia has the fifth highest happiness score with a stable trend.
Middle East and Northern Africa, Southeastern Asia, and Central and
Eastern Europe have comparative happiness score from 2015 to 2017, but
Central and Eastern Europe has a increasing trend and higher happiness
score after year 2017 while the other two regions have a decreasing
trend and lower happiness score after year 2017. Southern Asia and
Sub-Saharan Africa has the second lowest and lowest happiness score in 5
years, respectively. However, Sub-Saharan Africa has shown an increasing
trend while Southern Asia has shown an decreasing trend since year
2017.</p>
</div>
<div id="world-trends-of-the-six-happiness-indicators-from-2015-to-2019"
class="section level2">
<h2>World Trends of the Six Happiness Indicators from 2015 to 2019</h2>
<pre class="r"><code>hap_df |&gt;
  group_by(year) |&gt;
  summarise(
    average_gdp_per_capita = mean(gdp_per_capita, na.rm = TRUE),
    average_social_support = mean(social_support, na.rm = TRUE),
    average_healthy_life_expectancy = mean(health_life_expectancy, na.rm = TRUE),
    average_freedom_to_make_life_choices = mean(freedom_to_make_life_choices, na.rm = TRUE),
    average_perception_of_corruption = mean(perception_of_corruption, na.rm = TRUE),
    average_generosity = mean(generosity, na.rm = TRUE)
  )|&gt;
  pivot_longer(
    average_gdp_per_capita:average_generosity,
    names_to =&quot;factor&quot;,
    names_prefix = &quot;average_&quot;,
    values_to = &quot;average_score&quot;
  )|&gt;
  plot_ly(
    x = ~year, y = ~average_score, color = ~factor,
    type = &quot;scatter&quot;, mode = &quot;lines+markers&quot;, colors = &quot;viridis&quot;) |&gt;
  layout(
    title = &quot;World Trends of Happiness Indicators from 2015 to 2019&quot;,
    xaxis = list( title = &quot;Year&quot;),
    yaxis = list(title = &quot;Average Score&quot;),
    autosize = F, width = 800, height = 500
  )</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a3160ddb688ba4baaf9b" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-a3160ddb688ba4baaf9b">{"x":{"visdat":{"b30a5b43ad52":["function () ","plotlyVisDat"]},"cur_data":"b30a5b43ad52","attrs":{"b30a5b43ad52":{"x":{},"y":{},"mode":"lines+markers","color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"width":800,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"World Trends of Happiness Indicators from 2015 to 2019","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Score"},"autosize":false,"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2015","2016","2017","2018","2019"],"y":[0.42861493670886075,0.37099388535031846,0.40878597285838858,0.45450641025641025,0.39257051282051281],"mode":"lines+markers","type":"scatter","name":"freedom_to_make_life_choices","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.84613721518987339,0.95387980891719748,0.98471820194634729,0.89144871794871794,0.90514743589743585],"mode":"lines+markers","type":"scatter","name":"gdp_per_capita","marker":{"color":"rgba(65,68,135,1)","line":{"color":"rgba(65,68,135,1)"}},"textfont":{"color":"rgba(65,68,135,1)"},"error_y":{"color":"rgba(65,68,135,1)"},"error_x":{"color":"rgba(65,68,135,1)"},"line":{"color":"rgba(65,68,135,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.23729550632911392,0.24263490445859873,0.2468834716165739,0.18100641025641026,0.18484615384615385],"mode":"lines+markers","type":"scatter","name":"generosity","marker":{"color":"rgba(42,120,142,1)","line":{"color":"rgba(42,120,142,1)"}},"textfont":{"color":"rgba(42,120,142,1)"},"error_y":{"color":"rgba(42,120,142,1)"},"error_x":{"color":"rgba(42,120,142,1)"},"line":{"color":"rgba(42,120,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.63025936708860764,0.5576189808917198,0.55134078261232178,0.59734615384615386,0.72524358974358971],"mode":"lines+markers","type":"scatter","name":"healthy_life_expectancy","marker":{"color":"rgba(34,168,132,1)","line":{"color":"rgba(34,168,132,1)"}},"textfont":{"color":"rgba(34,168,132,1)"},"error_y":{"color":"rgba(34,168,132,1)"},"error_x":{"color":"rgba(34,168,132,1)"},"line":{"color":"rgba(34,168,132,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.14342183544303796,0.13762375796178344,0.12312022065142951,0.112,0.1106025641025641],"mode":"lines+markers","type":"scatter","name":"perception_of_corruption","marker":{"color":"rgba(122,209,81,1)","line":{"color":"rgba(122,209,81,1)"}},"textfont":{"color":"rgba(122,209,81,1)"},"error_y":{"color":"rgba(122,209,81,1)"},"error_x":{"color":"rgba(122,209,81,1)"},"line":{"color":"rgba(122,209,81,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2015","2016","2017","2018","2019"],"y":[0.99104594936708856,0.79362108280254773,1.1888977504545639,1.2132371794871795,1.2088141025641026],"mode":"lines+markers","type":"scatter","name":"social_support","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>The GDP per Capita increases from 2015 to 2017, then decreased from
2017 to 2018. There’s a slight increase from 2018 to 2019 but the world
has the highest GDP per Capita in 2017. The social support decreased
from 2015 to 201 with a significant increase from 2016 top 2017, then it
stayed relatively stable. The healthy life expectancy score decreased
from 2016 to 2017 then increased from 2017 to 2019. The freedom of
choices decrease from 2015 to 2016, increased from 2016 to 2018 and
decreased again in 2019. The preconception of corruption stayed
relatively stable but the world generally is seeing increasing
corruptions. The generosity decrease from 2017 to 2018 which in align
with the trend of GDP per Capita, suggesting possible association
between people’s income and their generosity around the world. However,
it’s worth noting that the countries with highest income are not the
countries with top generosity scores. Overall, social support and
healthy life expectancy improved from 2015 to 2019.</p>
</div>
</div>
<div id="multiple-linaer-regression" class="section level1">
<h1>Multiple Linaer Regression</h1>
<div id="part-1-which-factors-impact-the-happiness-score-the-most"
class="section level2">
<h2>Part 1: Which factors impact the happiness score the most?</h2>
<pre class="r"><code>happiness_score = read_csv(&quot;./Data/combined_happiness.csv&quot;)

predicted_model = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = happiness_score)

predicted_model|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="42%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.1750674</td>
<td align="right">0.0799098</td>
<td align="right">27.219021</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">1.1359972</td>
<td align="right">0.0841455</td>
<td align="right">13.500396</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">0.6458962</td>
<td align="right">0.0809226</td>
<td align="right">7.981656</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">1.0127106</td>
<td align="right">0.1320119</td>
<td align="right">7.671359</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">1.4812709</td>
<td align="right">0.1634584</td>
<td align="right">9.062068</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">0.8582286</td>
<td align="right">0.2234402</td>
<td align="right">3.840976</td>
<td align="right">0.0001326</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">0.5924416</td>
<td align="right">0.1757022</td>
<td align="right">3.371851</td>
<td align="right">0.0007837</td>
</tr>
</tbody>
</table>
<p>The variable “freedom to make life choices” exhibits the largest
coefficient (1.4812709) with a highly significant
p-value(&lt;0.0000001), indicating it exerts the most substantial effect
on happiness scores. Following this, “GDP per capita”, “Health life
expectancy”, and “Social support” are also significant contributors to
happiness in order of their estimates. “Perception of corruption” and
“Generosity” also significantly impact happiness but to a lesser extent,
based on their estimates and p-values.</p>
</div>
<div id="part-2-does-the-result-change-over-time"
class="section level2">
<h2>Part 2: Does the result change over time?</h2>
<div id="section-5" class="section level3">
<h3>2015</h3>
<pre class="r"><code>data_2015 = happiness_score|&gt;
  filter(year == 2015)

model2015 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = data_2015)

model2015|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="42%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.8601849</td>
<td align="right">0.1904824</td>
<td align="right">9.7656541</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">0.8606572</td>
<td align="right">0.2203113</td>
<td align="right">3.9065501</td>
<td align="right">0.0001409</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">1.4088916</td>
<td align="right">0.2226751</td>
<td align="right">6.3271187</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">0.9753090</td>
<td align="right">0.3162930</td>
<td align="right">3.0835619</td>
<td align="right">0.0024325</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">1.3334329</td>
<td align="right">0.3850157</td>
<td align="right">3.4633211</td>
<td align="right">0.0006944</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">0.7845381</td>
<td align="right">0.4365328</td>
<td align="right">1.7972032</td>
<td align="right">0.0743018</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">0.3889329</td>
<td align="right">0.3910029</td>
<td align="right">0.9947057</td>
<td align="right">0.3214707</td>
</tr>
</tbody>
</table>
<p>In 2015, the variable “social support” exhibited the largest
coefficient (1.4088916) with the lowest p-value(&lt;0.0000001) among all
variables. This indicated that it performed the most substantial effect
on happiness score in 2015. Following “social support”, “freedom to make
life choices”, “health life expectancy” and “gdp per capita” also
appeared to have relatively high estimates with significant p-values ,
indicating that there were sufficient evidences to show their essential
effects on happiness score. However, “perception of corruption” and
“generosity” appeared to have p-values larger than 0.05 indicating that
they didn’t have significant impact on happiness score.</p>
</div>
<div id="section-6" class="section level3">
<h3>2016</h3>
<pre class="r"><code>data_2016 = happiness_score|&gt;
  filter(year == 2016)

model2016 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = data_2016)

model2016|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="41%" />
<col width="14%" />
<col width="14%" />
<col width="15%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.1902936</td>
<td align="right">0.1583237</td>
<td align="right">13.8342722</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">0.7214128</td>
<td align="right">0.2171212</td>
<td align="right">3.3226274</td>
<td align="right">0.0011204</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">1.2297543</td>
<td align="right">0.2297496</td>
<td align="right">5.3525847</td>
<td align="right">0.0000003</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">1.4364028</td>
<td align="right">0.3489120</td>
<td align="right">4.1168054</td>
<td align="right">0.0000632</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">1.5139349</td>
<td align="right">0.3879659</td>
<td align="right">3.9022369</td>
<td align="right">0.0001435</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">0.9189270</td>
<td align="right">0.4647615</td>
<td align="right">1.9772014</td>
<td align="right">0.0498518</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">0.1594941</td>
<td align="right">0.3621060</td>
<td align="right">0.4404626</td>
<td align="right">0.6602362</td>
</tr>
</tbody>
</table>
<p>In 2016, the variable “freedom to make life choices” exhibited the
largest coefficient (1.5139349) with a significant p-value(0.0001435),
while the variable “health life expectancy” and “social support”
exhibited the second and the third largest coefficient and more
significant p-values(&lt;0.0001) in comparison to variable “freedom to
make life choices”. This indicated that they all exhibited a very
outstanding impact on happiness score in 2016. Following them,
“perception of corruption” and “gdp per capita” also appeared to have
relatively high estimates with p-values smaller than 0.05, indicating
that there were sufficient evidences to show their effects on happiness
score. However, variable “generosity” appeared to have p-values
0.6602362, which is larger than 0.05, indicating that it didn’t exhibit
significant impact to 2016’s happiness score.</p>
</div>
<div id="section-7" class="section level3">
<h3>2017</h3>
<pre class="r"><code>data_2017 = happiness_score|&gt;
  filter(year == 2017)

model2017 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = data_2017)

model2017|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="42%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.7430289</td>
<td align="right">0.1873581</td>
<td align="right">9.303195</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">0.7844334</td>
<td align="right">0.2045131</td>
<td align="right">3.835615</td>
<td align="right">0.0001849</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">1.1177711</td>
<td align="right">0.2020608</td>
<td align="right">5.531856</td>
<td align="right">0.0000001</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">1.2888803</td>
<td align="right">0.3215255</td>
<td align="right">4.008640</td>
<td align="right">0.0000965</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">1.4757152</td>
<td align="right">0.3425093</td>
<td align="right">4.308541</td>
<td align="right">0.0000298</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">0.8266072</td>
<td align="right">0.4843307</td>
<td align="right">1.706700</td>
<td align="right">0.0899751</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">0.3807181</td>
<td align="right">0.3293271</td>
<td align="right">1.156049</td>
<td align="right">0.2495240</td>
</tr>
</tbody>
</table>
<p>In 2017, the variable “freedom to make life choices” and “health life
expectancy” exhibited the largest 2 coefficient (1.4757152) and
(1.2888803) with significant p-values (0.0000298) and (0.0000965)
respectively, while the variable “social support” exhibited the third
largest coefficient and more significant p-values(&lt;0.000001) in
comparison to variable “freedom to make life choices” and “health life
expectancy”. This indicated that they all exhibited a very outstanding
impacts on happiness score in 2017. Following them, “gdp per capita”
also appeared to have relatively high estimates (0.7844334) with
p-values (0.0001849), indicating that there were sufficient evidences to
show a significant impact on happiness score. However, variable
“perception of corruption” and “generosity” appeared to have p-values
larger than 0.05, indicating that they didn’t exhibit significant impact
to 2017’s happiness score.</p>
</div>
<div id="section-8" class="section level3">
<h3>2018</h3>
<pre class="r"><code>data_2018 = happiness_score|&gt;
  filter(year == 2018)

model2018 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = data_2018)

model2018|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="42%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.8234561</td>
<td align="right">0.1977108</td>
<td align="right">9.222845</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">0.9017459</td>
<td align="right">0.2423630</td>
<td align="right">3.720642</td>
<td align="right">0.0002816</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">1.1150219</td>
<td align="right">0.2117195</td>
<td align="right">5.266505</td>
<td align="right">0.0000005</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">0.9671218</td>
<td align="right">0.3425058</td>
<td align="right">2.823666</td>
<td align="right">0.0054021</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">1.3984419</td>
<td align="right">0.3185447</td>
<td align="right">4.390096</td>
<td align="right">0.0000214</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">0.7277888</td>
<td align="right">0.5277904</td>
<td align="right">1.378935</td>
<td align="right">0.1699951</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">0.5235668</td>
<td align="right">0.4717544</td>
<td align="right">1.109829</td>
<td align="right">0.2688726</td>
</tr>
</tbody>
</table>
<p>In 2018, the variable “freedom to make life choices” and “social
support” exhibited the largest 2 coefficient (1.3984419) and (1.1150219)
with significant p-values (0.0000214) and (0.0000005) respectively,
indicating that they play very substantial job on impacting happiness
score. Following them, the variables “health life expectancy” and “gdp
per capita” exhibited relatively large coefficients with significant
p-values(&lt;0.01), indicating that they also exhibited very outstanding
impacts on happiness score in 2018. However, variable “perception of
corruption” and “generosity” appeared to have p-values larger than 0.05,
indicating that they didn’t exhibit significant impact to 2018’s
happiness score.</p>
</div>
<div id="section-9" class="section level3">
<h3>2019</h3>
<pre class="r"><code>data_2019 = happiness_score|&gt;
  filter(year == 2019)

model2019 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = data_2019)

model2019|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="42%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.7952202</td>
<td align="right">0.2110734</td>
<td align="right">8.5051942</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">0.7753716</td>
<td align="right">0.2182254</td>
<td align="right">3.5530776</td>
<td align="right">0.0005103</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">1.1241916</td>
<td align="right">0.2369001</td>
<td align="right">4.7454252</td>
<td align="right">0.0000048</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">1.0781427</td>
<td align="right">0.3345385</td>
<td align="right">3.2227764</td>
<td align="right">0.0015596</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">1.4548324</td>
<td align="right">0.3753378</td>
<td align="right">3.8760610</td>
<td align="right">0.0001587</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">0.9722802</td>
<td align="right">0.5423607</td>
<td align="right">1.7926818</td>
<td align="right">0.0750526</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">0.4897834</td>
<td align="right">0.4977455</td>
<td align="right">0.9840036</td>
<td align="right">0.3267089</td>
</tr>
</tbody>
</table>
<p>In 2019, the variable “freedom to make life choices” and “social
support” exhibited the largest 2 coefficient (1.4548324) and (1.1241916)
with significant p-values (0.0001587) and (0.0000048) respectively,
indicating that they play very substantial job on impacting happiness
score. Following them, the variables “health life expectancy” and “gdp
per capita” exhibited relatively large coefficients with significant
p-values(&lt;0.01), indicating that they also exhibited very outstanding
impacts on happiness score in 2019. However, variable “perception of
corruption” and “generosity” appeared to have p-values larger than 0.05,
indicating that they didn’t exhibit significant impact to 2019’s
happiness score.</p>
<p>According to the linear regressions performed separately for each
year from 2015 to 2019, the main factor that impacted the happiness
score changed over time. In 2015, “social support” had the most
substantial impact on the happiness score, and its impact kept being
significant until 2019. In the following 4 years, “freedom to make life
choices” appeared to make the greatest impact on the happiness score.
“health life expectancy” also impacted significantly on the happiness
score since it exhibited the second or the third largest coefficient in
the linear regression model from 2016 to 2019.</p>
</div>
</div>
<div id="part-3-does-the-result-vary-by-region" class="section level2">
<h2>Part 3: Does the result vary by region?</h2>
<div id="central-and-eastern-europe" class="section level3">
<h3>Central and Eastern Europe</h3>
<pre class="r"><code>central_east = happiness_score|&gt;
  filter(region == &quot;Central and Eastern Europe&quot;)

model1 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = central_east)

model1|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="40%" />
<col width="15%" />
<col width="14%" />
<col width="15%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">3.1506152</td>
<td align="right">0.3761585</td>
<td align="right">8.3757648</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">1.0993611</td>
<td align="right">0.2033891</td>
<td align="right">5.4052129</td>
<td align="right">0.0000003</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">0.5447398</td>
<td align="right">0.1437145</td>
<td align="right">3.7904299</td>
<td align="right">0.0002240</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">-0.1987347</td>
<td align="right">0.4097214</td>
<td align="right">-0.4850485</td>
<td align="right">0.6284110</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">1.7050905</td>
<td align="right">0.3442244</td>
<td align="right">4.9534273</td>
<td align="right">0.0000021</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">-0.5976465</td>
<td align="right">0.5501586</td>
<td align="right">-1.0863167</td>
<td align="right">0.2792328</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">0.6492740</td>
<td align="right">0.5101488</td>
<td align="right">1.2727149</td>
<td align="right">0.2052593</td>
</tr>
</tbody>
</table>
<p>From 2015 to 2019, in Central and Eastern European countries,
variables “freedom to make life choices” exhibited the largest
coefficient(1.7050905) with significant p-value(0.0000021) indicating
that it impacted substantially on happiness score. Meanwhile, variables
“gdp per capita” and “social support” exhibited relatively high
coefficients (1.0993611) and (0.5447398) respectively with significant
p-value (&lt;0.001) showing their essential impact on happiness score.
Variables “health life expectancy”, “perception of corruption” and
“generosity” exhibited smaller and even negative coefficients; however,
these variables did not exhibit significant p-values(&gt;0.05)
indicating that it was not significant enough to tell that they had
impact on happiness score.</p>
</div>
<div id="eastern-asia" class="section level3">
<h3>Eastern Asia</h3>
<pre class="r"><code>east_asia = happiness_score|&gt;
  filter(region == &quot;Eastern Asia&quot;)

model2 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = east_asia)

model2|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="40%" />
<col width="15%" />
<col width="14%" />
<col width="15%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.6698077</td>
<td align="right">0.9885689</td>
<td align="right">0.6775529</td>
<td align="right">0.5048144</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">2.6321054</td>
<td align="right">0.3987773</td>
<td align="right">6.6004398</td>
<td align="right">0.0000010</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">0.1680339</td>
<td align="right">0.2050669</td>
<td align="right">0.8194102</td>
<td align="right">0.4209627</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">1.5122195</td>
<td align="right">0.7333569</td>
<td align="right">2.0620513</td>
<td align="right">0.0506769</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">1.8238357</td>
<td align="right">0.9140536</td>
<td align="right">1.9953269</td>
<td align="right">0.0579853</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">-6.1001405</td>
<td align="right">1.5633140</td>
<td align="right">-3.9020571</td>
<td align="right">0.0007172</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">0.8764310</td>
<td align="right">0.8352973</td>
<td align="right">1.0492444</td>
<td align="right">0.3049665</td>
</tr>
</tbody>
</table>
<p>From 2015 to 2019, in Eastern Asian countries, variable “perception
of corruption” exhibited extremely high coefficient (-6.1001405) with a
significant p-value(0.0007172) indicating that “perception of
corruption” had extremely substantial negative impact on happiness
score. Variable “gdp per capita” exhibited the second highest
coefficient (2.6321054) with a significant p-value (0.0000010)
indicating that it had essential impact on happiness score. However,
other variables exhibited p-values larger than 0.05 showing that it was
not significant enough to tell that they had impacts on happiness
score.</p>
</div>
<div id="latin-america-and-caribbean" class="section level3">
<h3>Latin America and Caribbean</h3>
<pre class="r"><code>latin_caribbean = happiness_score|&gt;
  filter(region == &quot;Latin America and Caribbean&quot;)

model3 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = latin_caribbean)

model3|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="40%" />
<col width="15%" />
<col width="14%" />
<col width="15%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.9870953</td>
<td align="right">0.3603714</td>
<td align="right">8.2889347</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">1.4869935</td>
<td align="right">0.2138900</td>
<td align="right">6.9521417</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">-0.6315397</td>
<td align="right">0.2278693</td>
<td align="right">-2.7714998</td>
<td align="right">0.0066120</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">1.7455082</td>
<td align="right">0.3819569</td>
<td align="right">4.5699082</td>
<td align="right">0.0000135</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">2.4568168</td>
<td align="right">0.3534921</td>
<td align="right">6.9501327</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">1.3409006</td>
<td align="right">0.9170861</td>
<td align="right">1.4621317</td>
<td align="right">0.1467204</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">-0.3165373</td>
<td align="right">0.5087516</td>
<td align="right">-0.6221843</td>
<td align="right">0.5351824</td>
</tr>
</tbody>
</table>
<p>From 2015 to 2019, in Latin American and Caribbean countries,
variable “freedom to make life choices” had the most significant impact
on happiiness score since it exhibited the highest
coefficient(2.4568168) with extremely significant p-value
(&lt;0.000001). Following this, variables “health life expectancy” and
“gdp per capita” exhibited relatively high coefficients (1.7455082) and
(1.4869935) respectively with significant p-values indicating their
essential impact on happiness score. Variable “social support” exhibited
a negative coefficient “-0.6315397” with a significant p-value
(0.0066120) indicating that “social support” had negative impact on
happiness score. However, variables “perception of corruption” and
“generosity” appear to have p-values(&gt;0.05) indicating that it was
not significant enough to tell that they had impacts on happiness
score.</p>
</div>
<div id="middle-east-and-northern-africa" class="section level3">
<h3>Middle East and Northern Africa</h3>
<pre class="r"><code>east_africa = happiness_score|&gt;
  filter(region == &quot;Middle East and Northern Africa&quot;)

model4 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = east_africa)

model4|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="40%" />
<col width="15%" />
<col width="14%" />
<col width="15%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.5472699</td>
<td align="right">0.2567575</td>
<td align="right">6.0261911</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">1.5506958</td>
<td align="right">0.2511559</td>
<td align="right">6.1742356</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">0.4364518</td>
<td align="right">0.2065005</td>
<td align="right">2.1135633</td>
<td align="right">0.0373830</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">2.0670148</td>
<td align="right">0.4620345</td>
<td align="right">4.4737244</td>
<td align="right">0.0000229</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">1.3532650</td>
<td align="right">0.4613435</td>
<td align="right">2.9333131</td>
<td align="right">0.0042752</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">0.3720748</td>
<td align="right">0.6673868</td>
<td align="right">0.5575099</td>
<td align="right">0.5785945</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">-1.4347645</td>
<td align="right">0.4915314</td>
<td align="right">-2.9189679</td>
<td align="right">0.0044584</td>
</tr>
</tbody>
</table>
<p>From 2015 to 2019, in Middle Eastern and Northern African countries,
variables “health life expectancy” exhibited the largest coefficient
(2.0670148) with a significant p-value(0.0000229), while the variable
“gdp per capita” exhibited the second largest coefficient and more
significant p-values(&lt;0.0001) in comparison to variable “health life
expectancy”. The variables “generosity”,“freedom to make life choices”
and “social support” also exhibited relatively large coefficient with
significant p-value. This indicated that they all exhibited a very
outstanding impact on happiness score. However, variable “perception of
corruption” appeared to have p-values 0.5785945, which is larger than
0.05, indicating that it didn’t exhibit significant impact to the
happiness score.</p>
</div>
<div id="north-america" class="section level3">
<h3>North America</h3>
<pre class="r"><code>north_america = happiness_score|&gt;
  filter(region == &quot;North America&quot;)

model5 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = north_america)

model5|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="40%" />
<col width="15%" />
<col width="14%" />
<col width="15%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">5.7461328</td>
<td align="right">1.1568751</td>
<td align="right">4.9669432</td>
<td align="right">0.0156747</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">0.2906872</td>
<td align="right">0.4853376</td>
<td align="right">0.5989381</td>
<td align="right">0.5914238</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">-0.2790530</td>
<td align="right">0.1790157</td>
<td align="right">-1.5588190</td>
<td align="right">0.2169302</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">0.4041180</td>
<td align="right">0.4999375</td>
<td align="right">0.8083371</td>
<td align="right">0.4780512</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">0.9868637</td>
<td align="right">0.8267570</td>
<td align="right">1.1936563</td>
<td align="right">0.3183984</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">1.4273085</td>
<td align="right">0.5532336</td>
<td align="right">2.5799383</td>
<td align="right">0.0817842</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">0.4721823</td>
<td align="right">0.4867702</td>
<td align="right">0.9700313</td>
<td align="right">0.4035808</td>
</tr>
</tbody>
</table>
<p>From 2015 to 2019, in North American countries, none of the 6
variables exhibited significant p-value since all their p-values were
greater than 0.05 indicating that none of the variables exhibit
significant impact to the happiness score.</p>
</div>
<div id="southeastern-asia" class="section level3">
<h3>Southeastern Asia</h3>
<pre class="r"><code>southeastern_asia = happiness_score|&gt;
  filter(region == &quot;Southeastern Asia&quot;)

model6 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = southeastern_asia)

model6|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="40%" />
<col width="15%" />
<col width="14%" />
<col width="15%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">3.5557237</td>
<td align="right">0.7682308</td>
<td align="right">4.6284577</td>
<td align="right">0.0000442</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">1.6457687</td>
<td align="right">0.3325444</td>
<td align="right">4.9490193</td>
<td align="right">0.0000165</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">0.3338875</td>
<td align="right">0.3197225</td>
<td align="right">1.0443039</td>
<td align="right">0.3031200</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">0.7927899</td>
<td align="right">0.5905490</td>
<td align="right">1.3424625</td>
<td align="right">0.1876252</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">-0.9335115</td>
<td align="right">1.0718734</td>
<td align="right">-0.8709158</td>
<td align="right">0.3894160</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">-0.6520931</td>
<td align="right">0.6148682</td>
<td align="right">-1.0605413</td>
<td align="right">0.2957725</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">0.0954657</td>
<td align="right">0.4326026</td>
<td align="right">0.2206775</td>
<td align="right">0.8265568</td>
</tr>
</tbody>
</table>
<p>From 2015 to 2019, in Southeastern Asian countries, only variable
“gdp per capita” exhibited relatively high coefficient (1.6457687) with
significant p-value (0.0000165) indicating that “gdp per capita” had
substantial impact on happiness scrore. Despite “gdp per capita”, none
of other variables exhibited significant p-values indicating that we did
not have sufficient evidence to show their impact on happiness
score.</p>
</div>
<div id="southern-asia" class="section level3">
<h3>Southern Asia</h3>
<pre class="r"><code>southern_asia = happiness_score|&gt;
  filter(region == &quot;Southern Asia&quot;)

model7 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = southern_asia)

model7|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="40%" />
<col width="15%" />
<col width="14%" />
<col width="15%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.9020228</td>
<td align="right">0.3943552</td>
<td align="right">7.3589065</td>
<td align="right">0.0000001</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">0.1307995</td>
<td align="right">0.5138800</td>
<td align="right">0.2545332</td>
<td align="right">0.8009437</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">0.3855854</td>
<td align="right">0.3180950</td>
<td align="right">1.2121705</td>
<td align="right">0.2355768</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">1.5212822</td>
<td align="right">0.8819818</td>
<td align="right">1.7248452</td>
<td align="right">0.0955793</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">-1.3276433</td>
<td align="right">0.8445746</td>
<td align="right">-1.5719668</td>
<td align="right">0.1271914</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">8.8312157</td>
<td align="right">2.1766502</td>
<td align="right">4.0572507</td>
<td align="right">0.0003603</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">0.4649207</td>
<td align="right">0.9043858</td>
<td align="right">0.5140734</td>
<td align="right">0.6112343</td>
</tr>
</tbody>
</table>
<p>From 2015 to 2019, in Southern Asian countries, only one variable,
“perception of corruption”, exhibited significant p-value (0.0003603)
with extremely high coefficient (8.8312157) indicating that among all 6
variables, “perception of corruption” had the largest impact on
happiness score.</p>
</div>
<div id="sub-saharan-africa" class="section level3">
<h3>Sub-Saharan Africa</h3>
<pre class="r"><code>sub_africa = happiness_score|&gt;
  filter(region == &quot;Sub-Saharan Africa&quot;)

model8 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = sub_africa)

model8|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="40%" />
<col width="15%" />
<col width="14%" />
<col width="15%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.6862788</td>
<td align="right">0.1737404</td>
<td align="right">15.4614553</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">0.6020415</td>
<td align="right">0.1539281</td>
<td align="right">3.9111867</td>
<td align="right">0.0001280</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">0.6583385</td>
<td align="right">0.1332112</td>
<td align="right">4.9420649</td>
<td align="right">0.0000017</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">-0.0725829</td>
<td align="right">0.2444136</td>
<td align="right">-0.2969676</td>
<td align="right">0.7668173</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">0.9605341</td>
<td align="right">0.2729970</td>
<td align="right">3.5184786</td>
<td align="right">0.0005437</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">-0.6583010</td>
<td align="right">0.4600525</td>
<td align="right">-1.4309258</td>
<td align="right">0.1541028</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">2.0618730</td>
<td align="right">0.4998157</td>
<td align="right">4.1252665</td>
<td align="right">0.0000555</td>
</tr>
</tbody>
</table>
<p>From 2015 to 2019, in Sub- Saharan African countries, variable
“generosity” exhibited coefficient (2.0618730) with significant p-value
(0.0000555) indicating that it had the most substantial impact on
happiness score. Following this, variables “freedom to make life
choice”, “social support” and “gdp per capita” also had essential impact
on happiness score since they had relatively large coefficient and
significant p-value(&lt;0.001). However, “health life expectancy” and
“perception of corruption” did not appear to have significant p-value
(&gt;0.05) indicating that they did not have significant impact on
happiness score.</p>
</div>
<div id="western-europe" class="section level3">
<h3>Western Europe</h3>
<pre class="r"><code>west_europe = happiness_score|&gt;
  filter(region == &quot;Western Europe&quot;)

model9 = lm(formula = score ~ gdp_per_capita + social_support + health_life_expectancy + freedom_to_make_life_choices + perception_of_corruption + generosity, 
                     data = west_europe)

model9|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="42%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.1188003</td>
<td align="right">0.7020829</td>
<td align="right">3.017878</td>
<td align="right">0.0032440</td>
</tr>
<tr class="even">
<td align="left">gdp_per_capita</td>
<td align="right">0.8563506</td>
<td align="right">0.3675997</td>
<td align="right">2.329574</td>
<td align="right">0.0218810</td>
</tr>
<tr class="odd">
<td align="left">social_support</td>
<td align="right">0.7417660</td>
<td align="right">0.1914877</td>
<td align="right">3.873701</td>
<td align="right">0.0001936</td>
</tr>
<tr class="even">
<td align="left">health_life_expectancy</td>
<td align="right">1.1950538</td>
<td align="right">0.5049965</td>
<td align="right">2.366459</td>
<td align="right">0.0199258</td>
</tr>
<tr class="odd">
<td align="left">freedom_to_make_life_choices</td>
<td align="right">0.8686215</td>
<td align="right">0.3881809</td>
<td align="right">2.237672</td>
<td align="right">0.0275070</td>
</tr>
<tr class="even">
<td align="left">perception_of_corruption</td>
<td align="right">2.7240472</td>
<td align="right">0.3798791</td>
<td align="right">7.170826</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">generosity</td>
<td align="right">1.2352683</td>
<td align="right">0.3167298</td>
<td align="right">3.900070</td>
<td align="right">0.0001763</td>
</tr>
</tbody>
</table>
<p>From 2015 to 2019, in Western European countries, all 6 variables had
significant impact on happiness score since their p-value were all
smaller than 0.05. Among these variables, “perception of corruption”
exhibited the largest coefficient and the smallest p-valu indicating
that it had the most significant impact on happiness score.</p>
<p>According to the linear regression model performed separately
according to their regions, factors that impacted the happiness score
varied a lot. One extreme case took place in North American countries
since none of the factors were playing significant roles in impacting
their happiness score; another extreme case took place in western-
European countries since all 6 variables had significant impact on the
happiness score while “perception of corruption” was the main factors.
The linear regression models also indicate that both Southern Asian
countries and Southeastern Asian countries had only one factor,
“perception of corruption” and “gdp per capita” respectively with
extremely significant p-values. “freedom to make life choices” appeared
to make the greatest impact on the happiness score in Central and
Eastern European and Latin American and Caribbean countries
countries.”perception of corruption” played a substantial role on
impacting the happiness score in southern Asian countries and eastern
Asian countries.</p>
</div>
</div>
</div>
<div id="discussionconclusion" class="section level1">
<h1>Discussion/Conclusion</h1>
<p>According to the regression models for Happiness Score Prediction
from 2015 to 2019, “Freedom to make life choices” and “social support”
consistently exhibit the largest coefficients across all years
(2015-2019), indicating their substantial impact on happiness scores.
However, “Perception of corruption” and “generosity” consistently have
p-values larger than 0.05 across all years, indicating that they do not
exhibit a significant impact on happiness scores. “Health life
expectancy” and “gdp per capita” consistently exhibit relatively large
coefficients with significant p-values, emphasizing the importance of
health and economic factors in explaining happiness scores over time.
Therefore, while some variables consistently exhibit significance, there
are variations in the significance levels across years. Potential
year-to-year fluctuations in the factors influencing happiness scores
should be expected and noticed in the upcoming years.</p>
<p>According to our regression models for Happiness Prediction across
different regions, we can tell that there is diversity in the patterns
observed across continents, with each region having its own unique set
of influential factors on happiness. The impact of specific variables
varies across different regions. For example: “Freedom to make life
choices” was particularly substantial in Central and Eastern European
and Latin American and Caribbean countries; “Perception of corruption”
played a substantial role in both Southern Asian and Eastern Asian
countries. Meanwhile, there are limited significant factors in Certain
Regions: Southern Asian and Southeastern Asian countries both had only
one significant factor with extremely significant p-values; “Perception
of corruption” was significant for Southern Asian countries; “GDP per
capita” was significant for Southeastern Asian countries. The findings
suggest that different regions may prioritize different factors when it
comes to happiness. Understanding these regional priorities can be
valuable for policymaking and interventions tailored to specific
needs.</p>
<p><a href="index.html">Back To Home</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
